[
  {
    "Id": "433781",
    "ThreadId": "210081",
    "Html": "<p>Hello</p>\r\n<p>This is using the latest WPF Toolkit (Feb 2010).&nbsp; I have a chart that changes its data series when a combo box is changed.&nbsp; When I change the combobox value I get a permissions error that seems to stem from the WPF Toolkit.&nbsp; It requests &lt;IPermission class=&quot;System.Security.Permissions.UIPermission, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot; Window=&quot;AllWindows&quot;/&gt; which I can understand why an XBAP would deny.&nbsp;</p>\r\n<p>Any ideas on how I can get this to not happen?&nbsp; What I am doing is really not fancy.&nbsp; I have included the full stack trace below.</p>\r\n<p>This does not cause a problem in a WPF application (I have a web and app version).</p>\r\n<p>thanks Alex</p>\r\n<p>&nbsp;</p>\r\n<p><br>Application Identity: , Version=1.0.0.1, Culture=neutral, PublicKeyToken=49ec8f7eb5a8c36b, processorArchitecture=msil/ILPMain.exe, Version=1.0.0.1, Culture=neutral, PublicKeyToken=49ec8f7eb5a8c36b, processorArchitecture=msil, type=win32</p>\r\n<p>System.Security.SecurityException: Request for the permission of type 'System.Security.Permissions.UIPermission, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' failed.<br>&nbsp;&nbsp; at System.Security.CodeAccessSecurityEngine.Check(Object demand, StackCrawlMark&amp; stackMark, Boolean isPermSet)<br>&nbsp;&nbsp; at System.Security.CodeAccessPermission.Demand()<br>&nbsp;&nbsp; at MS.Internal.PresentationCore.SecurityHelper.DemandUIWindowPermission()<br>&nbsp;&nbsp; at System.Windows.PresentationSource.FromVisual(Visual visual)<br>&nbsp;&nbsp; at System.Windows.VisualStateManager.ShouldRunStateStoryboard(FrameworkElement control, FrameworkElement stateGroupsRoot, VisualState state, VisualStateGroup group)<br>&nbsp;&nbsp; at System.Windows.VisualStateManager.&lt;&gt;c__DisplayClass3.&lt;GoToStateInternal&gt;b__0(Object sender, EventArgs e)<br>&nbsp;&nbsp; at System.Windows.Media.Animation.Clock.FireEvent(EventPrivateKey key)<br>&nbsp;&nbsp; at System.Windows.Media.Animation.Clock.RaiseAccumulatedEvents()<br>&nbsp;&nbsp; at System.Windows.Media.Animation.TimeManager.RaiseEnqueuedEvents()<br>&nbsp;&nbsp; at System.Windows.Media.Animation.TimeManager.Tick()<br>&nbsp;&nbsp; at System.Windows.Media.MediaContext.RenderMessageHandlerCore(Object resizedCompositionTarget)<br>&nbsp;&nbsp; at System.Windows.Media.MediaContext.AnimatedRenderMessageHandler(Object resizedCompositionTarget)<br>&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)<br>&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br>&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.InvokeImpl()<br>&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.InvokeInSecurityContext(Object state)<br>&nbsp;&nbsp; at System.Threading.ExecutionContext.runTryCode(Object userData)<br>&nbsp;&nbsp; at System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData)<br>&nbsp;&nbsp; at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)<br>&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)<br>&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.Invoke()<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.ProcessQueue()<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.WndProcHook(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)<br>&nbsp;&nbsp; at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)<br>&nbsp;&nbsp; at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)<br>&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)<br>&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Boolean isSingleParameter)<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.Invoke(DispatcherPriority priority, Delegate method, Object arg)<br>&nbsp;&nbsp; at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)<br>&nbsp;&nbsp; at MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG&amp; msg)<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.Run()<br>&nbsp;&nbsp; at System.Windows.Application.RunDispatcher(Object ignore)<br>&nbsp;&nbsp; at System.Windows.Application.StartDispatcherInBrowser(Object unused)<br>&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)<br>&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br>&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.InvokeImpl()<br>&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.InvokeInSecurityContext(Object state)<br>&nbsp;&nbsp; at System.Threading.ExecutionContext.runTryCode(Object userData)<br>&nbsp;&nbsp; at System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData)<br>&nbsp;&nbsp; at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)<br>&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)<br>&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.Invoke()<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.ProcessQueue()<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.WndProcHook(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)<br>&nbsp;&nbsp; at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)<br>&nbsp;&nbsp; at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)<br>&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)<br>&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Boolean isSingleParameter)<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.Invoke(DispatcherPriority priority, Delegate method, Object arg)<br>&nbsp;&nbsp; at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)</p>\r\n<p>The action that failed was:<br>Demand<br>The type of the first permission that failed was:<br>System.Security.Permissions.UIPermission<br>The first permission that failed was:<br>&lt;IPermission class=&quot;System.Security.Permissions.UIPermission, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;<br>version=&quot;1&quot;<br>Window=&quot;AllWindows&quot;/&gt;</p>\r\n<p>The demand was for:<br>&lt;IPermission class=&quot;System.Security.Permissions.UIPermission, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;<br>version=&quot;1&quot;<br>Window=&quot;AllWindows&quot;/&gt;</p>\r\n<p>The granted set of the failing assembly was:<br>&lt;PermissionSet class=&quot;System.Security.PermissionSet&quot;<br>version=&quot;1&quot;&gt;<br>&lt;IPermission class=&quot;System.Security.Permissions.FileDialogPermission, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;<br>version=&quot;1&quot;<br>Access=&quot;Open&quot;/&gt;<br>&lt;IPermission class=&quot;System.Security.Permissions.IsolatedStorageFilePermission, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;<br>version=&quot;1&quot;<br>Allowed=&quot;ApplicationIsolationByUser&quot;<br>UserQuota=&quot;512000&quot;/&gt;<br>&lt;IPermission class=&quot;System.Security.Permissions.SecurityPermission, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;<br>version=&quot;1&quot;<br>Flags=&quot;Execution&quot;/&gt;<br>&lt;IPermission class=&quot;System.Security.Permissions.UIPermission, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;<br>version=&quot;1&quot;<br>Window=&quot;SafeTopLevelWindows&quot;<br>Clipboard=&quot;OwnClipboard&quot;/&gt;<br>&lt;IPermission class=&quot;System.Drawing.Printing.PrintingPermission, System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&quot;<br>version=&quot;1&quot;<br>Level=&quot;SafePrinting&quot;/&gt;<br>&lt;IPermission class=&quot;System.Security.Permissions.MediaPermission, WindowsBase, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&quot;<br>version=&quot;1&quot;<br>Audio=&quot;SafeAudio&quot;<br>Video=&quot;SafeVideo&quot;<br>Image=&quot;SafeImage&quot;/&gt;<br>&lt;IPermission class=&quot;System.Security.Permissions.WebBrowserPermission, WindowsBase, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&quot;<br>version=&quot;1&quot;<br>Level=&quot;Safe&quot;/&gt;<br>&lt;IPermission class=&quot;System.Net.WebPermission, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;<br>version=&quot;1&quot;&gt;<br>&lt;ConnectAccess&gt;<br>&lt;URI uri=&quot;(https)://ilpdev01/.*&quot;/&gt;<br>&lt;/ConnectAccess&gt;<br>&lt;/IPermission&gt;<br>&lt;/PermissionSet&gt;</p>\r\n<p>The assembly or AppDomain that failed was:<br>WPFToolkit, Version=3.5.40128.1, Culture=neutral, PublicKeyToken=31bf3856ad364e35<br>The method that caused the failure was:<br>Boolean ShouldRunStateStoryboard(System.Windows.FrameworkElement, System.Windows.FrameworkElement, System.Windows.VisualState, System.Windows.VisualStateGroup)<br>The Zone of the assembly that failed was:<br>MyComputer<br>The Url of the assembly that failed was:<br><a>file:///C:/Documents</a> and Settings/alo/Local Settings/Apps/2.0/0T7C18RW.YVA/MBJJL1EZ.1Y0/ilpm..xbap_49ec8f7eb5a8c36b_0001.0000_707d36ef42fba960/WPFToolkit.DLL</p>\r\n<p>-----------------------</p>\r\n<p>PresentationHost.exe v3.0.6920.1427 built by: SP - C:\\WINDOWS\\system32\\PresentationHost.exe<br>ntdll.dll v5.1.2600.5755 (xpsp_sp3_gdr.090206-1234) - C:\\WINDOWS\\system32\\ntdll.dll<br>kernel32.dll v5.1.2600.5781 (xpsp_sp3_gdr.090321-1317) - C:\\WINDOWS\\system32\\kernel32.dll<br>ADVAPI32.dll v5.1.2600.5755 (xpsp_sp3_gdr.090206-1234) - C:\\WINDOWS\\system32\\ADVAPI32.dll<br>RPCRT4.dll v5.1.2600.5795 (xpsp_sp3_gdr.090415-1241) - C:\\WINDOWS\\system32\\RPCRT4.dll<br>Secur32.dll v5.1.2600.5753 (xpsp_sp3_gdr.090203-1302) - C:\\WINDOWS\\system32\\Secur32.dll<br>MSVCR80.dll v8.00.50727.3053 - C:\\WINDOWS\\WinSxS\\x86_Microsoft.VC80.CRT_1fc8b3b9a1e18e3b_8.0.50727.3053_x-ww_b80fa8ca\\MSVCR80.dll<br>msvcrt.dll v7.0.2600.5512 (xpsp.080413-2111) - C:\\WINDOWS\\system32\\msvcrt.dll<br>USER32.dll v5.1.2600.5512 (xpsp.080413-2105) - C:\\WINDOWS\\system32\\USER32.dll<br>GDI32.dll v5.1.2600.5698 (xpsp_sp3_gdr.081022-1932) - C:\\WINDOWS\\system32\\GDI32.dll<br>ole32.dll v5.1.2600.5512 (xpsp.080413-2108) - C:\\WINDOWS\\system32\\ole32.dll<br>mscoree.dll v2.0.50727.3053 (netfxsp.050727-3000) - C:\\WINDOWS\\system32\\mscoree.dll<br>SHLWAPI.dll v6.00.2900.5912 (xpsp_sp3_gdr.091207-1454) - C:\\WINDOWS\\system32\\SHLWAPI.dll<br>urlmon.dll v7.00.5730.13 (longhorn(wmbla).070711-1130) - C:\\WINDOWS\\system32\\urlmon.dll<br>OLEAUT32.dll v5.1.2600.5512 - C:\\WINDOWS\\system32\\OLEAUT32.dll<br>iertutil.dll v7.00.5730.13 (longhorn(wmbla).070711-1130) - C:\\WINDOWS\\system32\\iertutil.dll<br>SHELL32.dll v6.00.2900.5512 (xpsp.080413-2105) - C:\\WINDOWS\\system32\\SHELL32.dll<br>WININET.dll v7.00.5730.13 (longhorn(wmbla).070711-1130) - C:\\WINDOWS\\system32\\WININET.dll<br>Normaliz.dll v6.0.5441.0 (winmain(wmbla).060628-1735) - C:\\WINDOWS\\system32\\Normaliz.dll<br>IMM32.DLL v5.1.2600.5512 (xpsp.080413-2105) - C:\\WINDOWS\\system32\\IMM32.DLL<br>comctl32.dll v6.0 (xpsp.080413-2105) - C:\\WINDOWS\\WinSxS\\x86_Microsoft.Windows.Common-Controls_6595b64144ccf1df_6.0.2600.5512_x-ww_35d4ce83\\comctl32.dll<br>uxtheme.dll v6.00.2900.5512 (xpsp.080413-2105) - C:\\WINDOWS\\system32\\uxtheme.dll<br>MSCTF.dll v5.1.2600.5512 (xpsp.080413-2105) - C:\\WINDOWS\\system32\\MSCTF.dll<br>CLBCATQ.DLL v2001.12.4414.700 - C:\\WINDOWS\\system32\\CLBCATQ.DLL<br>COMRes.dll v2001.12.4414.700 - C:\\WINDOWS\\system32\\COMRes.dll<br>VERSION.dll v5.1.2600.5512 (xpsp.080413-2105) - C:\\WINDOWS\\system32\\VERSION.dll<br>xpsp2res.dll v5.1.2600.5512 (xpsp.080413-2113) - C:\\WINDOWS\\system32\\xpsp2res.dll<br>ws2_32.dll v5.1.2600.5512 (xpsp.080413-0852) - C:\\WINDOWS\\system32\\ws2_32.dll<br>WS2HELP.dll v5.1.2600.5512 (xpsp.080413-0852) - C:\\WINDOWS\\system32\\WS2HELP.dll<br>mswsock.dll v5.1.2600.5625 (xpsp_sp3_gdr.080620-1249) - C:\\WINDOWS\\system32\\mswsock.dll<br>CRYPT32.dll v5.131.2600.5512 (xpsp.080413-2113) - C:\\WINDOWS\\system32\\CRYPT32.dll<br>MSASN1.dll v5.1.2600.5875 (xpsp_sp3_gdr.090904-1413) - C:\\WINDOWS\\system32\\MSASN1.dll<br>hnetcfg.dll v5.1.2600.5512 (xpsp.080413-0852) - C:\\WINDOWS\\system32\\hnetcfg.dll<br>wshtcpip.dll v5.1.2600.5512 (xpsp.080413-0852) - C:\\WINDOWS\\System32\\wshtcpip.dll<br>userenv.dll v5.1.2600.5512 (xpsp.080413-2113) - C:\\WINDOWS\\system32\\userenv.dll<br>netapi32.dll v5.1.2600.5694 (xpsp_sp3_gdr.081015-1312) - C:\\WINDOWS\\system32\\netapi32.dll<br>wintrust.dll v5.131.2600.5512 (xpsp.080413-2113) - C:\\WINDOWS\\system32\\wintrust.dll<br>IMAGEHLP.dll v5.1.2600.5512 (xpsp.080413-2105) - C:\\WINDOWS\\system32\\IMAGEHLP.dll<br>schannel.dll v5.1.2600.5721 (xpsp_sp3_gdr.081204-1228) - C:\\WINDOWS\\system32\\schannel.dll<br>RASAPI32.dll v5.1.2600.5512 (xpsp.080413-0852) - C:\\WINDOWS\\system32\\RASAPI32.dll<br>rasman.dll v5.1.2600.5512 (xpsp.080413-0852) - C:\\WINDOWS\\system32\\rasman.dll<br>TAPI32.dll v5.1.2600.5512 (xpsp.080413-0852) - C:\\WINDOWS\\system32\\TAPI32.dll<br>rtutils.dll v5.1.2600.5512 (xpsp.080413-0852) - C:\\WINDOWS\\system32\\rtutils.dll<br>WINMM.dll v5.1.2600.5512 (xpsp.080413-0845) - C:\\WINDOWS\\system32\\WINMM.dll<br>sensapi.dll v5.1.2600.5512 (xpsp.080413-2108) - C:\\WINDOWS\\system32\\sensapi.dll<br>rasadhlp.dll v5.1.2600.5512 (xpsp.080413-0852) - C:\\WINDOWS\\system32\\rasadhlp.dll<br>DNSAPI.dll v5.1.2600.5625 (xpsp_sp3_gdr.080620-1249) - C:\\WINDOWS\\system32\\DNSAPI.dll<br>msv1_0.dll v5.1.2600.5512 (xpsp.080413-2113) - C:\\WINDOWS\\system32\\msv1_0.dll<br>iphlpapi.dll v5.1.2600.5512 (xpsp.080413-0852) - C:\\WINDOWS\\system32\\iphlpapi.dll<br>rsaenh.dll v5.1.2600.5507 (xpsp.080318-1711) - C:\\WINDOWS\\system32\\rsaenh.dll<br>dssenh.dll v5.1.2600.5507 (xpsp.080318-1711) - C:\\WINDOWS\\system32\\dssenh.dll<br>dfshim.dll v2.0.50727.3053 (netfxsp.050727-3000) - C:\\WINDOWS\\system32\\dfshim.dll<br>mscorwks.dll v2.0.50727.3603 (GDR.050727-3600) - C:\\WINDOWS\\Microsoft.NET\\Framework\\v2.0.50727\\mscorwks.dll<br>PresentationHostDLL.dll v3.0.6920.1427 built by: SP - C:\\WINDOWS\\Microsoft.NET\\Framework\\v3.0\\WPF\\PresentationHostDLL.dll<br>PSAPI.DLL v5.1.2600.5512 (xpsp.080413-2105) - C:\\WINDOWS\\system32\\PSAPI.DLL<br>msi.dll v4.5.6001.22159 - C:\\WINDOWS\\system32\\msi.dll<br>actxprxy.dll v6.00.2900.5512 (xpsp.080413-2113) - C:\\WINDOWS\\system32\\actxprxy.dll<br>SXS.DLL v5.1.2600.5512 (xpsp.080413-2111) - C:\\WINDOWS\\system32\\SXS.DLL<br>PresentationHostProxy.dll v3.0.6920.1427 built by: SP - C:\\WINDOWS\\system32\\PresentationHostProxy.dll<br>ieproxy.dll v7.00.5730.13 (longhorn(wmbla).070711-1130) - C:\\Program Files\\Internet Explorer\\ieproxy.dll<br>msctfime.ime v5.1.2600.5512 (xpsp.080413-2105) - C:\\WINDOWS\\system32\\msctfime.ime<br>mshtml.dll v7.00.5730.13 (longhorn(wmbla).070711-1130) - C:\\WINDOWS\\system32\\mshtml.dll<br>msls31.dll v3.10.349.0 - C:\\WINDOWS\\system32\\msls31.dll<br>MLANG.dll v6.00.2900.5512 (xpsp.080413-2105) - C:\\WINDOWS\\system32\\MLANG.dll<br>msimtf.dll v5.1.2600.5512 (xpsp.080413-2105) - C:\\WINDOWS\\system32\\msimtf.dll<br>mslbui.dll v5.1.2600.5512 (xpsp.080413-2105) - C:\\WINDOWS\\system32\\mslbui.dll<br>sptip.dll v5.1.2600.5512 (xpsp.080413-2105) - C:\\WINDOWS\\ime\\sptip.dll<br>OLEACC.dll v4.2.5406.0 (xpclient.010817-1148) - C:\\WINDOWS\\system32\\OLEACC.dll<br>MSVCP60.dll v6.02.3104.0 - C:\\WINDOWS\\system32\\MSVCP60.dll<br>SPGRMR.DLL v5.1.2600.5512 (xpsp.080413-2105) - C:\\WINDOWS\\IME\\SPGRMR.DLL<br>SKCHUI.DLL v1.0.1038.0 - C:\\Program Files\\Common Files\\Microsoft Shared\\INK\\SKCHUI.DLL<br>IEFRAME.dll v7.00.5730.13 (longhorn(wmbla).070711-1130) - C:\\WINDOWS\\system32\\IEFRAME.dll<br>jscript.dll v5.7.6002.22145 - C:\\WINDOWS\\system32\\jscript.dll<br>ImgUtil.dll v7.00.5730.13 (longhorn(wmbla).070711-1130) - C:\\WINDOWS\\system32\\ImgUtil.dll<br>pngfilt.dll v7.00.5730.13 (longhorn(wmbla).070711-1130) - C:\\WINDOWS\\system32\\pngfilt.dll<br>mscorlib.ni.dll v2.0.50727.3603 (GDR.050727-3600) - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\mscorlib\\4b10d8196bb368996ec5d24fca777456\\mscorlib.ni.dll<br>System.ni.dll v2.0.50727.3053 (netfxsp.050727-3000) - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\System\\2e356db128ec7354bd70a3ecc84b1f87\\System.ni.dll<br>WindowsBase.ni.dll v3.0.6920.1427 built by: SP - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\WindowsBase\\c770cdb4fc7f26c9b5fe858d4147ae57\\WindowsBase.ni.dll<br>PresentationCore.ni.dll v3.0.6920.1427 built by: SP - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\PresentationCore\\4619e16b34a37586c8dbae5f71359156\\PresentationCore.ni.dll<br>PresentationFramework.ni.dll v3.0.6920.1427 built by: SP - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\PresentationFramewo#\\e3d4d240794478ea8067ceed63bbad1e\\PresentationFramework.ni.dll<br>wpfgfx_v0300.dll v3.0.6920.1427 built by: SP - C:\\WINDOWS\\Microsoft.NET\\Framework\\v3.0\\WPF\\wpfgfx_v0300.dll<br>PresentationUI.ni.dll v3.0.6920.1427 built by: SP - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\PresentationUI\\f256e6ef01b68fbc8d60628b5479185b\\PresentationUI.ni.dll<br>msimg32.dll v5.1.2600.5512 (xpsp.080413-2105) - C:\\WINDOWS\\system32\\msimg32.dll<br>System.Drawing.ni.dll v2.0.50727.3053 (netfxsp.050727-3000) - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\System.Drawing\\f9c517646d0706b9c61a41af685ff6b7\\System.Drawing.ni.dll<br>mscorjit.dll v2.0.50727.3053 (netfxsp.050727-3000) - C:\\WINDOWS\\Microsoft.NET\\Framework\\v2.0.50727\\mscorjit.dll<br>PresentationFramework.Luna.ni.dll v3.0.6920.1427 built by: SP - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\PresentationFramewo#\\70ac14c28100d0ca7ed1170597fbc172\\PresentationFramework.Luna.ni.dll<br>ILPPresentation.dll v1.0.0.0 - C:\\Documents and Settings\\alo\\Local Settings\\Apps\\2.0\\0T7C18RW.YVA\\MBJJL1EZ.1Y0\\ilpm..xbap_49ec8f7eb5a8c36b_0001.0000_707d36ef42fba960\\ILPPresentation.dll<br>ILPServiceInterface.dll v1.0.0.0 - C:\\Documents and Settings\\alo\\Local Settings\\Apps\\2.0\\0T7C18RW.YVA\\MBJJL1EZ.1Y0\\ilpm..xbap_49ec8f7eb5a8c36b_0001.0000_707d36ef42fba960\\ILPServiceInterface.dll<br>d3d9.dll v5.03.2600.5512 (xpsp.080413-0845) - C:\\WINDOWS\\system32\\d3d9.dll<br>d3d8thk.dll v5.03.2600.5512 (xpsp.080413-0845) - C:\\WINDOWS\\system32\\d3d8thk.dll<br>System.Deployment.ni.dll v2.0.50727.3053 (netfxsp.050727-3000) - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\System.Deployment\\6d697a2d4a40e33d2bef6f013bc24172\\System.Deployment.ni.dll<br>System.Configuration.ni.dll v2.0.50727.3053 (netfxsp.050727-3000) - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\System.Configuration\\60b25b27fbf5f0f94fd65fcbdc3f3b2b\\System.Configuration.ni.dll<br>System.Xml.ni.dll v2.0.50727.3053 (netfxsp.050727-3000) - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\System.Xml\\28cee07c1277b35abcb83560cd8c677c\\System.Xml.ni.dll<br>winrnr.dll v5.1.2600.5512 (xpsp.080413-2113) - C:\\WINDOWS\\System32\\winrnr.dll<br>WLDAP32.dll v5.1.2600.5512 (xpsp.080413-2113) - C:\\WINDOWS\\system32\\WLDAP32.dll<br>WindowsCodecs.dll v6.0.6001.17009 (longhorn.070920-1905) - C:\\WINDOWS\\system32\\WindowsCodecs.dll<br>security.dll v5.1.2600.5512 (xpsp.080413-2113) - C:\\WINDOWS\\system32\\security.dll<br>mscorsec.dll v2.0.50727.3053 (netfxsp.050727-3000) - C:\\WINDOWS\\Microsoft.NET\\Framework\\v2.0.50727\\mscorsec.dll<br>cryptnet.dll v5.131.2600.5512 (xpsp.080413-2113) - C:\\WINDOWS\\system32\\cryptnet.dll<br>WINHTTP.dll v5.1.2600.5727 (xpsp_sp3_gdr.081215-1359) - C:\\WINDOWS\\system32\\WINHTTP.dll<br>RibbonControlsLibrary.dll v3.5.31016.1 - C:\\Documents and Settings\\alo\\Local Settings\\Apps\\2.0\\0T7C18RW.YVA\\MBJJL1EZ.1Y0\\ilpm..xbap_49ec8f7eb5a8c36b_0001.0000_707d36ef42fba960\\RibbonControlsLibrary.dll<br>WPFToolkit.dll v3.5.50211.1 - C:\\Documents and Settings\\alo\\Local Settings\\Apps\\2.0\\0T7C18RW.YVA\\MBJJL1EZ.1Y0\\ilpm..xbap_49ec8f7eb5a8c36b_0001.0000_707d36ef42fba960\\WPFToolkit.dll<br>PresentationNative_v0300.dll v3.0.6920.1427 built by: SP - C:\\WINDOWS\\system32\\PresentationNative_v0300.dll<br>System.Windows.Controls.DataVisualization.Toolkit.dll v3.5.50211.1 - C:\\Documents and Settings\\alo\\Local Settings\\Apps\\2.0\\0T7C18RW.YVA\\MBJJL1EZ.1Y0\\ilpm..xbap_49ec8f7eb5a8c36b_0001.0000_707d36ef42fba960\\System.Windows.Controls.DataVisualization.Toolkit.dll<br>System.Core.ni.dll v3.5.30729.1 built by: SP - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\System.Core\\349efab7d4325e3cf4bc57b8a1b0f605\\System.Core.ni.dll<br>System.ServiceModel.ni.dll v3.0.4506.2152 (SP.030729-0100) - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\System.ServiceModel\\6546b83e8dc6bda9d61e2b969ac380f3\\System.ServiceModel.ni.dll<br>ILPServiceClient.dll v1.0.0.0 - C:\\Documents and Settings\\alo\\Local Settings\\Apps\\2.0\\0T7C18RW.YVA\\MBJJL1EZ.1Y0\\ilpm..xbap_49ec8f7eb5a8c36b_0001.0000_707d36ef42fba960\\ILPServiceClient.dll<br>SMDiagnostics.ni.dll v3.0.4506.2152 (SP.030729-0100) - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\SMDiagnostics\\79211ea9793c2a07bc28c7de65b2350f\\SMDiagnostics.ni.dll<br>System.Runtime.Serialization.ni.dll v3.0.4506.2152 (SP.030729-0100) - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\System.Runtime.Seri#\\7140256b1e3bf35d44a8dd98a4417252\\System.Runtime.Serialization.ni.dll<br>System.Web.ni.dll v2.0.50727.3053 (netfxsp.050727-3000) - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\System.Web\\7ab978a5d4256384ba0af0dc24198117\\System.Web.ni.dll<br>System.WorkflowServices.ni.dll v3.5.594.1152 - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\System.WorkflowServ#\\9c196402a2fb13fb2aa38af5443bfdbe\\System.WorkflowServices.ni.dll<br>System.ServiceModel.Web.ni.dll v3.5.594.1152 - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\System.ServiceModel#\\244eb842bea60d1f6cfdc18179187ec5\\System.ServiceModel.Web.ni.dll<br>Microsoft.VisualStudio.Diagnostics.ServiceModelSink.dll v9.0.30729.1 - C:\\WINDOWS\\assembly\\GAC_MSIL\\Microsoft.VisualStudio.Diagnostics.ServiceModelSink\\3.0.0.0__b03f5f7f11d50a3a\\Microsoft.VisualStudio.Diagnostics.ServiceModelSink.dll<br>System.IdentityModel.ni.dll v3.0.4506.2152 (SP.030729-0100) - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\System.IdentityModel\\2899af558a530772289cb4b022ef8d59\\System.IdentityModel.ni.dll<br>UIAutomationProvider.ni.dll v3.0.6920.1427 built by: SP - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\UIAutomationProvider\\fd23e35a951d31ea22e802cb811ec8d4\\UIAutomationProvider.ni.dll<br>UIAutomationTypes.ni.dll v3.0.6920.1427 built by: SP - C:\\WINDOWS\\assembly\\NativeImages_v2.0.50727_32\\UIAutomationTypes\\d3636894f6b04b5abf405f2505f2ee07\\UIAutomationTypes.ni.dll<br>PresentationFramework.dll v3.0.6920.1427 built by: SP - C:\\WINDOWS\\assembly\\GAC_MSIL\\PresentationFramework\\3.0.0.0__31bf3856ad364e35\\PresentationFramework.dll<br>diasymreader.dll v8.0.50727.3053 (netfxsp.050727-3000) - C:\\WINDOWS\\Microsoft.NET\\Framework\\v2.0.50727\\diasymreader.dll</p>",
    "PostedDate": "2010-04-21T11:08:14.113-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "433903",
    "ThreadId": "210081",
    "Html": "<p>I was able to get around this by making my application Full Trust for the time being, but it seems like a bit much that WPF Toolkit demands that it be run in Full Trust.&nbsp; Do people not make Partial Trust applications?</p>",
    "PostedDate": "2010-04-21T15:10:21.27-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "448286",
    "ThreadId": "210081",
    "Html": "I also get this error.",
    "PostedDate": "2010-05-27T10:18:52.507-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "453978",
    "ThreadId": "210081",
    "Html": "<p>I'm not sure that MS guys read discussions. Please, someone who can reproduce that, post it to their issue tracker as an issue.</p>",
    "PostedDate": "2010-06-10T06:59:22.61-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "477079",
    "ThreadId": "210081",
    "Html": "<p>Hello All,</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp; Call me a Microsoft hater if you want, but I do not think Microsoft cares to resolve this issue since .NET 4 came out and they whole sale coppied the VisualStateManager code implementation into their core WPF framework.&nbsp; The reason why this *wont* work is because the WPFToolKit.dll is not registered in the GAC and/or the application is not fully trusted.&nbsp; A simple work around would be for them to put a Try, Catch block around the both PresentationSource.FromVisual calls in their &quot;ShouldRunStateStoryboard&quot; method. (See <a href=\"http://wpf.codeplex.com/workitem/13836\">http://wpf.codeplex.com/workitem/13836</a>).&nbsp; Now I tried to compile my own flavor of WPFToolKit project, but I get a &quot;WPFToolKit.dll&quot; is expected to be loaded into the GAC error.&nbsp; =(&nbsp;</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp; The plain truth is that it is not &quot;<span style=\"font-family:Calibri;font-size:small\">economically feasible&quot; for them to correct issues like this since it would be better if we just use Silverlight as an alternative.&nbsp; =((&nbsp; But that is just this business professional's opinion.&nbsp; Why do I think this?&nbsp; Well for one, you can't seem to find the VisualStudio 2008 or .NET 3.5 connect.microsoft.com sites to start with and 2, no Microsoft or MVP personnel has even posted a response.&nbsp; Perhaps I'm wrong; I hope I am.&nbsp; Please feel free to disagree with me MVP(s),&nbsp;Microsoft, anyone, ect.&nbsp; </span></p>\r\n<p><span style=\"font-family:Calibri;font-size:small\">- Rashad Rivera<span style=\"font-family:Segoe UI;font-size:x-small\"><br>&nbsp;&nbsp;OmegusPrime.com</span></span></p>\r\n<p><span style=\"font-family:Calibri;font-size:small\"><span style=\"font-family:Segoe UI;font-size:x-small\">Connect Posting for our issue: <a href=\"https://connect.microsoft.com/VisualStudio/feedback/details/583702/shouldrunstatestoryboard-needs-try-catch-statement-block#tabs\">https://connect.microsoft.com/VisualStudio/feedback/details/583702/shouldrunstatestoryboard-needs-try-catch-statement-block#tabs</a></span></span></p>",
    "PostedDate": "2010-08-05T13:03:23.683-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "477414",
    "ThreadId": "210081",
    "Html": "<p>Well folks,</p>\r\n<p>&nbsp;&nbsp; Just like I said, Microsoft closed the connect ticket I submitted in one day saying: &quot;we are no longer accepting bugs for Microsoft Visual Studio 2008&quot;.&nbsp; I don't know, maybe they&nbsp;did not read this discussion.&nbsp;</p>\r\n<p>In any case, perhaps we can come up with our own solution.&nbsp; I changed the code in the <strong>ShouldRunStatesStoryboard</strong> to the following:</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:blue\">private</span> <span style=\"color:blue\">static</span> <span style=\"color:blue\">bool</span> ShouldRunStateStoryboard(FrameworkElement control, FrameworkElement stateGroupsRoot, VisualState state, VisualStateGroup <span style=\"color:blue\">group</span>) {\r\n\t<span style=\"color:blue\">bool</span> controlInTree = <span style=\"color:blue\">true</span>;\r\n\t<span style=\"color:blue\">bool</span> stateGroupsRootInTree = <span style=\"color:blue\">true</span>;\r\n\r\n\t<span style=\"color:green\">// We cannot simply check control.IsLoaded because the control may not be in the visual tree</span>\r\n\t<span style=\"color:green\">// even though IsLoaded is true.  Instead we will check that it can find a PresentationSource</span>\r\n\t<span style=\"color:green\">// which would tell us it's in the visual tree.</span>\r\n\t<span style=\"color:blue\">if</span> (control != <span style=\"color:blue\">null</span>) {\r\n\t\t<span style=\"color:green\">// If it's visible then it's in the visual tree, so we don't even have to look for a </span>\r\n\t\t<span style=\"color:green\">// PresentationSource</span>\r\n\t\t<span style=\"color:blue\">if</span> (!control.IsVisible) {\r\n\t\t\t<span style=\"color:blue\">try</span> {\r\n\t\t\t\tcontrolInTree = (PresentationSource.FromVisual(control) != <span style=\"color:blue\">null</span>);\r\n\t\t\t} <span style=\"color:blue\">catch</span> (System.Security.SecurityException) {\r\n\t\t\t\t<span style=\"color:green\">// did not have a disirable affect, lets try</span>\r\n\t\t\t\t<span style=\"color:green\">// leaving it as true</span>\r\n\t\t\t\t<span style=\"color:green\">//controlInTree = false;</span>\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t<span style=\"color:blue\">if</span> (stateGroupsRoot != <span style=\"color:blue\">null</span>) {\r\n\t\t<span style=\"color:blue\">if</span> (!stateGroupsRoot.IsVisible) {\r\n\t\t\t<span style=\"color:blue\">try</span> {\r\n\t\t\t\tstateGroupsRootInTree = (PresentationSource.FromVisual(stateGroupsRoot) != <span style=\"color:blue\">null</span>);\r\n\t\t\t} <span style=\"color:blue\">catch</span> (System.Security.SecurityException) {\r\n\t\t\t\t<span style=\"color:green\">// did not have a disirable affect, lets try</span>\r\n\t\t\t\t<span style=\"color:green\">// leaving it as true</span>\r\n\t\t\t\t<span style=\"color:green\">//stateGroupsRootInTree = false;</span>\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t<span style=\"color:blue\">return</span> (controlInTree &amp;&amp; stateGroupsRootInTree &amp;&amp; (state == <span style=\"color:blue\">group</span>.CurrentState));\r\n}\r\n\r\nI would love some suggestions from people to get it to work like it should.  Please reply back if you come up with another solution...  I hate to have to redevelop their code just to fix a silly issue like this SecurityException.  =}</pre>\r\n<pre>- Rashad Rivera<br>  OmegusPrime.com<br></pre>\r\n</div>",
    "PostedDate": "2010-08-06T08:37:18.14-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]