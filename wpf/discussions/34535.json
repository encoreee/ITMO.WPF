[
  {
    "Id": "114657",
    "ThreadId": "34535",
    "Html": "In the nice to have area.&nbsp; I would be great if there was a property about cell advancement. (i.e. EnterKeyAdvanceBy..... Row or Column).&nbsp; Right now Enter takes you to the next row and tab takes you to the next cell to the right.<br>\r\n",
    "PostedDate": "2008-08-29T06:30:13.33-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "114678",
    "ThreadId": "34535",
    "Html": "A customer asked a related question on this blog post,&nbsp;<a href=\"http://blogs.msdn.com/vinsibal/archive/2008/08/27/more-datagrid-samples-custom-sorting-drag-and-drop-of-rows-column-selection-and-single-click-editing.aspx#8904177\">http://blogs.msdn.com/vinsibal/archive/2008/08/27/more-datagrid-samples-custom-sorting-drag-and-drop-of-rows-column-selection-and-single-click-editing.aspx#8904177</a>.&nbsp; Basically the customer wanted the enter key to always move to the first cell of the next row.&nbsp; Customizing keyboard navigation in general for the DataGrid can be done with a similar technique that I discussed in that thread.\r\n",
    "PostedDate": "2008-08-29T07:30:40.463-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "114707",
    "ThreadId": "34535",
    "Html": "<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">If anyone is interested here is the code.&nbsp; Mostly Vincents,&nbsp; a little is mine.&nbsp; This will move each cell to the right when hitting (enter or return) and will go the&nbsp;next row upon reaching the end of the column.<br>\r\n<br>\r\nYou also have to have SelectionMode&nbsp;= Extended or otherwise you receive an error if you try to type in the last row.&nbsp; Not sure why?<br>\r\n<br>\r\nThanks Vincent<br>\r\n<br>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n<p>dataGrid1.PreviewKeyDown += </p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">new</span></span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">KeyEventHandler</span></span><span style=\"font-size:13px\">(dataGrid1_PreviewKeyDown);&nbsp;&nbsp; //Place this in Window1</span><br>\r\nprivate</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px\"></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">void</span></span><span style=\"font-size:13px\"> dataGrid1_PreviewKeyDown(</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">object</span></span><span style=\"font-size:13px\"> sender, </span><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">KeyEventArgs</span></span><span style=\"font-size:13px\"> e)\r\n<p>&nbsp;</p>\r\n<p>{</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">if</span></span><span style=\"font-size:13px\"> (e.Key == </span><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">Key</span></span><span style=\"font-size:13px\">.Enter)\r\n<p>&nbsp;</p>\r\n<p>{</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">int</span></span><span style=\"font-size:13px\"> currow = dataGrid1.Items.IndexOf(dataGrid1.CurrentCell.Item);\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">int</span></span><span style=\"font-size:13px\"> colcount = dataGrid1.Columns.Count;\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">int</span></span><span style=\"font-size:13px\"> curcol = dataGrid1.CurrentCell.Column.DisplayIndex;\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">if</span></span><span style=\"font-size:13px\"> (curcol &lt; dataGrid1.Columns.Count - 1)\r\n<p>&nbsp;</p>\r\n<p>{</p>\r\n<p>curcol++;</p>\r\n<p>dataGrid1.CurrentCell = </p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">new</span></span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">DataGridCellInfo</span></span><span style=\"font-size:13px\">(dataGrid1.CurrentItem, dataGrid1.Columns[curcol]);\r\n<p>&nbsp;</p>\r\n<p>e.Handled = </p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">true</span></span><span style=\"font-size:13px\">;\r\n<p>&nbsp;</p>\r\n<p>}</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">else\r\n<p>&nbsp;</p>\r\n</span></span>\r\n<p>&nbsp;</p>\r\n<span style=\"font-size:13px\">\r\n<p>{</p>\r\n<p>Dispatcher.BeginInvoke(</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">DispatcherPriority</span></span><span style=\"font-size:13px\">.Input, </span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">new</span></span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">DispatcherOperationCallback</span></span><span style=\"font-size:13px\">(OnKeyDown), </span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">new</span></span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">object</span></span><span style=\"font-size:13px\">[] { e });\r\n<p>&nbsp;</p>\r\n<p>e.Handled = </p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">false</span></span><span style=\"font-size:13px\">;\r\n<p>&nbsp;</p>\r\n<p>}</p>\r\n<p>}</p>\r\n<p>}</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">private</span></span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">object</span></span><span style=\"font-size:13px\"> OnKeyDown(</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">object</span></span><span style=\"font-size:13px\"> arg)\r\n<p>&nbsp;</p>\r\n<p>{</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">object</span></span><span style=\"font-size:13px\">[] arguments = arg </span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">as</span></span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">object</span></span><span style=\"font-size:13px\">[];\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">KeyEventArgs</span></span><span style=\"font-size:13px\"> e = (</span><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">KeyEventArgs</span></span><span style=\"font-size:13px\">)arguments[0];\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">if</span></span><span style=\"font-size:13px\"> (e.Key == </span><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">Key</span></span><span style=\"font-size:13px\">.Enter)\r\n<p>&nbsp;</p>\r\n<p>{</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">int</span></span><span style=\"font-size:13px\"> i = 0;\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">foreach</span></span><span style=\"font-size:13px\"> (</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">object</span></span><span style=\"font-size:13px\"> item </span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">in</span></span><span style=\"font-size:13px\"> dataGrid1.Items)\r\n<p>&nbsp;</p>\r\n<p>{</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">if</span></span><span style=\"font-size:13px\"> (item == dataGrid1.CurrentItem)\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">break</span></span><span style=\"font-size:13px\">;\r\n<p>&nbsp;</p>\r\n<p>i++;</p>\r\n<p>}</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">DataGridCell</span></span><span style=\"font-size:13px\"> cell = GetCell(i, 0);\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">if</span></span><span style=\"font-size:13px\"> (dataGrid1.SelectionUnit == </span><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">DataGridSelectionUnit</span></span><span style=\"font-size:13px\">.Cell || dataGrid1.SelectionUnit == </span><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">DataGridSelectionUnit</span></span><span style=\"font-size:13px\">.CellOrRowHeader)\r\n<p>&nbsp;</p>\r\n<p>{</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#008000\"><span style=\"font-size:13px;color:#008000\">// have to deselect current cell(s)\r\n<p>&nbsp;</p>\r\n</span></span>\r\n<p>&nbsp;</p>\r\n<span style=\"font-size:13px\">\r\n<p>dataGrid1.SelectedCells.Clear();</p>\r\n<p>}</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\"><span style=\"font-size:13px;color:#008000\">// set focus to the first cell\r\n<p>&nbsp;</p>\r\n</span></span>\r\n<p>&nbsp;</p>\r\n<span style=\"font-size:13px\">\r\n<p>cell.Focus();</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#008000\"><span style=\"font-size:13px;color:#008000\">// select the first cell\r\n<p>&nbsp;</p>\r\n</span></span>\r\n<p>&nbsp;</p>\r\n<span style=\"font-size:13px\">\r\n<p>cell.IsSelected = </p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">true</span></span><span style=\"font-size:13px\">;\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#008000\"><span style=\"font-size:13px;color:#008000\">// set the current cell to the first cell\r\n<p>&nbsp;</p>\r\n</span></span>\r\n<p>&nbsp;</p>\r\n<span style=\"font-size:13px\">\r\n<p>dataGrid1.CurrentCell = </p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">new</span></span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">DataGridCellInfo</span></span><span style=\"font-size:13px\">(dataGrid1.CurrentItem, dataGrid1.Columns[0]);\r\n<p>&nbsp;</p>\r\n<p>}</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">return</span></span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">null</span></span><span style=\"font-size:13px\">;\r\n<p>&nbsp;</p>\r\n<p>}</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2008-08-29T09:34:41.337-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]