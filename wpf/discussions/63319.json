[
  {
    "Id": "215271",
    "ThreadId": "63319",
    "Html": "<p>I can't see the empty row at the bottom of my DataGrid, which is used to add items. What am I doing wrong? Which conditions should be met so that DataGrid would allow me to add items?</p>\r\n<p>Here is the datagrid-related code (the real number of columns is bigger...):</p>\r\n<p>1. XAML:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>      <span style=\"color:Green\">&lt;!-- Transactions data grid --&gt;</span>\r\n      <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGrid</span> <span style=\"color:Red\">x:Name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">grdTransactions</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">ItemsSource</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding Transactions}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">IsSynchronizedWithCurrentItem</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">True</span><span style=\"color:Black\">&quot;</span>\r\n                   <span style=\"color:Red\">AutoGenerateColumns</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">False</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">SelectionMode</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Single</span><span style=\"color:Black\">&quot;</span>\r\n                   <span style=\"color:Red\">RowHeight</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">25</span><span style=\"color:Black\">&quot;</span> \r\n                   <span style=\"color:Red\">CanUserResizeRows</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">False</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">CanUserAddRows</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">True</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n         <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGrid.Columns</span><span style=\"color:Blue\">&gt;</span>\r\n            \r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGridTemplateColumn</span> <span style=\"color:Red\">Header</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Deal Date</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">MinWidth</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">120</span><span style=\"color:Black\">&quot;</span>\r\n                                       <span style=\"color:Red\">HeaderStyle</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{StaticResource CenterAlignedColumnHeaderStyle}</span><span style=\"color:Black\">&quot;</span>\r\n                                       <span style=\"color:Red\">CellStyle</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{StaticResource CenterAlignedCellStyle}</span><span style=\"color:Black\">&quot;</span>  <span style=\"color:Blue\">&gt;</span>\r\n               <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGridTemplateColumn.CellTemplate</span><span style=\"color:Blue\">&gt;</span>\r\n                  <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">DataTemplate</span><span style=\"color:Blue\">&gt;</span>\r\n                     <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">TextBlock</span> <span style=\"color:Red\">Text</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding DealDate, StringFormat=dd-MMM-yy}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Blue\">/&gt;</span>\r\n                  <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">DataTemplate</span><span style=\"color:Blue\">&gt;</span>\r\n               <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGridTemplateColumn.CellTemplate</span><span style=\"color:Blue\">&gt;</span>\r\n               <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGridTemplateColumn.CellEditingTemplate</span><span style=\"color:Blue\">&gt;</span>\r\n                  <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">DataTemplate</span><span style=\"color:Blue\">&gt;</span>\r\n                     <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DatePicker</span> <span style=\"color:Red\">SelectedDate</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding DealDate}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Cursor</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Hand</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Blue\">/&gt;</span>\r\n                  <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">DataTemplate</span><span style=\"color:Blue\">&gt;</span>\r\n               <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGridTemplateColumn.CellEditingTemplate</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGridTemplateColumn</span><span style=\"color:Blue\">&gt;</span>\r\n            \r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGridTextColumn</span> <span style=\"color:Red\">Header</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Shareholder</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Binding</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding Shareholder}</span><span style=\"color:Black\">&quot;</span> \r\n                                   <span style=\"color:Red\">CellStyle</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{StaticResource LeftAlignedCellStyle}</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n            \r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGridTextColumn</span> <span style=\"color:Red\">Header</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Bank</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Binding</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding Bank}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">IsReadOnly</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">True</span><span style=\"color:Black\">&quot;</span> \r\n                                   <span style=\"color:Red\">CellStyle</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{StaticResource LeftAlignedCellStyle}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Blue\">/&gt;</span>\r\n            \r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGridTemplateColumn</span> <span style=\"color:Red\">Header</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Status</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">MinWidth</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">120</span><span style=\"color:Black\">&quot;</span>\r\n                                       <span style=\"color:Red\">HeaderStyle</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{StaticResource CenterAlignedColumnHeaderStyle}</span><span style=\"color:Black\">&quot;</span>\r\n                                       <span style=\"color:Red\">CellStyle</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{StaticResource CenterAlignedCellStyle}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Blue\">&gt;</span>\r\n               \r\n               <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGridTemplateColumn.CellTemplate</span><span style=\"color:Blue\">&gt;</span>\r\n                  <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">DataTemplate</span><span style=\"color:Blue\">&gt;</span>\r\n                     <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">TextBlock</span> <span style=\"color:Red\">Text</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding Status.Caption}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Blue\">/&gt;</span>\r\n                  <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">DataTemplate</span><span style=\"color:Blue\">&gt;</span>\r\n               <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGridTemplateColumn.CellTemplate</span><span style=\"color:Blue\">&gt;</span>\r\n               <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGridTemplateColumn.CellEditingTemplate</span><span style=\"color:Blue\">&gt;</span>\r\n                  <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">DataTemplate</span><span style=\"color:Blue\">&gt;</span>\r\n                     &lt;ComboBox SelectedItem=&quot;{Binding Status}&quot; DisplayMemberPath=&quot;Caption&quot; Cursor=&quot;Hand&quot;\r\n                               ItemsSource=&quot;{Binding DataContext.StatusValues, \r\n                                                     RelativeSource={RelativeSource AncestorType={x:Type Window}}, \r\n                                                     IsAsync=true}&quot; /&gt;\r\n                  <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">DataTemplate</span><span style=\"color:Blue\">&gt;</span>\r\n               <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGridTemplateColumn.CellEditingTemplate</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGridTemplateColumn</span><span style=\"color:Blue\">&gt;</span>\r\n           \r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGridTextColumn</span> <span style=\"color:Red\">Header</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Received</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Binding</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding Received, StringFormat=N2}</span><span style=\"color:Black\">&quot;</span> \r\n                                   <span style=\"color:Red\">HeaderStyle</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{StaticResource CenterAlignedColumnHeaderStyle}</span><span style=\"color:Black\">&quot;</span>\r\n                                   <span style=\"color:Red\">CellStyle</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{StaticResource RightAlignedCellStyle}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Blue\">/&gt;</span>\r\n            \r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGridTextColumn</span> <span style=\"color:Red\">Header</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Price</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Binding</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding Price, StringFormat=N2}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">IsReadOnly</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">True</span><span style=\"color:Black\">&quot;</span>\r\n                                   <span style=\"color:Red\">HeaderStyle</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{StaticResource CenterAlignedColumnHeaderStyle}</span><span style=\"color:Black\">&quot;</span>\r\n                                   <span style=\"color:Red\">CellStyle</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{StaticResource RightAlignedCellStyle}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Blue\">/&gt;</span>\r\n            \r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGridTextColumn</span> <span style=\"color:Red\">Header</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Number</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Binding</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding Number, StringFormat=N4}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">IsReadOnly</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">True</span><span style=\"color:Black\">&quot;</span>\r\n                                   <span style=\"color:Red\">HeaderStyle</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{StaticResource CenterAlignedColumnHeaderStyle}</span><span style=\"color:Black\">&quot;</span>\r\n                                   <span style=\"color:Red\">CellStyle</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{StaticResource RightAlignedCellStyle}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Blue\">/&gt;</span>\r\n         <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGrid.Columns</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">tk</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGrid</span><span style=\"color:Blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>2. ViewModel:</p>\r\n<pre style=\"color:#000000;font-family:'Segoe UI', 'Microsoft Sans Serif', Arial, Geneva, sans-serif;font-size:10pt;margin:8px\">    <span style=\"color:blue\">public</span> <span style=\"color:blue\">abstract</span> <span style=\"color:blue\">class</span><span style=\"color:#48d1cc\"> ViewModelBase : INotifyPropertyChanged, IEditableCollectionView\r\n    </span>{\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">event</span> PropertyChangedEventHandler PropertyChanged;\r\n\r\n        <span style=\"color:blue\">protected</span> <span style=\"color:blue\">void</span> OnPropertyChanged(<span style=\"color:blue\">string</span> propertyName)\r\n        {\r\n            PropertyChangedEventHandler handler = PropertyChanged;\r\n\r\n            <span style=\"color:blue\">if</span> (handler != <span style=\"color:blue\">null</span>)\r\n            {\r\n                handler(<span style=\"color:blue\">this</span>, <span style=\"color:blue\">new</span> PropertyChangedEventArgs(propertyName));\r\n            }\r\n        }\r\n\r\n        <span style=\"color:blue\">#region</span> IEditableCollectionView Members\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">object</span> AddNew()\r\n        {\r\n            <span style=\"color:blue\">throw</span> <span style=\"color:blue\">new</span> NotImplementedException();\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">bool</span> CanAddNew\r\n        {\r\n            <span style=\"color:blue\">get</span> { <span style=\"color:blue\">return</span> <span style=\"color:blue\">true</span>; }\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">bool</span> CanCancelEdit\r\n        {\r\n            <span style=\"color:blue\">get</span> { <span style=\"color:blue\">throw</span> <span style=\"color:blue\">new</span> NotImplementedException(); }\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">bool</span> CanRemove\r\n        {\r\n            <span style=\"color:blue\">get</span> { <span style=\"color:blue\">throw</span> <span style=\"color:blue\">new</span> NotImplementedException(); }\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">void</span> CancelEdit()\r\n        {\r\n            <span style=\"color:blue\">throw</span> <span style=\"color:blue\">new</span> NotImplementedException();\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">void</span> CancelNew()\r\n        {\r\n            <span style=\"color:blue\">throw</span> <span style=\"color:blue\">new</span> NotImplementedException();\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">void</span> CommitEdit()\r\n        {\r\n            <span style=\"color:blue\">throw</span> <span style=\"color:blue\">new</span> NotImplementedException();\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">void</span> CommitNew()\r\n        {\r\n            <span style=\"color:blue\">throw</span> <span style=\"color:blue\">new</span> NotImplementedException();\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">object</span> CurrentAddItem\r\n        {\r\n            <span style=\"color:blue\">get</span> { <span style=\"color:blue\">throw</span> <span style=\"color:blue\">new</span> NotImplementedException(); }\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">object</span> CurrentEditItem\r\n        {\r\n            <span style=\"color:blue\">get</span> { <span style=\"color:blue\">throw</span> <span style=\"color:blue\">new</span> NotImplementedException(); }\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">void</span> EditItem(<span style=\"color:blue\">object</span> item)\r\n        {\r\n            <span style=\"color:blue\">throw</span> <span style=\"color:blue\">new</span> NotImplementedException();\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">bool</span> IsAddingNew\r\n        {\r\n            <span style=\"color:blue\">get</span> { <span style=\"color:blue\">throw</span> <span style=\"color:blue\">new</span> NotImplementedException(); }\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">bool</span> IsEditingItem\r\n        {\r\n            <span style=\"color:blue\">get</span> { <span style=\"color:blue\">throw</span> <span style=\"color:blue\">new</span> NotImplementedException(); }\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> NewItemPlaceholderPosition NewItemPlaceholderPosition\r\n        {\r\n            <span style=\"color:blue\">get</span>\r\n            {\r\n                <span style=\"color:blue\">throw</span> <span style=\"color:blue\">new</span> NotImplementedException();\r\n            }\r\n            <span style=\"color:blue\">set</span>\r\n            {\r\n                <span style=\"color:blue\">throw</span> <span style=\"color:blue\">new</span> NotImplementedException();\r\n            }\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">void</span> Remove(<span style=\"color:blue\">object</span> item)\r\n        {\r\n            <span style=\"color:blue\">throw</span> <span style=\"color:blue\">new</span> NotImplementedException();\r\n        }\r\n\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">void</span> RemoveAt(<span style=\"color:blue\">int</span> index)\r\n        {\r\n            <span style=\"color:blue\">throw</span> <span style=\"color:blue\">new</span> NotImplementedException();\r\n        }\r\n\r\n        <span style=\"color:blue\">#endregion</span>\r\n    }</pre>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>    <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">class</span><span style=\"color:MediumTurquoise\"> MainViewModel : ViewModelBase\r\n    </span>{\r\n        <span style=\"color:Blue\">public</span> MainViewModel()\r\n        {\r\n            db = FundkeeperModel.GetDataContext();\r\n            transactions = <span style=\"color:Blue\">new</span> ObservableCollection&lt;TransactionViewModel&gt;(\r\n                <span style=\"color:Blue\">from</span> t <span style=\"color:Blue\">in</span> db.Transactions\r\n                <span style=\"color:Blue\">select</span> <span style=\"color:Blue\">new</span> TransactionViewModel(t));\r\n            transactionsView = CollectionViewSource.GetDefaultView(transactions);\r\n        }\r\n\r\n        <span style=\"color:Blue\">#region</span> Properties\r\n\r\n        <span style=\"color:Blue\">public</span> ObservableCollection&lt;TransactionViewModel&gt; Transactions\r\n        {\r\n            <span style=\"color:Blue\">get</span> { <span style=\"color:Blue\">return</span> transactions; }\r\n        }\r\n\r\n        <span style=\"color:Blue\">public</span> IEnumerable&lt;Status&gt; StatusValues\r\n        {\r\n            <span style=\"color:Blue\">get</span> { <span style=\"color:Blue\">return</span> db.Status.AsEnumerable(); }\r\n        }\r\n\r\n        <span style=\"color:Blue\">#endregion</span>\r\n\r\n        <span style=\"color:Blue\">#region</span> Private Members\r\n\r\n        <span style=\"color:Blue\">private</span> FundkeeperDataContext db;\r\n        <span style=\"color:Blue\">private</span> ObservableCollection&lt;TransactionViewModel&gt; transactions;\r\n        <span style=\"color:Blue\">private</span> ICollectionView transactionsView;\r\n\r\n        <span style=\"color:Blue\">#endregion</span>\r\n    }\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\"></div>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>    <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">class</span><span style=\"color:MediumTurquoise\"> TransactionViewModel : ViewModelBase\r\n    </span>{\r\n        <span style=\"color:Blue\">public</span> TransactionViewModel(Transaction transaction)\r\n        {\r\n            <span style=\"color:Blue\">this</span>.transaction = transaction;\r\n        }\r\n\r\n        <span style=\"color:Blue\">#region</span> Binding Properties\r\n\r\n        <span style=\"color:Blue\">public</span> DateTime DealDate\r\n        {\r\n            <span style=\"color:Blue\">get</span> { <span style=\"color:Blue\">return</span> transaction.DealDate; }\r\n            <span style=\"color:Blue\">set</span> { transaction.DealDate = value; }\r\n        }\r\n\r\n        <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">string</span> Shareholder\r\n        {\r\n            <span style=\"color:Blue\">get</span> { <span style=\"color:Blue\">return</span> transaction.Shareholder.Name; }\r\n            <span style=\"color:Blue\">set</span>\r\n            {\r\n            }\r\n        }\r\n\r\n        <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">string</span> Bank\r\n        {\r\n            <span style=\"color:Blue\">get</span> { <span style=\"color:Blue\">return</span> transaction.Owner.Bank.Name; }\r\n            <span style=\"color:Blue\">set</span>\r\n            {\r\n            }\r\n        }\r\n\r\n        <span style=\"color:Blue\">public</span> Status Status\r\n        {\r\n            <span style=\"color:Blue\">get</span> { <span style=\"color:Blue\">return</span> transaction.Status; }\r\n            <span style=\"color:Blue\">set</span> { transaction.Status = value; }\r\n        }\r\n\r\n        <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">decimal</span> Received\r\n        {\r\n            <span style=\"color:Blue\">get</span> { <span style=\"color:Blue\">return</span> transaction.Received ?? 0; }\r\n            <span style=\"color:Blue\">set</span> {\r\n                transaction.Received = value;\r\n                <span style=\"color:Blue\">this</span>.RecalculateFields();\r\n            }\r\n        }\r\n\r\n        <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">decimal</span> Price\r\n        {\r\n            <span style=\"color:Blue\">get</span> { <span style=\"color:Blue\">return</span> transaction.SharePrice.Price; }\r\n        }\r\n\r\n        <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">decimal</span> Number\r\n        {\r\n            <span style=\"color:Blue\">get</span> { <span style=\"color:Blue\">return</span> <span style=\"color:Blue\">this</span>.Final / <span style=\"color:Blue\">this</span>.Price; }\r\n        }\r\n\r\n        <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">bool</span> IsSelected { <span style=\"color:Blue\">get</span>; <span style=\"color:Blue\">set</span>; }\r\n\r\n        <span style=\"color:Blue\">#endregion</span>\r\n\r\n        <span style=\"color:Blue\">#region</span> Private Members\r\n\r\n        <span style=\"color:Blue\">void</span> RecalculateFields()\r\n        {\r\n            OnPropertyChanged(<span style=\"color:#A31515\">&quot;Dealing&quot;</span>);\r\n            OnPropertyChanged(<span style=\"color:#A31515\">&quot;Final&quot;</span>);\r\n            OnPropertyChanged(<span style=\"color:#A31515\">&quot;Number&quot;</span>);\r\n        }\r\n\r\n        Transaction transaction;\r\n\r\n        <span style=\"color:Blue\">#endregion</span>\r\n    }\r\n</pre>\r\n</div>\r\n<p>Thank you!</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-07-23T05:56:32.337-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]