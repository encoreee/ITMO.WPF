[
  {
    "Id": "589512",
    "ThreadId": "251989",
    "Html": "\r\n<p>I'm trying to copy an image of a bar chart to clipboard so it can be pasted into another program (i.e. Powerpoint). The chart portion of the image copies ok, but the surrounding area that includes the axes, titles, and labels is solid black. I'm using the\r\n following code to try to grab a screen capture of the chart image.</p>\r\n<pre style=\"font-family:Consolas; background:white; color:black; font-size:13px\"><span style=\"color:blue\">private</span>&nbsp;<span style=\"color:blue\">static</span>&nbsp;<span style=\"color:#2b91af\">BitmapSource</span>&nbsp;CaptureScreen(<span style=\"color:#2b91af\">Visual</span>&nbsp;target,&nbsp;<span style=\"color:blue\">double</span>&nbsp;dpiX,&nbsp;<span style=\"color:blue\">double</span>&nbsp;dpiY)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">if</span>&nbsp;(target&nbsp;==&nbsp;<span style=\"color:blue\">null</span>)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">return</span>&nbsp;<span style=\"color:blue\">null</span>;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af\">Rect</span>&nbsp;bounds&nbsp;=&nbsp;<span style=\"color:#2b91af\">VisualTreeHelper</span>.GetDescendantBounds(target);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af\">RenderTargetBitmap</span>&nbsp;targetBitmap&nbsp;=\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">new</span>&nbsp;<span style=\"color:#2b91af\">RenderTargetBitmap</span>((<span style=\"color:blue\">int</span>)bounds.Width,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span style=\"color:blue\">int</span>)bounds.Height,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;96d,&nbsp;96d,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af\">PixelFormats</span>.Default);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;targetBitmap.Render(target);\r\n \r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:#2b91af\">BitmapSource</span>&nbsp;source&nbsp;=&nbsp;<span style=\"color:#2b91af\">BitmapFrame</span>.Create(targetBitmap);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color:blue\">return</span>&nbsp;source;\r\n\t}</pre>\r\n<pre style=\"font-family:Consolas; background:white; color:black; font-size:13px\">Then I just do a Clipboard.SetImage() on the returned value. I'm assuming there is something obvious that I'm missing as pasting a screen capture isn't</pre>\r\n<pre style=\"font-family:Consolas; background:white; color:black; font-size:13px\">that unusal of a goal. Any help or pointer to some sample code would be appreciated.</pre>\r\n<pre style=\"font-family:Consolas; background:white; color:black; font-size:13px\">&nbsp;</pre>\r\n",
    "PostedDate": "2011-03-31T07:13:00.033-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]