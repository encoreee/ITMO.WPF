[
  {
    "Id": "134247",
    "ThreadId": "40468",
    "Html": "<span style=\"font-size:13px;color:#0000ff\"> I have found a problem when setting datagrid column display indexes programattically<br>\r\n<br>\r\nWhen trying to save the state of users columns in an app i built using the wpf tookit i found that in some circumstances i would get an index out of range error when ordering columns a certain way<br>\r\n<br>\r\nI have included an example<br>\r\n<br>\r\n&lt;</span><span style=\"font-size:13px;color:#a31515\">Window</span><span style=\"font-size:13px;color:#ff0000\"> x</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#ff0000\">Class</span><span style=\"font-size:13px;color:#0000ff\">=&quot;Window1&quot; </span><span style=\"font-size:13px\"></span><span style=\"font-size:13px;color:#ff0000\">xmlns</span><span style=\"font-size:13px;color:#0000ff\">=<a href=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\">http://schemas.microsoft.com/winfx/2006/xaml/presentation</a>&quot; </span><span style=\"font-size:13px;color:#ff0000\">xmlns</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#ff0000\">x</span><span style=\"font-size:13px;color:#0000ff\">=<a href=\"http://schemas.microsoft.com/winfx/2006/xaml\">http://schemas.microsoft.com/winfx/2006/xaml</a> </span><span style=\"font-size:13px;color:#ff0000\">Title</span><span style=\"font-size:13px;color:#0000ff\">=&quot;Window1&quot;</span><span style=\"font-size:13px;color:#ff0000\"> Height</span><span style=\"font-size:13px;color:#0000ff\">=&quot;300&quot;</span><span style=\"font-size:13px;color:#ff0000\"> Width</span><span style=\"font-size:13px;color:#0000ff\">=&quot;300&quot;</span><span style=\"font-size:13px;color:#ff0000\"> xmlns</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#ff0000\">my</span><span style=\"font-size:13px;color:#0000ff\">=&quot;http://schemas.microsoft.com/wpf/2008/toolkit&quot;&gt;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">&lt;</span><span style=\"font-size:13px;color:#a31515\">Grid</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">    &lt;</span><span style=\"font-size:13px;color:#a31515\">my</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGrid</span><span style=\"font-size:13px;color:#ff0000\"> Margin</span><span style=\"font-size:13px;color:#0000ff\">=&quot;12&quot;</span><span style=\"font-size:13px;color:#ff0000\"> Name</span><span style=\"font-size:13px;color:#0000ff\">=&quot;DataGrid1&quot;&gt;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">        &lt;</span><span style=\"font-size:13px;color:#a31515\">my</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGrid.Columns</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">            &lt;</span><span style=\"font-size:13px;color:#a31515\">my</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGridTextColumn</span><span style=\"font-size:13px;color:#ff0000\"> Header</span><span style=\"font-size:13px;color:#0000ff\">=&quot;Column1&quot;</span><span style=\"font-size:13px;color:#ff0000\"> x</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#ff0000\">Name</span><span style=\"font-size:13px;color:#0000ff\">=&quot;dgcColumn1&quot; /&gt;</span><span style=\"font-size:13px;color:#a31515\"> <br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">            &lt;</span><span style=\"font-size:13px;color:#a31515\">my</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGridTextColumn</span><span style=\"font-size:13px;color:#ff0000\"> Header</span><span style=\"font-size:13px;color:#0000ff\">=&quot;Column2&quot;</span><span style=\"font-size:13px;color:#ff0000\"> x</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#ff0000\">Name</span><span style=\"font-size:13px;color:#0000ff\">=&quot;dgcColumn2&quot; /&gt;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">            &lt;</span><span style=\"font-size:13px;color:#a31515\">my</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGridTextColumn</span><span style=\"font-size:13px;color:#ff0000\"> Header</span><span style=\"font-size:13px;color:#0000ff\">=&quot;Column3&quot;</span><span style=\"font-size:13px;color:#ff0000\"> x</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#ff0000\">Name</span><span style=\"font-size:13px;color:#0000ff\">=&quot;dgcColumn3&quot; /&gt;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">            &lt;</span><span style=\"font-size:13px;color:#a31515\">my</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGridTextColumn</span><span style=\"font-size:13px;color:#ff0000\"> Header</span><span style=\"font-size:13px;color:#0000ff\">=&quot;Column4&quot;</span><span style=\"font-size:13px;color:#ff0000\"> x</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#ff0000\">Name</span><span style=\"font-size:13px;color:#0000ff\">=&quot;dgcColumn4&quot; /&gt;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">        &lt;/</span><span style=\"font-size:13px;color:#a31515\">my</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGrid.Columns</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">    &lt;/</span><span style=\"font-size:13px;color:#a31515\">my</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGrid</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">&lt;/</span><span style=\"font-size:13px;color:#a31515\">Grid</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n&lt;/</span><span style=\"font-size:13px;color:#a31515\">Window</span><span style=\"font-size:13px;color:#0000ff\">&gt; <span style=\"font-size:13px;color:#0000ff\"> </span> </span><br>\r\n<span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">\r\n<p>Class</p>\r\n</span>\r\n<p> </p>\r\n</span>\r\n<p><span style=\"font-size:13px\">Window1 <br>\r\n </span><span style=\"font-size:13px;color:#0000ff\">    Private</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">Sub</span><span style=\"font-size:13px\"> Window1_Initialized(</span><span style=\"font-size:13px;color:#0000ff\">ByVal</span><span style=\"font-size:13px\"> sender </span><span style=\"font-size:13px;color:#0000ff\">As</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">Object</span><span style=\"font-size:13px\">, </span><span style=\"font-size:13px;color:#0000ff\">ByVal</span><span style=\"font-size:13px\"> e </span><span style=\"font-size:13px;color:#0000ff\">As</span><span style=\"font-size:13px\"> System.EventArgs) </span><span style=\"font-size:13px;color:#0000ff\">Handles</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">Me</span><span style=\"font-size:13px\">.Initialized<br>\r\n        dgcColumn1.DisplayIndex = 2<br>\r\n        dgcColumn2.DisplayIndex = 1<br>\r\n        dgcColumn3.DisplayIndex = 0<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">    End</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">Sub <br>\r\nEnd</span> </span><span style=\"font-size:13px;color:#0000ff\">Class <br>\r\n</span><br>\r\nSystem.ArgumentOutOfRangeException was unhandled<br>\r\n  Message=&quot;Specified argument was out of the range of valid values.\\r\\nParameter name: index&quot;<br>\r\n  Source=&quot;PresentationCore&quot;<br>\r\n  ParamName=&quot;index&quot;<br>\r\n  <br>\r\nWhen i only have 3 columns it doesnt error but only column 3 gets displayed which could be the root of the problem<br>\r\n<br>\r\nAlex</p>\r\n",
    "PostedDate": "2008-11-21T06:35:45.433-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "177790",
    "ThreadId": "40468",
    "Html": "I've got a similar problem.<br>\r\n<br>\r\nI'm setting the GridView's column order &amp; visibility from code:<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int index = 0;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (myObject columnData in Properties.Settings.Default.ColumnData)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataGridColumn column = dataGridView.Columns[index];<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; column.DisplayIndex = columnData.Index;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; column.Visibility = columnData.Visibility ? Visibility.Visible : Visibility.Hidden;<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Set up DataGrid context menu item for this column<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n<br>\r\nIf I comment out either the DisplayIndex line or Visibility line it works fine all the time - the correct columns are visible or the columns are in the expected order.<br>\r\n<br>\r\nIf the columns are in the default order then there's no problem. It's only when there are some invisible columns and some columns are in a different order that the exception gets thrown.<br>\r\n<br>\r\nThe line is (DataGridCellsPanel.cs, ArrangeOverride, 1362):<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ArrangeChild(children[childIndex] as UIElement, i, arrangeState);<br>\r\n<br>\r\nchildIndex is out of range.<br>\r\n<br>\r\nThis is in the WPF Toolkit March 2009 (Version 3.5.40320.1) (3.5.40320.1)<br>\r\n<br>\r\nI'm running on .NET 3.5 SP1 on Windows XP SP3 (fully up to date).<br>\r\n<br>\r\nChris.<br>\r\n",
    "PostedDate": "2009-04-09T14:56:17.17-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "178039",
    "ThreadId": "40468",
    "Html": "This is a indeed a bug, and we've filed a bug in our database to track the issue.<br>\r\n<br>\r\nYou may try working around the issue by calling Dispatcher.BeginInvoke at Background priority within a Loaded event. It appears that the issue does not occur if the order is changed after the page has reached a steady state.<br>\r\n<br>\r\nBen\r\n",
    "PostedDate": "2009-04-10T13:53:31.843-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]