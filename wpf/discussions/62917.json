[
  {
    "Id": "213650",
    "ThreadId": "62917",
    "Html": "<p>Hey guys, I'm loving the toolkit, but among other things, I do a lot of WPF from PowerShell via <a href=\"http://boots.codeplex.com\">PowerBoots</a>...</p>\r\n<p>After the last release, I've been working on creating some graphing/charting scripts and when I finally decided I needed to change the tooltips, I ran into a bit of a threading issue (I'll refrain from ranting about needing to template the whole control just to get at the tooltips).</p>\r\n<p>I followed a <a href=\"http://blogs.msdn.com/delay/archive/2009/05/19/chart-tweaking-made-easy-how-to-make-four-simple-color-tooltip-changes-with-silverlight-wpf-charting.aspx\">blog post by Delay</a> and an article on the Expression Blend site, and came up with a reasonable template which works ... except that when I try to create two charts in a row, it dies the second time when I set the .DataPointStyle .... because somewhere deep in the StylePalettePropertyChanged event, I get a thread access exception:</p>\r\n<p>&nbsp;</p>\r\n<pre>at System.Windows.Threading.Dispatcher.VerifyAccess()<br>   at System.Windows.Threading.DispatcherObject.VerifyAccess()<br>   at System.Windows.Style.get_TargetType()<br>   at System.Windows.Controls.DataVisualization.StyleDispenserExtensions.&lt;&gt;c__DisplayClass1.b__0(Style style) in C:\\dd\\WPF_1\\src\\wpf\\src\\ControlsPack\\WPFToolkit\\DataVisualization\\StyleDispenserExtensions.cs:line 27<br>   at System.Windows.Controls.DataVisualization.Charting.StyleEnumerator.GetIndexOfNextSuitableStyle(Int32 startIndex) in C:\\dd\\WPF_1\\src\\wpf\\src\\ControlsPack\\WPFToolkit\\DataVisualization\\Charting\\StyleEnumerator.cs:line 90<br>   at System.Windows.Controls.DataVisualization.Charting.StyleEnumerator.MoveNext() in C:\\dd\\WPF_1\\src\\wpf\\src\\ControlsPack\\WPFToolkit\\DataVisualization\\Charting\\StyleEnumerator.cs:line 189<br>   at System.Windows.Controls.DataVisualization.Charting.DataPointSingleSeriesWithAxes.RefreshStyles() in C:\\dd\\WPF_1\\src\\wpf\\src\\ControlsPack\\WPFToolkit\\DataVisualization\\Charting\\Series\\DataPointSingleSeriesWithAxes.cs:line 263<br>   at System.Windows.Controls.DataVisualization.Charting.Chart.OnStylePalettePropertyChanged(Collection`1 newValue) in C:\\dd\\WPF_1\\src\\wpf\\src\\ControlsPack\\WPFToolkit\\DataVisualization\\Charting\\Chart\\Chart.cs:line 282<br>   at System.Windows.Controls.DataVisualization.Charting.Chart.OnStylePalettePropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e) in C:\\dd\\WPF_1\\src\\wpf\\src\\ControlsPack\\WPFToolkit\\DataVisualization\\Charting\\Chart\\Chart.cs:line 270<br>   at System.Windows.DependencyObject.OnPropertyChanged(DependencyPropertyChangedEventArgs e)<br>   at System.Windows.FrameworkElement.OnPropertyChanged(DependencyPropertyChangedEventArgs e)<br>   at System.Windows.DependencyObject.NotifyPropertyChange(DependencyPropertyChangedEventArgs args)<br><br>...</pre>\r\n<p>I haven't dug very far, but I was hoping someone might see this and say something like &quot;oh, yeah, you've made the mistake of reusing the same ... thingy ... twice&quot;&nbsp; or something.&nbsp; I can't figure it out, except that if I don't set the DataPointStyle, I don't have a problem, and if I only have one chart, I'm fine.&nbsp; Thoughts? Questions?&nbsp; I can post my code (mostly in PowerShell) and templates...</p>",
    "PostedDate": "2009-07-19T20:01:19.867-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]