[
  {
    "Id": "220885",
    "ThreadId": "64865",
    "Html": "<p>I am having an issue playing storyboards in my MVVM project. I used the sample provided in the messenger demo that utlizes an attached property to cause storyboards to play.</p>\r\n<p>My view contains two storyboards, one is displayed to expand the control so if lies in from the top right and becomes visible, the other sends it back to the top right to &quot;collape&quot; it. The animations work fine if I start them from a trigger on the control loaded event. Since that is not what I want I created an attached dependency property in a static class to handle the transitions.</p>\r\n<p>The first transition works just fine, when the ViewVisibleState is set to VisibleState.Expand the storyboard plays and the control scales and comes into view. When I change the property to VisibleState.Collapse the property changed event on the StoryboardManager class for the VisibleState property is raised but the oldStoryboard is not being removed and the newStoryboard is not being played as the control just sits on the screen.</p>\r\n<p>I am not sure what the problem is because the property changed event does fire and no errors are raised when attempting to remove the old storyboard or play the new one. Seems like it will play one storyboard once and then any calls are just ignored. I tried changing the HandOffbehavior and FillBehavior, tried removing the SB when the completed event is raised but nothing seems to make a difference.</p>\r\n<p>When looking at the code below I bolded the sections I think are relevant, rather than posting all the code that sets the ViewVisibleState property since the property changed event is being raised when the VisibleState changes from Expand to Collapse or visa versa.</p>\r\n<p>Any suggestions or ideas are welcome...</p>\r\n<p>- Cameron</p>\r\n<p>&nbsp;</p>\r\n<p>Here is my view's xaml:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">UserControl</span>\r\n    <span style=\"color:Red\">xmlns</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">http://schemas.microsoft.com/winfx/2006/xaml/presentation</span><span style=\"color:Black\">&quot;</span>\r\n    <span style=\"color:Red\">xmlns:x</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">http://schemas.microsoft.com/winfx/2006/xaml</span><span style=\"color:Black\">&quot;</span>\r\n    <span style=\"color:Red\">xmlns:d</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">http://schemas.microsoft.com/expression/blend/2008</span><span style=\"color:Black\">&quot;</span> \r\n\t<span style=\"color:Red\">xmlns:mc</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">http://schemas.openxmlformats.org/markup-compatibility/2006</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">mc:Ignorable</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">d</span><span style=\"color:Black\">&quot;</span> \r\n\t<span style=\"color:Red\">xmlns:BL_WDE_CVT_Dashboard_Models</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">clr-namespace:BL.WDE.CVT.Dashboard.Models</span><span style=\"color:Black\">&quot;</span>\r\n\t<span style=\"color:Red\">xmlns:ui</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">clr-namespace:BL.WDE.CVT.Dashboard.UI;assembly=BL.WDE.CVT.Dashboard.UI</span><span style=\"color:Black\">&quot;</span> \r\n    <span style=\"color:Red\">xmlns:i</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity</span><span style=\"color:Black\">&quot;</span> \r\n    <span style=\"color:Red\">xmlns:im</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">clr-namespace:Microsoft.Expression.Interactivity.Media;assembly=Microsoft.Expression.Interactions</span><span style=\"color:Black\">&quot;</span> \r\n    <span style=\"color:Red\">x:Class</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">BL.WDE.CVT.Dashboard.Views.SignInView</span><span style=\"color:Black\">&quot;</span>\r\n    <span style=\"color:Red\">Height</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">350</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Width</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">350</span><span style=\"color:Black\">&quot;</span>\r\n    <span style=\"color:Red\"><strong>ui:StoryboardManager.VisibleState</strong></span><span style=\"color:Blue\"><strong>=</strong></span><span style=\"color:Black\"><strong>&quot;</strong></span><span style=\"color:Blue\"><strong>{Binding ViewVisibleState, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}</strong></span><span style=\"color:Black\"><strong>&quot;</strong></span><span style=\"color:Blue\"><strong>&gt;</strong></span>\r\n    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">UserControl.Resources</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">Storyboard</span> <span style=\"color:Red\">x:Key</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">ExpandStoryboard</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">DoubleAnimationUsingKeyFrames</span> <span style=\"color:Red\">BeginTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:00</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Storyboard.TargetName</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">grid</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Storyboard.TargetProperty</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SplineDoubleKeyFrame</span> <span style=\"color:Red\">KeyTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:00</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">0.183</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SplineDoubleKeyFrame</span> <span style=\"color:Red\">KeyTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:01</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">1</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n            <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">DoubleAnimationUsingKeyFrames</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">DoubleAnimationUsingKeyFrames</span> <span style=\"color:Red\">BeginTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:00</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Storyboard.TargetName</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">grid</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Storyboard.TargetProperty</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleY)</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SplineDoubleKeyFrame</span> <span style=\"color:Red\">KeyTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:00</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">0.091</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SplineDoubleKeyFrame</span> <span style=\"color:Red\">KeyTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:01</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">1</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n            <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">DoubleAnimationUsingKeyFrames</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">DoubleAnimationUsingKeyFrames</span> <span style=\"color:Red\">BeginTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:00</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Storyboard.TargetName</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">grid</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Storyboard.TargetProperty</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SplineDoubleKeyFrame</span> <span style=\"color:Red\">KeyTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:00</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">386.925</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SplineDoubleKeyFrame</span> <span style=\"color:Red\">KeyTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:01</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">0</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n            <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">DoubleAnimationUsingKeyFrames</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">DoubleAnimationUsingKeyFrames</span> <span style=\"color:Red\">BeginTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:00</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Storyboard.TargetName</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">grid</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Storyboard.TargetProperty</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SplineDoubleKeyFrame</span> <span style=\"color:Red\">KeyTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:00</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">-318.775</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SplineDoubleKeyFrame</span> <span style=\"color:Red\">KeyTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:01</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">0</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n            <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">DoubleAnimationUsingKeyFrames</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">DoubleAnimationUsingKeyFrames</span> <span style=\"color:Red\">BeginTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:00</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Storyboard.TargetName</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">grid</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Storyboard.TargetProperty</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">(UIElement.Opacity)</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SplineDoubleKeyFrame</span> <span style=\"color:Red\">KeyTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:00</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">0</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SplineDoubleKeyFrame</span> <span style=\"color:Red\">KeyTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:01</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">1</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n            <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">DoubleAnimationUsingKeyFrames</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">Storyboard</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">Storyboard</span> <span style=\"color:Red\">x:Key</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">CollapseStoryboard</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">DoubleAnimationUsingKeyFrames</span> <span style=\"color:Red\">BeginTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:00</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Storyboard.TargetName</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">grid</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Storyboard.TargetProperty</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SplineDoubleKeyFrame</span> <span style=\"color:Red\">KeyTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:00</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">1</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SplineDoubleKeyFrame</span> <span style=\"color:Red\">KeyTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:01</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">0.183</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n            <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">DoubleAnimationUsingKeyFrames</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">DoubleAnimationUsingKeyFrames</span> <span style=\"color:Red\">BeginTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:00</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Storyboard.TargetName</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">grid</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Storyboard.TargetProperty</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleY)</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SplineDoubleKeyFrame</span> <span style=\"color:Red\">KeyTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:00</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">1</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SplineDoubleKeyFrame</span> <span style=\"color:Red\">KeyTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:01</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">0.091</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n            <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">DoubleAnimationUsingKeyFrames</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">DoubleAnimationUsingKeyFrames</span> <span style=\"color:Red\">BeginTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:00</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Storyboard.TargetName</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">grid</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Storyboard.TargetProperty</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SplineDoubleKeyFrame</span> <span style=\"color:Red\">KeyTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:00</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">0</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SplineDoubleKeyFrame</span> <span style=\"color:Red\">KeyTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:01</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">386.925</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n            <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">DoubleAnimationUsingKeyFrames</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">DoubleAnimationUsingKeyFrames</span> <span style=\"color:Red\">BeginTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:00</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Storyboard.TargetName</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">grid</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Storyboard.TargetProperty</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SplineDoubleKeyFrame</span> <span style=\"color:Red\">KeyTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:00</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">0</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SplineDoubleKeyFrame</span> <span style=\"color:Red\">KeyTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:01</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">-318.775</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n            <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">DoubleAnimationUsingKeyFrames</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">DoubleAnimationUsingKeyFrames</span> <span style=\"color:Red\">BeginTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:00</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Storyboard.TargetName</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">grid</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Storyboard.TargetProperty</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">(UIElement.Opacity)</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SplineDoubleKeyFrame</span> <span style=\"color:Red\">KeyTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:00</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">1</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SplineDoubleKeyFrame</span> <span style=\"color:Red\">KeyTime</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">00:00:01</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">0</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n            <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">DoubleAnimationUsingKeyFrames</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">Storyboard</span><span style=\"color:Blue\">&gt;</span>\r\n    <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">UserControl.Resources</span><span style=\"color:Blue\">&gt;</span>\r\n    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">Grid</span> <span style=\"color:Red\">VerticalAlignment</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Center</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">HorizontalAlignment</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Center</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Width</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">350</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Height</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">350</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">x:Name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">grid</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">RenderTransformOrigin</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">0.5,0.5</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">Grid.RenderTransform</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">TransformGroup</span><span style=\"color:Blue\">&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">ScaleTransform</span><span style=\"color:Blue\">/&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">SkewTransform</span><span style=\"color:Blue\">/&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">RotateTransform</span><span style=\"color:Blue\">/&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">TranslateTransform</span><span style=\"color:Blue\">/&gt;</span>\r\n            <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">TransformGroup</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">Grid.RenderTransform</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">TextBlock</span> <span style=\"color:Red\">HorizontalAlignment</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Left</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">VerticalAlignment</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Top</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">FontSize</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">18.667</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">FontWeight</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Bold</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Text</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Welcome To Your Dashboard!</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">TextWrapping</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Wrap</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Foreground</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{DynamicResource H1Brush}</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">TextBlock</span> <span style=\"color:Red\">HorizontalAlignment</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Left</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Margin</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">0,30,0,0</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">VerticalAlignment</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Top</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Text</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding CurrentDate}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">TextWrapping</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Wrap</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Foreground</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{DynamicResource InfoBrush}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">x:Name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">lblDate</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">FontSize</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">14.667</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">TextBlock</span> <span style=\"color:Red\">HorizontalAlignment</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Left</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Margin</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">0,83,0,0</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">VerticalAlignment</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Top</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Text</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Employee ID</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">TextWrapping</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Wrap</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Foreground</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{DynamicResource TextBrush}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">FontSize</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">16</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">TextBlock</span> <span style=\"color:Red\">HorizontalAlignment</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Left</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Margin</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">16.196,139.93,0,0</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">VerticalAlignment</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Top</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Text</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Password</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">TextWrapping</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Wrap</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Foreground</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{DynamicResource TextBrush}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">FontSize</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">16</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">TextBox</span> <span style=\"color:Red\">Margin</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">94.237,83,8,0</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">VerticalAlignment</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Top</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Text</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding EmployeeID, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">TextWrapping</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Wrap</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Height</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">30</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Style</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{DynamicResource TextBoxStyle}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">x:Name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">txtEmplyeeID</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">FontSize</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">14.667</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">PasswordBox</span> <span style=\"color:Red\">Margin</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">94.237,139.93,8,0</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">VerticalAlignment</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Top&quot; Password=&quot;</span><span style=\"color:Black\">&quot;</span> \r\n\t\t\t\t\t <span style=\"color:Red\">ui:PasswordBoxAssistant.BindPassword</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">true</span><span style=\"color:Black\">&quot;</span>  \r\n\t\t\t\t\t <span style=\"color:Red\">ui:PasswordBoxAssistant.BoundPassword</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding Password, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}</span><span style=\"color:Black\">&quot;</span>\r\n\t\t\t\t\t <span style=\"color:Red\">Height</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">30</span><span style=\"color:Black\">&quot;</span> \r\n\t\t\t\t\t <span style=\"color:Red\">Style</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{DynamicResource PasswordBoxStyle}</span><span style=\"color:Black\">&quot;</span> \r\n\t\t\t\t\t <span style=\"color:Red\">x:Name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">txtPassword</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">FontSize</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">14.667</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">Button</span> <span style=\"color:Red\">Margin</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">94.237,279.93,115.817,0</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">x:Name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">btnForgotPassword</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Command</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding ForgotPasswordCommand}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">ToolTip</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Forgotten Password</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">VerticalAlignment</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Top</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Content</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Forgotten Password</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">IsEnabled</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">True</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Height</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">28</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Style</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{DynamicResource SubButtonStyle}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">FontWeight</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Bold</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">FontSize</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">12</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">TextBlock</span> <span style=\"color:Red\">Margin</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">94.237,0,0,0</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">VerticalAlignment</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Bottom</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">FontSize</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">12</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Text</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">If you have a problem logging in, call IT Support on XXX-XXX-XXXX</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">TextWrapping</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Wrap</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Foreground</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{DynamicResource InfoBrush}</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">Button</span> <span style=\"color:Red\">HorizontalAlignment</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Left</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Margin</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">94.237,0,0,113.974</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Width</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">129.773</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Content</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Submit</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">x:Name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">btnSubmit</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Command</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding AuthenticateCommand}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">VerticalAlignment</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Bottom</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Height</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">40</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Style</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{DynamicResource ButtonStyle}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Foreground</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{DynamicResource ButtonTextBrush}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">FontWeight</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Bold</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">FontSize</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">16</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n    <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">Grid</span><span style=\"color:Blue\">&gt;</span>\r\n<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">UserControl</span><span style=\"color:Blue\">&gt;</span>\r\n\r\n</pre>\r\n<pre>Here is the StoryboardManager class:</pre>\r\n<pre><div style=\"color:Black;background-color:White\"><pre><span style=\"color:Blue\">using</span> System;\r\n<span style=\"color:Blue\">using</span> System.Collections.Generic;\r\n<span style=\"color:Blue\">using</span> System.Linq;\r\n<span style=\"color:Blue\">using</span> System.Text;\r\n<span style=\"color:Blue\">using</span> System.Windows.Input;\r\n<span style=\"color:Blue\">using</span> System.Windows;\r\n<span style=\"color:Blue\">using</span> System.Windows.Media.Animation;\r\n\r\n<span style=\"color:Blue\">namespace</span> BL.WDE.CVT.Dashboard.UI\r\n{\r\n\t<span style=\"color:Gray\">///</span> <span style=\"color:Gray\">&lt;summary&gt;</span>\r\n\t<span style=\"color:Gray\">///</span><span style=\"color:Green\"> Manages a collection of storyboards and allows a storyboard to play and execute a command upon completion.</span>\r\n\t<span style=\"color:Gray\">///</span> <span style=\"color:Gray\">&lt;/summary&gt;</span>\r\n\t<span style=\"color:Blue\">public</span> <span style=\"color:Blue\">static</span> <span style=\"color:Blue\">class</span><span style=\"color:MediumTurquoise\"> StoryboardManager\r\n\t</span>{\r\n\t\t<span style=\"color:Blue\">#region</span> VisibleState\r\n\t\t<span style=\"color:Blue\">public</span> <span style=\"color:Blue\">static</span> <span style=\"color:Blue\">readonly</span> DependencyProperty VisibleStateProperty = DependencyProperty.RegisterAttached(<span style=\"color:#A31515\">&quot;VisibleState&quot;</span>, <span style=\"color:Blue\">typeof</span>(VisibleState), <span style=\"color:Blue\">typeof</span>(StoryboardManager), <span style=\"color:Blue\">new</span> FrameworkPropertyMetadata(VisibleState.Collapse, FrameworkPropertyMetadataOptions.BindsTwoWayByDefault, OnVisibleStatePropertyChanged));\r\n\t\t<span style=\"color:Blue\">private</span> <span style=\"color:Blue\">static</span> <span style=\"color:Blue\">void</span> OnVisibleStatePropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)\r\n\t\t{\r\n\t\t\tFrameworkElement element = d <span style=\"color:Blue\">as</span> FrameworkElement;\r\n\t\t\t<span style=\"color:Blue\">if</span> (element == <span style=\"color:Blue\">null</span>) <span style=\"color:Blue\">return</span>;\r\n\t\t\t<span style=\"color:Blue\">string</span> oldStoryboardName = String.Concat(e.OldValue, <span style=\"color:#A31515\">&quot;Storyboard&quot;</span>);\r\n\t\t\t<span style=\"color:Blue\">string</span> newStoryboardName = String.Concat(e.NewValue, <span style=\"color:#A31515\">&quot;Storyboard&quot;</span>);\r\n\r\n\t\t\t<span style=\"color:Blue\"><strong>if</strong></span><strong> (element.Resources.Contains(oldStoryboardName))\r\n\t\t\t{\r\n\t\t\t\tStoryboard oldStoryboard = element.Resources[oldStoryboardName] </strong><span style=\"color:Blue\"><strong>as</strong></span><strong> Storyboard;\r\n\t\t\t\t</strong><span style=\"color:Blue\"><strong>if</strong></span><strong> (oldStoryboard != </strong><span style=\"color:Blue\"><strong>null</strong></span><strong>)\r\n\t\t\t\t\toldStoryboard.Remove(element);\r\n\t\t\t}</strong>\r\n\r\n\t\t\t<span style=\"color:Blue\">if</span> (element.Resources.Contains(newStoryboardName))\r\n\t\t\t{\r\n\t\t\t\tStoryboard newStoryboard = element.Resources[newStoryboardName] <span style=\"color:Blue\">as</span> Storyboard;\r\n\t\t\t\tEventHandler handler = <span style=\"color:Blue\">null</span>;\r\n\t\t\t\thandler = <span style=\"color:Blue\">delegate</span>\r\n\t\t\t\t{\r\n\t\t\t\t\tnewStoryboard.Completed -= handler;\r\n\r\n\t\t\t\t\t<span style=\"color:Blue\">var</span> command = element.GetValue(StoryboardManager.CommandProperty) <span style=\"color:Blue\">as</span> ICommand;\r\n\t\t\t\t\t<span style=\"color:Blue\">var</span> param = element.GetValue(StoryboardManager.CommandParameterProperty);\r\n\t\t\t\t\t<span style=\"color:Blue\">if</span> (command != <span style=\"color:Blue\">null</span>)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t<span style=\"color:Blue\">if</span> (command.CanExecute(param))\r\n\t\t\t\t\t\t\tcommand.Execute(param);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tnewStoryboard.Completed += handler;\r\n\t\t\t\tnewStoryboard.Begin(element, HandoffBehavior.Compose, <span style=\"color:Blue\">true</span>);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t<span style=\"color:Blue\">public</span> <span style=\"color:Blue\">static</span> VisibleState GetVisibleState(DependencyObject obj)\r\n\t\t{\r\n\t\t\t<span style=\"color:Blue\">return</span> (VisibleState)obj.GetValue(VisibleStateProperty);\r\n\t\t}\r\n\t\t<span style=\"color:Blue\">public</span> <span style=\"color:Blue\">static</span> <span style=\"color:Blue\">void</span> SetVisibleState(DependencyObject obj, VisibleState value)\r\n\t\t{\r\n\t\t\tobj.SetValue(VisibleStateProperty, value);\r\n\t\t}\r\n\t\t<span style=\"color:Blue\">#endregion</span>\r\n\r\n\t\t<span style=\"color:Blue\">#region</span> CommandParameter\r\n\r\n\t\t<span style=\"color:Gray\">///</span> <span style=\"color:Gray\">&lt;summary&gt;</span>\r\n\t\t<span style=\"color:Gray\">///</span><span style=\"color:Green\"> CommandParameter Attached Dependency Property</span>\r\n\t\t<span style=\"color:Gray\">///</span> <span style=\"color:Gray\">&lt;/summary&gt;</span>\r\n\t\t<span style=\"color:Blue\">public</span> <span style=\"color:Blue\">static</span> <span style=\"color:Blue\">readonly</span> DependencyProperty CommandParameterProperty =\r\n\t\t\tDependencyProperty.RegisterAttached(<span style=\"color:#A31515\">&quot;CommandParameter&quot;</span>, <span style=\"color:Blue\">typeof</span>(<span style=\"color:Blue\">object</span>), <span style=\"color:Blue\">typeof</span>(StoryboardManager),\r\n\t\t\t\t<span style=\"color:Blue\">new</span> FrameworkPropertyMetadata((<span style=\"color:Blue\">object</span>)<span style=\"color:Blue\">null</span>));\r\n\r\n\t\t<span style=\"color:Gray\">///</span> <span style=\"color:Gray\">&lt;summary&gt;</span>\r\n\t\t<span style=\"color:Gray\">///</span><span style=\"color:Green\"> Gets the CommandParameter property.</span>\r\n\t\t<span style=\"color:Gray\">///</span> <span style=\"color:Gray\">&lt;/summary&gt;</span>\r\n\t\t<span style=\"color:Blue\">public</span> <span style=\"color:Blue\">static</span> <span style=\"color:Blue\">object</span> GetCommandParameter(DependencyObject d)\r\n\t\t{\r\n\t\t\t<span style=\"color:Blue\">return</span> d.GetValue(CommandParameterProperty);\r\n\t\t}\r\n\r\n\t\t<span style=\"color:Gray\">///</span> <span style=\"color:Gray\">&lt;summary&gt;</span>\r\n\t\t<span style=\"color:Gray\">///</span><span style=\"color:Green\"> Sets the CommandParameter property.</span>\r\n\t\t<span style=\"color:Gray\">///</span> <span style=\"color:Gray\">&lt;/summary&gt;</span>\r\n\t\t<span style=\"color:Blue\">public</span> <span style=\"color:Blue\">static</span> <span style=\"color:Blue\">void</span> SetCommandParameter(DependencyObject d, <span style=\"color:Blue\">object</span> value)\r\n\t\t{\r\n\t\t\td.SetValue(CommandParameterProperty, value);\r\n\t\t}\r\n\r\n\t\t<span style=\"color:Blue\">#endregion</span>\r\n\r\n\t\t<span style=\"color:Blue\">#region</span> Command\r\n\r\n\t\t<span style=\"color:Gray\">///</span> <span style=\"color:Gray\">&lt;summary&gt;</span>\r\n\t\t<span style=\"color:Gray\">///</span><span style=\"color:Green\"> Command Attached Dependency Property</span>\r\n\t\t<span style=\"color:Gray\">///</span> <span style=\"color:Gray\">&lt;/summary&gt;</span>\r\n\t\t<span style=\"color:Blue\">public</span> <span style=\"color:Blue\">static</span> <span style=\"color:Blue\">readonly</span> DependencyProperty CommandProperty =\r\n\t\t\tDependencyProperty.RegisterAttached(<span style=\"color:#A31515\">&quot;Command&quot;</span>, <span style=\"color:Blue\">typeof</span>(ICommand), <span style=\"color:Blue\">typeof</span>(StoryboardManager),\r\n\t\t\t\t<span style=\"color:Blue\">new</span> FrameworkPropertyMetadata((ICommand)<span style=\"color:Blue\">null</span>));\r\n\r\n\t\t<span style=\"color:Gray\">///</span> <span style=\"color:Gray\">&lt;summary&gt;</span>\r\n\t\t<span style=\"color:Gray\">///</span><span style=\"color:Green\"> Gets the Command property.</span>\r\n\t\t<span style=\"color:Gray\">///</span> <span style=\"color:Gray\">&lt;/summary&gt;</span>\r\n\t\t<span style=\"color:Blue\">public</span> <span style=\"color:Blue\">static</span> ICommand GetCommand(DependencyObject d)\r\n\t\t{\r\n\t\t\t<span style=\"color:Blue\">return</span> (ICommand)d.GetValue(CommandProperty);\r\n\t\t}\r\n\r\n\t\t<span style=\"color:Gray\">///</span> <span style=\"color:Gray\">&lt;summary&gt;</span>\r\n\t\t<span style=\"color:Gray\">///</span><span style=\"color:Green\"> Sets the Command property.</span>\r\n\t\t<span style=\"color:Gray\">///</span> <span style=\"color:Gray\">&lt;/summary&gt;</span>\r\n\t\t<span style=\"color:Blue\">public</span> <span style=\"color:Blue\">static</span> <span style=\"color:Blue\">void</span> SetCommand(DependencyObject d, ICommand value)\r\n\t\t{\r\n\t\t\td.SetValue(CommandProperty, value);\r\n\t\t}\r\n\r\n\t\t<span style=\"color:Blue\">#endregion</span>\r\n\r\n\t}\r\n}\r\n\r\n</pre>\r\n</div>\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-08-07T11:38:54.473-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]