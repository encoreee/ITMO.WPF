[
  {
    "Id": "163714",
    "ThreadId": "49008",
    "Html": "Hello!<br>\r\nI am facing some problems with the VisualStateManager and I have some questions.<br>\r\nI defined some VisualStates for a TabControl (We are not using Triggers because we want to transfer it to Silverlight in the future)<br>\r\nI change the states in the code behind. This works fine when a user selects a TabItem. The state changes correctly. But when the application is loaded the first TabItem is selected by default but the state is not correct. Although it goes into the function and changes the state correctly to Selected.<br>\r\n<br>\r\nHere is my ControlTemplate:<br>\r\n<span style=\"font-size:10px\">&lt;</span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#a31515\">ControlTemplate</span><span style=\"font-size:11px;color:#ff0000\"> x</span><span style=\"font-size:11px;color:#0000ff\">:</span><span style=\"font-size:11px;color:#ff0000\">Key</span><span style=\"font-size:11px;color:#0000ff\">=&quot;TabItemControlTemplate&quot;</span><span style=\"font-size:11px;color:#ff0000\"> TargetType</span><span style=\"font-size:11px;color:#0000ff\">=&quot;{</span><span style=\"font-size:11px;color:#a31515\">x</span><span style=\"font-size:11px;color:#0000ff\">:</span><span style=\"font-size:11px;color:#a31515\">Type</span><span style=\"font-size:11px;color:#ff0000\"> TabItem</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">}&quot;&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">    &lt;</span><span style=\"font-size:11px;color:#a31515\">Grid</span><span style=\"font-size:11px;color:#ff0000\"> Width</span><span style=\"font-size:11px;color:#0000ff\">=&quot;Auto&quot;</span><span style=\"font-size:11px;color:#ff0000\"> MinHeight</span><span style=\"font-size:11px;color:#0000ff\">=&quot;25&quot;</span><span style=\"font-size:11px;color:#ff0000\"> x</span><span style=\"font-size:11px;color:#0000ff\">:</span><span style=\"font-size:11px;color:#ff0000\">Name</span><span style=\"font-size:11px;color:#0000ff\">=&quot;TabItemRoot&quot;</span><span style=\"font-size:11px;color:#ff0000\"> Margin</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;0&quot;&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">        &lt;</span><span style=\"font-size:11px;color:#a31515\">Grid.ColumnDefinitions</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">            &lt;</span><span style=\"font-size:11px;color:#a31515\">ColumnDefinition</span><span style=\"font-size:11px;color:#ff0000\"> Width</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;0.9*&quot;/&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">            &lt;</span><span style=\"font-size:11px;color:#a31515\">ColumnDefinition</span><span style=\"font-size:11px;color:#ff0000\"> Width</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;0.1*&quot;/&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">        &lt;/</span><span style=\"font-size:11px;color:#a31515\">Grid.ColumnDefinitions</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">        &lt;</span><span style=\"font-size:11px;color:#a31515\">VisualStateManager.VisualStateGroups</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">            &lt;</span><span style=\"font-size:11px;color:#a31515\">VisualStateGroup</span><span style=\"font-size:11px;color:#ff0000\"> x</span><span style=\"font-size:11px;color:#0000ff\">:</span><span style=\"font-size:11px;color:#ff0000\">Name</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;CommonStates&quot;&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                &lt;</span><span style=\"font-size:11px;color:#a31515\">VisualStateGroup.Transitions</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                    &lt;</span><span style=\"font-size:11px;color:#a31515\">VisualTransition</span><span style=\"font-size:11px;color:#ff0000\"> GeneratedDuration</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;00:00:00&quot;/&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                &lt;/</span><span style=\"font-size:11px;color:#a31515\">VisualStateGroup.Transitions</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                &lt;</span><span style=\"font-size:11px;color:#a31515\">VisualState</span><span style=\"font-size:11px;color:#ff0000\"> x</span><span style=\"font-size:11px;color:#0000ff\">:</span><span style=\"font-size:11px;color:#ff0000\">Name</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;Disabled&quot;/&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                &lt;</span><span style=\"font-size:11px;color:#a31515\">VisualState</span><span style=\"font-size:11px;color:#ff0000\"> x</span><span style=\"font-size:11px;color:#0000ff\">:</span><span style=\"font-size:11px;color:#ff0000\">Name</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;Normal&quot;/&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                &lt;</span><span style=\"font-size:11px;color:#a31515\">VisualState</span><span style=\"font-size:11px;color:#ff0000\"> x</span><span style=\"font-size:11px;color:#0000ff\">:</span><span style=\"font-size:11px;color:#ff0000\">Name</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;MouseOver&quot; /&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">            &lt;/</span><span style=\"font-size:11px;color:#a31515\">VisualStateGroup</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">            &lt;</span><span style=\"font-size:11px;color:#a31515\">VisualStateGroup</span><span style=\"font-size:11px;color:#ff0000\"> x</span><span style=\"font-size:11px;color:#0000ff\">:</span><span style=\"font-size:11px;color:#ff0000\">Name</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;FocusStates&quot;&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                &lt;</span><span style=\"font-size:11px;color:#a31515\">VisualState</span><span style=\"font-size:11px;color:#ff0000\"> x</span><span style=\"font-size:11px;color:#0000ff\">:</span><span style=\"font-size:11px;color:#ff0000\">Name</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;Focused&quot; /&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                &lt;</span><span style=\"font-size:11px;color:#a31515\">VisualState</span><span style=\"font-size:11px;color:#ff0000\"> x</span><span style=\"font-size:11px;color:#0000ff\">:</span><span style=\"font-size:11px;color:#ff0000\">Name</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;Unfocused&quot; /&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">            &lt;/</span><span style=\"font-size:11px;color:#a31515\">VisualStateGroup</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">            &lt;</span><span style=\"font-size:11px;color:#a31515\">VisualStateGroup</span><span style=\"font-size:11px;color:#ff0000\"> x</span><span style=\"font-size:11px;color:#0000ff\">:</span><span style=\"font-size:11px;color:#ff0000\">Name</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;SelectionStates&quot;&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                &lt;</span><span style=\"font-size:11px;color:#a31515\">VisualStateGroup.Transitions</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                    &lt;</span><span style=\"font-size:11px;color:#a31515\">VisualTransition</span><span style=\"font-size:11px;color:#ff0000\"> GeneratedDuration</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;00:00:00&quot;/&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                &lt;/</span><span style=\"font-size:11px;color:#a31515\">VisualStateGroup.Transitions</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                &lt;</span><span style=\"font-size:11px;color:#a31515\">VisualState</span><span style=\"font-size:11px;color:#ff0000\"> x</span><span style=\"font-size:11px;color:#0000ff\">:</span><span style=\"font-size:11px;color:#ff0000\">Name</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;Selected&quot; &gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                   &lt;</span><span style=\"font-size:11px;color:#a31515\">Storyboard</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                        &lt;</span><span style=\"font-size:11px;color:#a31515\">ColorAnimation</span><span style=\"font-size:11px;color:#ff0000\"> To</span><span style=\"font-size:11px;color:#0000ff\">=&quot;#C5C5C5&quot;</span><span style=\"font-size:11px;color:#ff0000\"> Duration</span><span style=\"font-size:11px;color:#0000ff\">=&quot;0&quot; </span><span style=\"font-size:11px;color:#ff0000\"><br>\r\n                                    Storyboard.TargetName</span><span style=\"font-size:11px;color:#0000ff\">=&quot;backRectangle&quot;</span><span style=\"font-size:11px;color:#ff0000\">             <br>\r\n                                     Storyboard.TargetProperty</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;(Shape.Fill).(GradientBrush.GradientStops)[0].<br>\r\n                                            (GradientStop.Color)&quot;/&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                        &lt;</span><span style=\"font-size:11px;color:#a31515\">ColorAnimation</span><span style=\"font-size:11px;color:#ff0000\"> To</span><span style=\"font-size:11px;color:#0000ff\">=&quot;#B7B6B6&quot;</span><span style=\"font-size:11px;color:#ff0000\"> Duration</span><span style=\"font-size:11px;color:#0000ff\">=&quot;0&quot;</span><span style=\"font-size:11px;color:#ff0000\"> Storyboard.TargetName</span><span style=\"font-size:11px;color:#0000ff\">=&quot;backRectangle&quot;</span><span style=\"font-size:11px;color:#ff0000\">         <br>\r\n                                        Storyboard.TargetProperty</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;(Shape.Fill).(GradientBrush.GradientStops)[1].            <br>\r\n                                            (GradientStop.Color)&quot;/&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                        &lt;</span><span style=\"font-size:11px;color:#a31515\">ColorAnimation</span><span style=\"font-size:11px;color:#ff0000\"> To</span><span style=\"font-size:11px;color:#0000ff\">=&quot;#A8A8A9&quot;</span><span style=\"font-size:11px;color:#ff0000\"> Duration</span><span style=\"font-size:11px;color:#0000ff\">=&quot;0&quot;</span><span style=\"font-size:11px;color:#ff0000\"> Storyboard.TargetName</span><span style=\"font-size:11px;color:#0000ff\">=&quot;backRectangle&quot;</span><span style=\"font-size:11px;color:#ff0000\"> <br>\r\n                                        Storyboard.TargetProperty</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;(Shape.Fill).(GradientBrush.GradientStops)[2].    <br>\r\n                                            (GradientStop.Color)&quot;/&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                    &lt;/</span><span style=\"font-size:11px;color:#a31515\">Storyboard</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                &lt;/</span><span style=\"font-size:11px;color:#a31515\">VisualState</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                &lt;</span><span style=\"font-size:11px;color:#a31515\">VisualState</span><span style=\"font-size:11px;color:#ff0000\"> x</span><span style=\"font-size:11px;color:#0000ff\">:</span><span style=\"font-size:11px;color:#ff0000\">Name</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;Unselected&quot; &gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                    &lt;</span><span style=\"font-size:11px;color:#a31515\">Storyboard</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                        &lt;</span><span style=\"font-size:11px;color:#a31515\">ColorAnimation</span><span style=\"font-size:11px;color:#ff0000\"> To</span><span style=\"font-size:11px;color:#0000ff\">=&quot;#FCFBFB&quot;</span><span style=\"font-size:11px;color:#ff0000\"> Duration</span><span style=\"font-size:11px;color:#0000ff\">=&quot;0&quot;</span><span style=\"font-size:11px;color:#ff0000\"> Storyboard.TargetName</span><span style=\"font-size:11px;color:#0000ff\">=&quot;backRectangle&quot;</span><span style=\"font-size:11px;color:#ff0000\"> <br>\r\n                                    Storyboard.TargetProperty</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;(Shape.Fill).(GradientBrush.GradientStops)[0].        <br>\r\n                                        (GradientStop.Color)&quot;/&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                           &lt;</span><span style=\"font-size:11px;color:#a31515\">ColorAnimation</span><span style=\"font-size:11px;color:#ff0000\"> To</span><span style=\"font-size:11px;color:#0000ff\">=&quot;#D3D3D3&quot;</span><span style=\"font-size:11px;color:#ff0000\"> Duration</span><span style=\"font-size:11px;color:#0000ff\">=&quot;0&quot;</span><span style=\"font-size:11px;color:#ff0000\"> Storyboard.TargetName</span><span style=\"font-size:11px;color:#0000ff\">=&quot;backRectangle&quot;</span><span style=\"font-size:11px;color:#ff0000\"> <br>\r\n                                    Storyboard.TargetProperty</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;(Shape.Fill).(GradientBrush.GradientStops)[1].<br>\r\n                                        (GradientStop.Color)&quot;/&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                            &lt;</span><span style=\"font-size:11px;color:#a31515\">ColorAnimation</span><span style=\"font-size:11px;color:#ff0000\"> To</span><span style=\"font-size:11px;color:#0000ff\">=&quot;#FDFDFD&quot;</span><span style=\"font-size:11px;color:#ff0000\"> Duration</span><span style=\"font-size:11px;color:#0000ff\">=&quot;0&quot;</span><span style=\"font-size:11px;color:#ff0000\"> Storyboard.TargetName</span><span style=\"font-size:11px;color:#0000ff\">=&quot;backRectangle&quot;</span><span style=\"font-size:11px;color:#ff0000\"> <br>\r\n                                        Storyboard.TargetProperty</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;(Shape.Fill).(GradientBrush.GradientStops)[2].<br>\r\n                                            (GradientStop.Color)&quot;/&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                    &lt;/</span><span style=\"font-size:11px;color:#a31515\">Storyboard</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;   <br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                &lt;/</span><span style=\"font-size:11px;color:#a31515\">VisualState</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">            &lt;/</span><span style=\"font-size:11px;color:#a31515\">VisualStateGroup</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">        &lt;/</span><span style=\"font-size:11px;color:#a31515\">VisualStateManager.VisualStateGroups</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;    <br>\r\n<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">    &lt;</span><span style=\"font-size:11px;color:#a31515\">Rectangle</span><span style=\"font-size:11px;color:#ff0000\"> x</span><span style=\"font-size:11px;color:#0000ff\">:</span><span style=\"font-size:11px;color:#ff0000\">Name</span><span style=\"font-size:11px;color:#0000ff\">=&quot;backRectangle&quot;</span><span style=\"font-size:11px;color:#ff0000\"> Height</span><span style=\"font-size:11px;color:#0000ff\">=&quot;Auto&quot;</span><span style=\"font-size:11px;color:#ff0000\"> Grid.Column</span><span style=\"font-size:11px;color:#0000ff\">=&quot;0&quot; </span><span style=\"font-size:11px\"></span><span style=\"font-size:11px;color:#ff0000\">Grid.ColumnSpan</span><span style=\"font-size:11px;color:#0000ff\">=&quot;2&quot; </span><span style=\"font-size:11px;color:#ff0000\">Stroke</span><span style=\"font-size:11px;color:#0000ff\">=&quot;Black&quot;</span><span style=\"font-size:11px;color:#ff0000\"> <br>\r\n                    StrokeThickness</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;0&quot;&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">        &lt;</span><span style=\"font-size:11px;color:#a31515\">Rectangle.Fill</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">            &lt;</span><span style=\"font-size:11px;color:#a31515\">LinearGradientBrush</span><span style=\"font-size:11px;color:#ff0000\"> EndPoint</span><span style=\"font-size:11px;color:#0000ff\">=&quot;0.5,1&quot;</span><span style=\"font-size:11px;color:#ff0000\"> StartPoint</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;0.5,0&quot;&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                &lt;</span><span style=\"font-size:11px;color:#a31515\">GradientStop</span><span style=\"font-size:11px;color:#ff0000\"> Color</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;#FFFCFBFB&quot;/&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                &lt;</span><span style=\"font-size:11px;color:#a31515\">GradientStop</span><span style=\"font-size:11px;color:#ff0000\"> Color</span><span style=\"font-size:11px;color:#0000ff\">=&quot;#FFD3D3D3&quot;</span><span style=\"font-size:11px;color:#ff0000\"> Offset</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;1&quot;/&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">                &lt;</span><span style=\"font-size:11px;color:#a31515\">GradientStop</span><span style=\"font-size:11px;color:#ff0000\"> Color</span><span style=\"font-size:11px;color:#0000ff\">=&quot;#FFFDFDFD&quot;</span><span style=\"font-size:11px;color:#ff0000\"> Offset</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;0.5&quot;/&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">            &lt;/</span><span style=\"font-size:11px;color:#a31515\">LinearGradientBrush</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">        &lt;/</span><span style=\"font-size:11px;color:#a31515\">Rectangle.Fill</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">    &lt;/</span><span style=\"font-size:11px;color:#a31515\">Rectangle</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">    &lt;</span><span style=\"font-size:11px;color:#a31515\">ContentPresenter</span><span style=\"font-size:11px;color:#ff0000\"> Margin</span><span style=\"font-size:11px;color:#0000ff\">=&quot;13,5,13,5&quot;</span><span style=\"font-size:11px;color:#ff0000\"> x</span><span style=\"font-size:11px;color:#0000ff\">:</span><span style=\"font-size:11px;color:#ff0000\">Name</span><span style=\"font-size:11px;color:#0000ff\">=&quot;Content&quot;</span><span style=\"font-size:11px;color:#ff0000\"> ContentSource</span><span style=\"font-size:11px;color:#0000ff\">=&quot;Header&quot;</span><span style=\"font-size:11px;color:#080808\"> </span><span style=\"font-size:11px;color:#ff0000\"><br>\r\n                    RecognizesAccessKey</span><span style=\"font-size:11px;color:#0000ff\">=&quot;True&quot;</span><span style=\"font-size:11px;color:#ff0000\"> Grid.Column</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;0&quot; /&gt;<br>\r\n    <br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">    &lt;</span><span style=\"font-size:11px;color:#a31515\">Border</span><span style=\"font-size:11px;color:#ff0000\"> x</span><span style=\"font-size:11px;color:#0000ff\">:</span><span style=\"font-size:11px;color:#ff0000\">Name</span><span style=\"font-size:11px;color:#0000ff\">=&quot;border&quot;</span><span style=\"font-size:11px;color:#080808\"> </span><span style=\"font-size:11px;color:#ff0000\">Opacity</span><span style=\"font-size:11px;color:#0000ff\">=&quot;1&quot;</span><span style=\"font-size:11px;color:#ff0000\"> Background</span><span style=\"font-size:11px;color:#0000ff\">=&quot;Transparent&quot;</span><span style=\"font-size:11px;color:#ff0000\"> BorderBrush</span><span style=\"font-size:11px;color:#0000ff\">=&quot;#808180&quot;</span><span style=\"font-size:11px;color:#080808\"> </span><span style=\"font-size:11px;color:#ff0000\"><br>\r\n                BorderThickness</span><span style=\"font-size:11px;color:#0000ff\">=&quot;1,1,1,0&quot;</span><span style=\"font-size:11px;color:#ff0000\"> Grid.Column</span><span style=\"font-size:11px;color:#0000ff\">=&quot;0&quot;</span><span style=\"font-size:11px;color:#080808\"> </span><span style=\"font-size:11px;color:#ff0000\">Grid.ColumnSpan</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">=&quot;2&quot;/&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">&lt;/</span><span style=\"font-size:11px;color:#a31515\">Grid</span></span><span style=\"font-size:11px\"><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:11px;color:#0000ff\">&lt;/</span><span style=\"font-size:11px;color:#a31515\">ControlTemplate</span></span><span style=\"font-size:11px;color:#0000ff\">&gt;<br>\r\n<br>\r\nIn the code behind I am doing this:<br>\r\n<span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">\r\n<p>private</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">void</span><span style=\"font-size:13px\"> MainTabs_SelectionChanged(</span><span style=\"font-size:13px;color:#0000ff\">object</span><span style=\"font-size:13px\"> sender, </span><span style=\"font-size:13px;color:#2b91af\">SelectionChangedEventArgs</span><span style=\"font-size:13px\"> e)<br>\r\n{<br>\r\n</span><span style=\"font-size:13px;color:#2b91af\">    TabControl</span><span style=\"font-size:13px\"> control = (</span><span style=\"font-size:13px;color:#2b91af\">TabControl</span><span style=\"font-size:13px\">)sender;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">    int</span><span style=\"font-size:13px\"> index = control.SelectedIndex;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">    if</span><span style=\"font-size:13px\"> (index != -1)<br>\r\n    {<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">        int</span><span style=\"font-size:13px\"> i = 0;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">        foreach</span><span style=\"font-size:13px\"> (</span><span style=\"font-size:13px;color:#2b91af\">TabItem</span><span style=\"font-size:13px\"> item </span><span style=\"font-size:13px;color:#0000ff\">in</span><span style=\"font-size:13px\"> control.Items)<br>\r\n        {<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">            if</span><span style=\"font-size:13px\"> (i == index)<br>\r\n</span><span style=\"font-size:13px;color:#2b91af\">                VisualStateManager</span><span style=\"font-size:13px\">.GoToState(item, </span><span style=\"font-size:13px;color:#a31515\">&quot;Selected&quot;</span><span style=\"font-size:13px\">, </span><span style=\"font-size:13px;color:#0000ff\">false</span><span style=\"font-size:13px\">);<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">            else<br>\r\n</span><span style=\"font-size:13px;color:#2b91af\">                VisualStateManager</span><span style=\"font-size:13px\">.GoToState(item, </span><span style=\"font-size:13px;color:#a31515\">&quot;Unselected&quot;</span><span style=\"font-size:13px\">, </span><span style=\"font-size:13px;color:#0000ff\">true</span><span style=\"font-size:13px\">);<br>\r\n            i++;<br>\r\n        }<br>\r\n    }<br>\r\n}<br>\r\n<br>\r\nHow can I set the first TabItem to Selected when it is not selected by a user?<br>\r\nThanks in advance!\r\n<p>&nbsp;</p>\r\n</span></p>\r\n</span>\r\n",
    "PostedDate": "2009-03-02T23:38:27.21-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "163840",
    "ThreadId": "49008",
    "Html": "<p>Your selectionchanged method is being called on startup but GoToState is returning false b/c the template of TabItem is not yet built.  Here is an alternative implementation that does work for startup.<br>\r\n<br>\r\n<span style=\"font-size:13px;color:#0000ff\">public</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">class</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">CustomTabItem</span><span style=\"font-size:13px\"> : </span><span style=\"font-size:13px;color:#2b91af\">TabItem<br>\r\n</span><span style=\"font-size:13px\">{<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">    public</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">override</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">void</span><span style=\"font-size:13px\"> OnApplyTemplate()<br>\r\n    {<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">        base</span><span style=\"font-size:13px\">.OnApplyTemplate();<br>\r\n</span><span style=\"font-size:13px;color:#008000\"><br>\r\n        // this will handle the case for applying VSM on startup<br>\r\n</span><span style=\"font-size:13px\">        UpdateState(</span><span style=\"font-size:13px;color:#0000ff\">false</span><span style=\"font-size:13px\">);<br>\r\n    }<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\"><br>\r\n    protected</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">override</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">void</span><span style=\"font-size:13px\"> OnPropertyChanged(</span><span style=\"font-size:13px;color:#2b91af\">DependencyPropertyChangedEventArgs</span><span style=\"font-size:13px\"> e)<br>\r\n    {<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">        base</span><span style=\"font-size:13px\">.OnPropertyChanged(e);<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">        if</span><span style=\"font-size:13px\"> (e.Property == </span><span style=\"font-size:13px;color:#2b91af\">TabItem</span><span style=\"font-size:13px\">.IsSelectedProperty)<br>\r\n        {<br>\r\n</span><span style=\"font-size:13px;color:#008000\">            // here is the normal case when selection changes<br>\r\n</span><span style=\"font-size:13px\">             UpdateState(</span><span style=\"font-size:13px;color:#0000ff\">true</span><span style=\"font-size:13px\">);<br>\r\n        }<br>\r\n    }\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">    private</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">void</span><span style=\"font-size:13px\"> UpdateState(</span><span style=\"font-size:13px;color:#0000ff\">bool</span><span style=\"font-size:13px\"> useTransitions)<br>\r\n    {<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">        if</span><span style=\"font-size:13px\"> (IsSelected)<br>\r\n        {<br>\r\n</span><span style=\"font-size:13px;color:#2b91af\">            VisualStateManager</span><span style=\"font-size:13px\">.GoToState(</span><span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">, </span><span style=\"font-size:13px;color:#a31515\">&quot;Selected&quot;</span><span style=\"font-size:13px\">, useTransitions);<br>\r\n        }<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">        else</span><span style=\"font-size:13px\"> <br>\r\n        {<br>\r\n</span><span style=\"font-size:13px;color:#2b91af\">            VisualStateManager</span><span style=\"font-size:13px\">.GoToState(</span><span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">, </span><span style=\"font-size:13px;color:#a31515\">&quot;Unselected&quot;</span><span style=\"font-size:13px\">, useTransitions);<br>\r\n        }<br>\r\n    }<br>\r\n}\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p> <br>\r\nThen replace your ControlTemplate.TargetType to this CustomTabItem as well as the TabItems in the TabControl.  Hope this helps.<br>\r\n</p>\r\n",
    "PostedDate": "2009-03-03T05:55:56.757-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "163845",
    "ThreadId": "49008",
    "Html": "This works fine! Thank you.<br>\r\nNow I understand how this all works together with these custom classes. On your blog I found a similar implementation for the DataGrid. That's what I will need next. Thanks.\r\n",
    "PostedDate": "2009-03-03T06:11:37.657-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]