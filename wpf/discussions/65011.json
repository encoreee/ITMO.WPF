[
  {
    "Id": "221411",
    "ThreadId": "65011",
    "Html": "<pre>Hi experts,</pre>\r\n<pre>&nbsp;</pre>\r\n<pre>I hit the problem when I want to add ContextMenu for the RowHeader when I use the resource from ResourceDictionary. What's wrong with my code? </pre>\r\n<pre>I found when I remove the Click event handler, it's fine. But the context menu will do nothing.</pre>\r\n<pre>So is there any way to make it work or how can I get the ContextMenu of RowHeader by code then I will add event handler manually?</pre>\r\n<pre>&nbsp;</pre>\r\n<pre>l:BaseDataGrid is derived from DataGrid.</pre>\r\n<pre>Thanks very much</pre>\r\n<pre><span style=\"font-size:x-small;color:#a31515\"><span style=\"font-size:x-small;color:#a31515\"><div style=\"color:Black;background-color:White\"><pre>        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">l</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">BaseDataGrid.Resources</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">ResourceDictionary</span><span style=\"color:Blue\">&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">ResourceDictionary.MergedDictionaries</span><span style=\"color:Blue\">&gt;</span>\r\n                    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">ResourceDictionary</span> <span style=\"color:Red\">Source</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">../Resources/PointCloudUIStyle.xaml</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n                <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">ResourceDictionary.MergedDictionaries</span><span style=\"color:Blue\">&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">ContextMenu</span> <span style=\"color:Red\">x:Key</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">RowHeaderContextMenu</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Blue\">&gt;</span>\r\n                    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">MenuItem</span> <span style=\"color:Red\">x:Uid</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">PC_001</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Header</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Move Up</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">IsCheckable</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">False</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Click</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">MoveUp_MenuItem_Click</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n                    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">MenuItem</span> <span style=\"color:Red\">x:Uid</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">PC_002</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Header</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Move Down</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">IsCheckable</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">False</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Click</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">MoveDown_MenuItem_Click</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n                    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">Separator</span><span style=\"color:Blue\">/&gt;</span>\r\n                    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">MenuItem</span> <span style=\"color:Red\">x:Uid</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">PC_003</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">x:Name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Reomve_from_Group_MenuItem</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Header</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Remove from Group</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Click</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">btnRemoveFromGroup_Click</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">IsEnabled</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding Path=IsFileInGroup}</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n                    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">MenuItem</span> <span style=\"color:Red\">x:Uid</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">PC_004</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">x:Name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Reomve_File_MenuItem</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Header</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Remove File</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Click</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">btnRemoveFile_Click</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n                <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">ContextMenu</span><span style=\"color:Blue\">&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">Style</span> <span style=\"color:Red\">x:Key</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">ControlRowHeaders</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">TargetType</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{x:Type dg:DataGridRowHeader}</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n                    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">Setter</span> <span style=\"color:Red\">Property</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Content</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding Path=RowHeaderImage}</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n                    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">Setter</span> <span style=\"color:Red\">Property</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Template</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{DynamicResource PCRowHeaderControlTemplate}</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n                    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">Setter</span> <span style=\"color:Red\">Property</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">ContextMenu</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{StaticResource RowHeaderContextMenu}</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n                <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">Style</span><span style=\"color:Blue\">&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">Style</span> <span style=\"color:Red\">TargetType</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{x:Type dg:DataGridRowHeader}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">BasedOn</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{StaticResource ControlRowHeaders}</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n            <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">ResourceDictionary</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">l</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">BaseDataGrid.Resources</span><span style=\"color:Blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n</span></span></pre>\r\n<pre>&nbsp;         \r\nThe statck trace is really strange:</pre>\r\n<p>at System.Windows.Markup.BamlRecordReader.ReadRecord(BamlRecord bamlRecord)<br><br>&nbsp;&nbsp; at System.Windows.Markup.BamlRecordReader.ReadElement(Int64 startPosition, XamlObjectIds contextXamlObjectIds, Object dictionaryKey)<br><br>&nbsp;&nbsp; at System.Windows.ResourceDictionary.CreateObject(Int32 valuePosition, Object key)<br><br>&nbsp;&nbsp; at System.Windows.ResourceDictionary.RealizeDeferContent(Object key, Object&amp; value, Boolean&amp; canCache)<br><br>&nbsp;&nbsp; at System.Windows.ResourceDictionary.GetValueWithoutLock(Object key, Boolean&amp; canCache)<br><br>&nbsp;&nbsp; at System.Windows.ResourceDictionary.GetValue(Object key, Boolean&amp; canCache)<br><br>&nbsp;&nbsp; at System.Windows.DeferredResourceReference.GetValue(BaseValueSourceInternal valueSource)<br><br>&nbsp;&nbsp; at System.Windows.DependencyObject.GetEffectiveValue(EntryIndex entryIndex, DependencyProperty dp, RequestFlags requests)<br><br>&nbsp;&nbsp; at System.Windows.DependencyObject.GetValueEntry(EntryIndex entryIndex, DependencyProperty dp, PropertyMetadata metadata, RequestFlags requests)<br><br>&nbsp;&nbsp; at System.Windows.DependencyObject.GetValue(DependencyProperty dp)<br><br>&nbsp;&nbsp; at System.Windows.Controls.ContextMenuService.GetContextMenu(DependencyObject element)<br><br>&nbsp;&nbsp; at System.Windows.Controls.ContextMenuService.ContextMenuIsEnabled(DependencyObject o)<br><br>&nbsp;&nbsp; at System.Windows.Controls.ContextMenuService.OnContextMenuOpening(Object sender, ContextMenuEventArgs e)<br><br>&nbsp;&nbsp; at System.Windows.Controls.ContextMenuEventArgs.InvokeEventHandler(Delegate genericHandler, Object genericTarget)<br><br>&nbsp;&nbsp; at System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object target)<br><br>&nbsp;&nbsp; at System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs)<br><br>&nbsp;&nbsp; at System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)<br><br>&nbsp;&nbsp; at System.Windows.UIElement.RaiseEventImpl(DependencyObject sender, RoutedEventArgs args)<br><br>&nbsp;&nbsp; at System.Windows.UIElement.RaiseEvent(RoutedEventArgs args, Boolean trusted)<br><br>&nbsp;&nbsp; at System.Windows.Controls.PopupControlService.RaiseContextMenuOpeningEvent(IInputElement source, Double x, Double y, Boolean userInitiated)<br><br>&nbsp;&nbsp; at System.Windows.Controls.PopupControlService.ProcessMouseUp(Object sender, MouseButtonEventArgs e)<br><br>&nbsp;&nbsp; at System.Windows.Controls.PopupControlService.OnPostProcessInput(Object sender, ProcessInputEventArgs e)<br><br>&nbsp;&nbsp; at System.Windows.Input.InputManager.ProcessStagingArea()<br><br>&nbsp;&nbsp; at System.Windows.Input.InputManager.ProcessInput(InputEventArgs input)<br><br>&nbsp;&nbsp; at System.Windows.Input.InputProviderSite.ReportInput(InputReport inputReport)<br><br>&nbsp;&nbsp; at System.Windows.Interop.HwndMouseInputProvider.ReportInput(IntPtr hwnd, InputMode mode, Int32 timestamp, RawMouseActions actions, Int32 x, Int32 y, Int32 wheel)<br><br>&nbsp;&nbsp; at System.Windows.Interop.HwndMouseInputProvider.FilterMessage(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)<br><br>&nbsp;&nbsp; at System.Windows.Interop.HwndSource.InputFilterMessage(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)<br><br>&nbsp;&nbsp; at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)<br><br>&nbsp;&nbsp; at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)<br><br>&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)<br><br>&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br><br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br><br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Boolean isSingleParameter)<br><br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.Invoke(DispatcherPriority priority, Delegate method, Object arg)<br><br>&nbsp;&nbsp; at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)<br><br>&nbsp;&nbsp; at System.Windows.Forms.UnsafeNativeMethods.CallWindowProc(IntPtr wndProc, IntPtr hWnd, Int32 msg, IntPtr wParam, IntPtr lParam)<br><br>&nbsp;&nbsp; at System.Windows.Forms.NativeWindow.DefWndProc(Message&amp; m)<br><br>&nbsp;&nbsp; at System.Windows.Forms.NativeWindow.WndProc(Message&amp; m)<br><br>&nbsp;&nbsp; at System.Windows.Forms.Integration.WindowsFormsHost.ActivateWindowListener.WndProc(Message&amp; m)<br><br>&nbsp;&nbsp; at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>",
    "PostedDate": "2009-08-09T23:53:05.58-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "221808",
    "ThreadId": "65011",
    "Html": "<p>Oh, I solved it by remove the</p>\r\n<p><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Style</span> <span style=\"color:red\">TargetType</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">{x:Type dg:DataGridRowHeader}</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">BasedOn</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">{StaticResource ControlRowHeaders}</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span></p>\r\n<p><span style=\"color:blue\">And remove <span style=\"color:red\">x:Key</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">ControlRowHeaders</span><span style=\"color:black\">&quot; from the code below:</span></span></p>\r\n<p><span style=\"color:blue\"><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">Style</span> <span style=\"color:red\">x:Key</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">ControlRowHeaders</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">TargetType</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">{x:Type dg:DataGridRowHeader}</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span><br></span></p>\r\n<p><span style=\"color:blue\">Thanks still</span>\r\n<p><span style=\"color:blue\">&nbsp;</span></p>\r\n</p>",
    "PostedDate": "2009-08-10T18:27:53.067-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]