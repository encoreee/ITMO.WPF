[
  {
    "Id": "232019",
    "ThreadId": "68218",
    "Html": "<p>Can someone please tell me how to successfully add and delete rows manunally in C#?</p>\r\n<p>I am using the WPF Datagrid, and LINQ to SQL.&nbsp; When I endable CanUserAddRows and CanUserDeleteRows it works ok (most of the time, although sometimes I get Null references because I have a composite key but that is another topic).</p>\r\n<p>But I cannot get it to delete manually.&nbsp; Is there a way to call the same internal commands that the datagrid uses to add and remove entities?</p>\r\n<p>&nbsp;</p>\r\n<p>I am trying something like the following..</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">private</span> <span style=\"color:Blue\">void</span> AddCommand_Executed(<span style=\"color:Blue\">object</span> sender, ExecutedRoutedEventArgs e)\r\n        {\r\n            item item = <span style=\"color:Blue\">new</span> item();\r\n            item.SetDefaults(invoice, db);\r\n\r\n            invoice.items.Add(item);\r\n\r\n            DataGrid.ItemsSource = invoice.items.GetNewBindingList();\r\n\r\n        }\r\n\r\n\r\n<span style=\"color:Blue\">private</span> <span style=\"color:Blue\">void</span> DeleteCommand_Executed(<span style=\"color:Blue\">object</span> sender, ExecutedRoutedEventArgs e)\r\n        {\r\n            item item = DataGrid.SelectedItem <span style=\"color:Blue\">as</span> item;\r\n\r\n            <span style=\"color:Blue\">if</span> (item!= <span style=\"color:Blue\">null</span>)\r\n            {\r\n                invoice.items.Remove(item);\r\n\r\n                 <span style=\"color:Blue\">if</span> (item.citemid != 0)\r\n                    db.items.DeleteOnSubmit(item);\r\n                <span style=\"color:Blue\">else</span>\r\n                     item.Detach();\r\n\r\n                DataGrid.ItemsSource = reptran.repitems.GetNewBindingList();\r\n            }\r\n\r\n        }\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>Detach, is a method which sets all entity references to null.&nbsp; Without this method the item still has references to other entities such as&nbsp;TAX rate.</p>\r\n<p>The problem that I am getting is that despite setting all references to null, SaveChanges works when the entity exists, but if I add an item, and remove it before saving SaveChanges() still tries to insert it in the database.&nbsp;&nbsp; this fails because of my composite key, but I also dont want it because it would be an orphaned record in the database.</p>\r\n<p>What is wrong here?</p>",
    "PostedDate": "2009-09-07T19:34:44.247-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]