[
  {
    "Id": "420335",
    "ThreadId": "205521",
    "Html": "<p>I am using the code listed on http://www.scottlogic.co.uk/blog/colin/2008/12/wpf-datagrid-detecting-clicked-cell-and-row/ for getting row value from datagrid, but I would  like the same thing happening with mouse doubleclick event, not with  mouse right click event.</p>\r\n<p>the dep value after execution of this statement &ldquo;DependencyObject dep  = (DependencyObject)e.OriginalSource;&rdquo; shows  &rsquo;system.windows.controls.textblock&rsquo; for both events that when I  doubleclick the row and when I right click the row</p>\r\n<p>But after execution of following statement:</p>\r\n<p>dep = VisualTreeHelper.GetParent(dep);</p>\r\n<p>dep value is &lsquo;null for mouse doubleclick event and</p>\r\n<p>dep value is presenter(it&rsquo;s parent element) for mouse right click  event.</p>\r\n<p>Can anyone help me? Thanks.</p>",
    "PostedDate": "2010-03-19T10:58:16.5-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "420470",
    "ThreadId": "205521",
    "Html": "<p>This is what I'm doing:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">Public</span> <span style=\"color:Blue\">Class</span> SearchDataGrid\r\n    <span style=\"color:Blue\">Inherits</span> DataGrid\r\n\r\n    <span style=\"color:Blue\">Public</span> <span style=\"color:Blue\">Event</span> ItemOpened <span style=\"color:Blue\">As</span> EventHandler(Of ItemOpenedEventArgs)\r\n\r\n    <span style=\"color:Blue\">Private</span> <span style=\"color:Blue\">Sub</span> SearchDataGrid_PreviewKeyDown(<span style=\"color:Blue\">ByVal</span> sender <span style=\"color:Blue\">As</span> <span style=\"color:Blue\">Object</span>, <span style=\"color:Blue\">ByVal</span> e <span style=\"color:Blue\">As</span> System.Windows.Input.KeyEventArgs) <span style=\"color:Blue\">Handles</span> <span style=\"color:Blue\">Me</span>.PreviewKeyDown\r\n        <span style=\"color:Blue\">If</span> e.Key = Input.Key.Enter <span style=\"color:Blue\">Then</span>\r\n            <span style=\"color:Blue\">If</span> <span style=\"color:Blue\">Me</span>.SelectedItem <span style=\"color:Blue\">IsNot</span> <span style=\"color:Blue\">Nothing</span> <span style=\"color:Blue\">Then</span>\r\n                <span style=\"color:Blue\">RaiseEvent</span> ItemOpened(sender, <span style=\"color:Blue\">New</span> ItemOpenedEventArgs(<span style=\"color:Blue\">Me</span>.SelectedItem))\r\n                e.Handled = <span style=\"color:Blue\">True</span>\r\n            <span style=\"color:Blue\">End</span> <span style=\"color:Blue\">If</span>\r\n        <span style=\"color:Blue\">End</span> <span style=\"color:Blue\">If</span>\r\n    <span style=\"color:Blue\">End</span> <span style=\"color:Blue\">Sub</span>\r\n\r\n\r\n    <span style=\"color:Blue\">Private</span> <span style=\"color:Blue\">Sub</span> SearchDataGrid_MouseDoubleClick(<span style=\"color:Blue\">ByVal</span> sender <span style=\"color:Blue\">As</span> System.Object, <span style=\"color:Blue\">ByVal</span> e <span style=\"color:Blue\">As</span> System.Windows.Input.MouseButtonEventArgs) <span style=\"color:Blue\">Handles</span> <span style=\"color:Blue\">Me</span>.MouseDoubleClick\r\n        <span style=\"color:Blue\">Dim</span> node <span style=\"color:Blue\">As</span> DependencyObject = <span style=\"color:Blue\">CType</span>(e.OriginalSource, DependencyObject)\r\n        <span style=\"color:Blue\">Do</span> <span style=\"color:Blue\">Until</span> <span style=\"color:Blue\">TypeOf</span> node <span style=\"color:Blue\">Is</span> Microsoft.Windows.Controls.DataGridRow <span style=\"color:Blue\">OrElse</span> node <span style=\"color:Blue\">Is</span> <span style=\"color:Blue\">Nothing</span>\r\n            node = VisualTreeHelper.GetParent(node)\r\n        <span style=\"color:Blue\">Loop</span>\r\n\r\n        <span style=\"color:Blue\">If</span> node <span style=\"color:Blue\">IsNot</span> <span style=\"color:Blue\">Nothing</span> <span style=\"color:Blue\">Then</span>\r\n            <span style=\"color:Blue\">Dim</span> data = (<span style=\"color:Blue\">CType</span>(node, Microsoft.Windows.Controls.DataGridRow)).DataContext\r\n            <span style=\"color:Blue\">If</span> data <span style=\"color:Blue\">IsNot</span> <span style=\"color:Blue\">Nothing</span> <span style=\"color:Blue\">Then</span>\r\n                <span style=\"color:Blue\">RaiseEvent</span> ItemOpened(sender, <span style=\"color:Blue\">New</span> ItemOpenedEventArgs(data))\r\n                e.Handled = <span style=\"color:Blue\">True</span>\r\n            <span style=\"color:Blue\">End</span> <span style=\"color:Blue\">If</span>\r\n        <span style=\"color:Blue\">End</span> <span style=\"color:Blue\">If</span>\r\n\r\n    <span style=\"color:Blue\">End</span> <span style=\"color:Blue\">Sub</span>\r\n\r\n<span style=\"color:Blue\">End</span> <span style=\"color:Blue\">Class</span>\r\n\r\n\r\n</pre>\r\n</div>",
    "PostedDate": "2010-03-19T21:43:08.007-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]