[
  {
    "Id": "153931",
    "ThreadId": "46121",
    "Html": "I<span style=\"font-weight:bold\"> have been trying to digest a common methodology that is standard practice for binding a WPF datagrid to an underlying table from a typed dataset in VB.Net. Most examples I have seen are XAML-based, but I would like to be able to define a binding at runtime in VB.Net code so I can use one datagrid to display data from multiple tables on demand.</span><div><span style=\"font-weight:bold\"><br></span></div><div><span style=\"font-weight:bold\">I managed to piece together a test project that propagated changes made in the datagrid back to the actual database, but the binding I used was static XAML and I can't seem to get the same functionality in straight VB code. Here is part of the code:</span></div><div><br></div><div><span style=\"color:rgb(51, 51, 51);font-family:arial;font-size:11px\"> &lt;dg:DataGrid   <br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">            Margin=&quot;10,10,15,1&quot; <br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">            Name=&quot;MyDataGrid&quot; <br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">             AutoGenerateColumns=&quot;False<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">&quot;&gt;<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">              &lt;dg:DataGrid.Columns&gt;<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">                  &lt;dg:DataGridTextColumn <br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">             Header=&quot;PatID&quot;<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">             Binding=&quot;{Binding Path=PatID}&quot;&gt;<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">                &lt;/dg:DataGridTextColumn&gt;<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">                &lt;dg:DataGridTextColumn <br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">                    Header=&quot;Comments&quot;<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">              Binding=&quot;{Binding Path=Comments}&quot;&gt;<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">                 &lt;/dg:DataGridTextColumn&gt;<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">             &lt;/dg:DataGrid.Columns&gt;<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">           &lt;/dg:DataGrid&gt; <br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\"><br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\"><span style=\"font-family:'arial narrow';font-size:16px;font-weight:bold\">On the datagrid SelectionChanged event handler I processed the update:</span><span style=\"font-weight:bold;font-family:'arial narrow';font-size:14px\"><br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\"></span><br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">Private Sub MyDataGrid_SelectionChange<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">d(ByVal sender As Object, ByVal e As System.Windows.Controls.Se<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">lectionCha<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">ngedEventA<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">rgs) Handles MyDataGrid.SelectionChange<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">d<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">     <br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">        Using dtChanges As TestTableDataTable = CType(dsWHOEMR_DEV.TestTab<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">le.GetChan<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">ges, Entities.WHOEMR_DEVDataSet<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">.TestTable<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">DataTable)<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\"><br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\"><br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">            If Not dtChanges Is Nothing Then<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">                    Using ta As New TestTableTableAdapter<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">                    If ta.Update(dtChanges) &gt; 0 Then<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">                        dsWHOEMR_DEV.Merge(dtChang<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">es)<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">                        dsWHOEMR_DEV.AcceptChanges<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">()<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">                    Else<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">                        Debug.WriteLine(&quot;row NOT updated&quot;)<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">                    End If<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">                End Using<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">            End If<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">        End Using<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">         End Sub<br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\"></span><div><br></div><div><br></div><div><div>I tried to do a bind in code this way:</div><div><br></div><div><span style=\"color:rgb(51, 51, 51);font-family:arial;font-size:11px\">Dim myBinding As New Binding  <br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">   'table in typed dataset that contains data I want to display </span></div><div><span style=\"color:rgb(51, 51, 51);font-family:arial;font-size:11px\">myBinding.Source=DAL.Objec<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">tFactory.G<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">etDataset(<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">&quot;PatIDData<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">set1&quot;).Tes<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">tTable  <br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">    'column from dataset table I want to bind to and display in my grid </span></div><div><span style=\"color:rgb(51, 51, 51);font-family:arial;font-size:11px\">myBinding.Path = New System.Windows.PropertyPat<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">h(&quot;PatID&quot;)<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">  <br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">Dim NewColumn As New Microsoft.Windows.Controls<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">.DataGridT<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">extColumn  <br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">NewColumn.Binding = myBinding  <br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">NewColumn.Header = &quot;PatID&quot;  <br style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">Me.MyDataGrid.Columns.Add(<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">NewColumn)<wbr style=\"padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px\">  </span><br></div><div><span style=\"color:rgb(51, 51, 51);font-family:arial;font-size:11px\"><br></span></div><div><span style=\"color:rgb(51, 51, 51);font-family:arial;font-size:11px\"><br></span></div><div>Nothing displayed in the grid other than the column header. <br><div><br></div><div>Has anyone been able to do this kind of binding successfully? </div><div><br></div></div></div></div>",
    "PostedDate": "2009-02-03T12:58:54.967-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "158950",
    "ThreadId": "46121",
    "Html": "You have to set the source binding on the DataGrid.ItemsSource and for the column you just need to set the path.\r\n",
    "PostedDate": "2009-02-18T05:24:40.633-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]