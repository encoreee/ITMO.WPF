[
  {
    "Id": "481843",
    "ThreadId": "223955",
    "Html": "<p>I developed a simple Word 2007&nbsp;addin using VS 2010 VSTO, in the addin I simply want to display WPF RibbonWindow like this:</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>&nbsp;<div style=\"color:black;background-color:white\"><pre>            <span style=\"color:blue\">if</span> (WpfApp == <span style=\"color:blue\">null</span>)\r\n            {\r\n                <span style=\"color:green\">//I get same result when deleteing the following two lines</span>\r\n                WpfApp = <span style=\"color:blue\">new</span> System.Windows.Application();\r\n                WpfApp.ShutdownMode = System.Windows.ShutdownMode.OnExplicitShutdown;\r\n            }\r\n            <span style=\"color:green\">//MainWindow is derived from RibbonWindow</span>\r\n            WpfRibbonApplication1.MainWindow window = <span style=\"color:blue\">new</span> WpfRibbonApplication1.MainWindow();\r\n            window.ShowDialog();\r\n\r\n</pre>\r\n</div>\r\n</pre>\r\n<pre>Everything works fine until I close Word. When closing Word, Word crashed with the following error:</pre>\r\n</div>\r\n<p><strong><em>Problem signature:</em></strong><br><strong><em>&nbsp; Problem Event Name:&nbsp;CLR20r3</em></strong><br><strong><em>&nbsp; Problem Signature 01:&nbsp;winword.exe</em></strong><br><strong><em>&nbsp; Problem Signature 02:&nbsp;12.0.4518.1014</em></strong><br><strong><em>&nbsp; Problem Signature 03:&nbsp;45428028</em></strong><br><strong><em>&nbsp; OS Version:&nbsp;6.1.7600.2.0.0.256.1</em></strong><br><strong><em>&nbsp; Locale ID:&nbsp;1033</em></strong></p>\r\n<p><strong><em>Additional information about the problem:</em></strong><br><strong><em>&nbsp; LCID:&nbsp;1033</em></strong><br><strong><em>&nbsp; Brand:&nbsp;Office12Crash</em></strong><br><strong><em>&nbsp; skulcid:&nbsp;1033</em></strong></p>\r\n<p><strong><em>Read our privacy statement online:</em></strong><br><strong><em>&nbsp; <a href=\"http://go.microsoft.com/fwlink/?linkid=104288&clcid=0x0409\">http://go.microsoft.com/fwlink/?linkid=104288&amp;clcid=0x0409</a></em></strong></p>\r\n<p><strong><em>If the online privacy statement is not available, please read our privacy statement offline:</em></strong><br><em><strong>&nbsp; C:\\Windows\\system32\\en-US\\erofflps.txt</strong></em></p>\r\n<p>&nbsp;However if I replace MainWindow with Window1 which derives from Window and contains no Ribbon, the crash won't happen. So I think Ribbon/RibbonWindow causes Word's crash. BTW, I didn't see any problem when I use WPF Ribbon preview version.</p>\r\n<p>Any suggestion? Thanks in advance.</p>",
    "PostedDate": "2010-08-18T06:34:54.737-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]