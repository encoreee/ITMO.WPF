[
  {
    "Id": "700974",
    "ThreadId": "280194",
    "Html": "\r\n<p>Hi,All.</p>\r\n<p>&nbsp; &nbsp; I've got a issue when i use the datagrid control in WPFToolkit.Follow is my step:</p>\r\n<p>&nbsp; &nbsp; 1.Create Microsoft.Windows.Control.DataGrid object in csharp code and set the object's ItemsSource with DataTable.DefaultView.</p>\r\n<p>&nbsp; &nbsp; 2.Add object to TabItem Control belong TabControl.</p>\r\n<p>&nbsp; &nbsp; 3.Set the control's SelectedIndex with code when a DataGrid Control's SelectionChanged event action.</p>\r\n<p>&nbsp; &nbsp; Then I saw the selected row in datagrid not highlight correct.Follow is my code of create datagrid and binding data:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:gray\"><span style=\"white-space:pre\">\t</span>///</span> <span style=\"color:gray\">&lt;summary&gt;</span>\r\n        <span style=\"color:gray\">///</span><span style=\"color:green\"> Load table data list</span>\r\n        <span style=\"color:gray\">///</span> <span style=\"color:gray\">&lt;/summary&gt;</span>\r\n        <span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> LoadTableDataList(<span style=\"color:blue\">string</span> _tableName)\r\n        {\r\n            <span style=\"color:blue\">try</span>\r\n            {\r\n                <span style=\"color:blue\">this</span>.dgTableDataList.ItemsSource = DatabaseAccess.MySqlAccess.GetTableData(<span style=\"color:blue\">this</span>.DatabaseConnection, _tableName).DefaultView;\r\n                LoadReferenceTableData(_tableName);\r\n            }\r\n            <span style=\"color:blue\">catch</span>\r\n            {\r\n                <span style=\"color:blue\">this</span>.dgTableDataList.ItemsSource = <span style=\"color:blue\">null</span>;\r\n            }\r\n        }\r\n\r\n        <span style=\"color:gray\">///</span> <span style=\"color:gray\">&lt;summary&gt;</span>\r\n        <span style=\"color:gray\">///</span><span style=\"color:green\"> Load table's reference table data list</span>\r\n        <span style=\"color:gray\">///</span> <span style=\"color:gray\">&lt;/summary&gt;</span>\r\n        <span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> LoadReferenceTableData(<span style=\"color:blue\">string</span> _tableName)\r\n        {\r\n            List&lt;DataEntity.BasicInfo.TableReferenceColumns&gt; _tableReferenceList = DatabaseAccess.SqliteAccess.GetReferenceList(<span style=\"color:blue\">this</span>.ConfigConnection, _tableName, <span style=\"color:blue\">this</span>.DBConnectionId);\r\n            <span style=\"color:blue\">this</span>.tbAssociatedTableData.Tag = _tableReferenceList;\r\n\r\n            tbAssociatedTableData.Items.Clear();\r\n\r\n            <span style=\"color:blue\">foreach</span> (DataEntity.BasicInfo.TableReferenceColumns _referenceColumns <span style=\"color:blue\">in</span> _tableReferenceList)\r\n            {\r\n                TabItem _tabItem = <span style=\"color:blue\">new</span> TabItem();\r\n                _tabItem.Header = _referenceColumns.ReferenceTableName;\r\n                _tabItem.ToolTip = <span style=\"color:#a31515\">&quot;Reference to Column:&quot;</span> &#43; _referenceColumns.ColumnName;\r\n\r\n                Microsoft.Windows.Controls.DataGrid _dataGrid = <span style=\"color:blue\">new</span> Microsoft.Windows.Controls.DataGrid();\r\n                <span style=\"color:green\">//DataGrid _dataGrid = new DataGrid();</span>\r\n                _dataGrid.Name = _referenceColumns.ReferenceTableName;\r\n                _dataGrid.ItemsSource = DatabaseAccess.MySqlAccess.GetTableData(<span style=\"color:blue\">this</span>.DatabaseConnection, _referenceColumns.ReferenceTableName).DefaultView;\r\n                _tabItem.Content = _dataGrid;\r\n\r\n                <span style=\"color:blue\">this</span>.tbAssociatedTableData.Items.Add(_tabItem);\r\n            }\r\n        }\r\n</pre>\r\n<pre><br></pre>\r\n<pre>    Follow is the code of change the selected index of datagrid control created by code:</pre>\r\n<pre><div style=\"color:black; background-color:white\"><pre><span style=\"color:blue\"><span style=\"white-space:pre\">\t</span>private</span> <span style=\"color:blue\">void</span> dgTableDataList_SelectionChanged(<span style=\"color:blue\">object</span> sender, SelectionChangedEventArgs e)\r\n        {\r\n            DataRowView _dataRowView = <span style=\"color:blue\">this</span>.dgTableDataList.SelectedItem <span style=\"color:blue\">as</span> DataRowView;\r\n\r\n            <span style=\"color:blue\">if</span> (_dataRowView != <span style=\"color:blue\">null</span>)\r\n            {\r\n                DataRow _dataRow = _dataRowView.Row;\r\n\r\n                List&lt;DataEntity.BasicInfo.TableReferenceColumns&gt; _tableReferenceList = <span style=\"color:blue\">this</span>.tbAssociatedTableData.Tag <span style=\"color:blue\">as</span> List&lt;DataEntity.BasicInfo.TableReferenceColumns&gt;;\r\n\r\n                <span style=\"color:blue\">if</span> (_tableReferenceList != <span style=\"color:blue\">null</span>)\r\n                {\r\n                    <span style=\"color:blue\">if</span> (_tableReferenceList.Count &gt; 0)\r\n                    {\r\n                        <span style=\"color:blue\">foreach</span> (DataEntity.BasicInfo.TableReferenceColumns _reference <span style=\"color:blue\">in</span> _tableReferenceList)\r\n                        {\r\n                            SelectReferenceData(_reference, _dataRow[_reference.ColumnName]);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                <span style=\"color:blue\">this</span>.btnTableDataEdit.IsEnabled = <span style=\"color:blue\">this</span>.btnTableDataDelete.IsEnabled = <span style=\"color:blue\">true</span>;\r\n            }\r\n            <span style=\"color:blue\">else</span>\r\n            {\r\n                <span style=\"color:blue\">this</span>.btnTableDataEdit.IsEnabled = <span style=\"color:blue\">this</span>.btnTableDataDelete.IsEnabled = <span style=\"color:blue\">false</span>;\r\n            }\r\n        }\r\n</pre>\r\n</div>\r\n<br></pre>\r\n<pre><span style=\"white-space:pre\"><div style=\"color:black; background-color:white\"><pre><span style=\"color:blue\"><span style=\"white-space:pre\">\t</span>private</span> <span style=\"color:blue\">void</span> SelectReferenceData(DataEntity.BasicInfo.TableReferenceColumns _reference, <span style=\"color:blue\">object</span> _selectVaule)</pre>\r\n<pre>        {\r\n            <span style=\"color:blue\">foreach</span> (TabItem _tabItem <span style=\"color:blue\">in</span> <span style=\"color:blue\">this</span>.tbAssociatedTableData.Items)\r\n            {\r\n                <span style=\"color:blue\">if</span> (_tabItem.Header.ToString() == _reference.ReferenceTableName)\r\n                {\r\n                    Microsoft.Windows.Controls.DataGrid _dataGrid = _tabItem.Content <span style=\"color:blue\">as</span> Microsoft.Windows.Controls.DataGrid;\r\n\r\n                    <span style=\"color:blue\">if</span> (_dataGrid != <span style=\"color:blue\">null</span>)\r\n                    {\r\n                        <span style=\"color:blue\">int</span> _selectIndex = 0;\r\n                        DataView _dataView = _dataGrid.ItemsSource <span style=\"color:blue\">as</span> DataView;\r\n\r\n                        <span style=\"color:blue\">foreach</span> (DataRow _dataRow <span style=\"color:blue\">in</span> _dataView.Table.Rows)\r\n                        {\r\n                            <span style=\"color:blue\">object</span> _val = _dataRow[_reference.ReferenceColumnName];\r\n                            <span style=\"color:blue\">if</span> (_dataRow[_reference.ReferenceColumnName].ToString() != _selectVaule.ToString())\r\n                            {\r\n                                _selectIndex&#43;&#43;;\r\n                            }\r\n                            <span style=\"color:blue\">else</span>\r\n                            {\r\n                                _dataGrid.SelectedIndex = _selectIndex;\r\n\r\n                                _dataGrid.ScrollIntoView(_dataView[_selectIndex]);\r\n\r\n                                <span style=\"color:blue\">break</span>;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n</pre>\r\n</div>\r\n</span></pre>\r\n</div>\r\n<p></p>\r\n",
    "PostedDate": "2011-11-20T18:52:07.333-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]