[
  {
    "Id": "133687",
    "ThreadId": "40293",
    "Html": "Hi,<br>\r\nIs there an easy way to allow a user to right click on a ribbon button, and select &quot;Add to Quick Access Toolbar&quot;?<br>\r\n<br>\r\nThanks,<br>\r\naSchimp\r\n",
    "PostedDate": "2008-11-19T09:54:52.58-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "133727",
    "ThreadId": "40293",
    "Html": "Hi aSchimp,<br>\r\n<br>\r\nYou would just need to implement a ContextMenu with an item for &quot;Add to Quick Access Toolbar&quot; and when the user selects that item, you would want to create a copy of the control that the user had clicked on (for example, if it was a RibbonButton, just create a new button and assign the same command to it) and add the control to the Quick Access Toolbar with the Placement attached property set to InToolbar.<br>\r\n<br>\r\nIf you need help implementing this, let me know.<br>\r\n<br>\r\nThanks!<br>\r\nSamantha\r\n",
    "PostedDate": "2008-11-19T11:43:15.98-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "137491",
    "ThreadId": "40293",
    "Html": "In case anyone would like an example, I wrote a quick sample showing how to do this:<br>\r\n<br>\r\nIn the XAML:<br>\r\n<br>\r\n<span style=\"font-size:13px;color:#0000ff\"> &lt;</span><span style=\"font-size:13px;color:#a31515\">r</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">RibbonWindow</span><span style=\"font-size:13px;color:#ff0000\"> x</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#ff0000\">Class</span><span style=\"font-size:13px;color:#0000ff\">=&quot;RibbonAddToQAT.Window1&quot;<br>\r\n</span><span style=\"font-size:13px;color:#ff0000\">xmlns</span><span style=\"font-size:13px;color:#0000ff\">=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;<br>\r\n</span><span style=\"font-size:13px;color:#ff0000\">xmlns</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#ff0000\">x</span><span style=\"font-size:13px;color:#0000ff\">=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;<br>\r\n</span><span style=\"font-size:13px;color:#ff0000\">xmlns</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#ff0000\">r</span><span style=\"font-size:13px;color:#0000ff\">=&quot;clr-namespace:Microsoft.Windows.Controls.Ribbon;assembly=RibbonControlsLibrary&quot;<br>\r\n</span><span style=\"font-size:13px;color:#ff0000\">Title</span><span style=\"font-size:13px;color:#0000ff\">=&quot;Window1&quot;</span><span style=\"font-size:13px;color:#ff0000\"> Height</span><span style=\"font-size:13px;color:#0000ff\">=&quot;500&quot;</span><span style=\"font-size:13px;color:#ff0000\"> Width</span><span style=\"font-size:13px;color:#0000ff\">=&quot;500&quot;<br>\r\n</span><span style=\"font-size:13px;color:#ff0000\">Background</span><span style=\"font-size:13px;color:#0000ff\">=&quot;White&quot;&gt;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">     &lt;</span><span style=\"font-size:13px;color:#a31515\">r</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">RibbonWindow.Resources</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">     <span style=\"font-size:13px;color:#0000ff\">     </span></span></span><span style=\"font-size:13px;color:#0000ff\">&lt;</span><span style=\"font-size:13px;color:#a31515\">r</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">RibbonCommand</span><span style=\"font-size:13px;color:#ff0000\"> x</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#ff0000\">Key</span><span style=\"font-size:13px;color:#0000ff\">=&quot;myCommand&quot;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">               </span></span><span style=\"font-size:13px;color:#ff0000\">LabelTitle</span><span style=\"font-size:13px;color:#0000ff\">=&quot;Button1&quot;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">     <span style=\"font-size:13px;color:#0000ff\">          </span></span></span><span style=\"font-size:13px;color:#ff0000\">SmallImageSource</span><span style=\"font-size:13px;color:#0000ff\">=&quot;icon.png&quot;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">               </span></span><span style=\"font-size:13px;color:#ff0000\">LargeImageSource</span><span style=\"font-size:13px;color:#0000ff\">=&quot;icon.png&quot;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">               </span></span><span style=\"font-size:13px;color:#ff0000\">CanExecute</span><span style=\"font-size:13px;color:#0000ff\">=&quot;RibbonCommand_CanExecute&quot;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">               </span></span><span style=\"font-size:13px;color:#ff0000\">Executed</span><span style=\"font-size:13px;color:#0000ff\">=&quot;RibbonCommand_Executed&quot;</span><span style=\"font-size:13px;color:#0000ff\">/&gt;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">     </span></span><span style=\"font-size:13px;color:#0000ff\">&lt;/</span><span style=\"font-size:13px;color:#a31515\">r</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">RibbonWindow.Resources</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">     </span></span><span style=\"font-size:13px;color:#0000ff\">&lt;</span><span style=\"font-size:13px;color:#a31515\">Grid</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">     <span style=\"font-size:13px;color:#0000ff\">     </span></span></span><span style=\"font-size:13px;color:#0000ff\">&lt;</span><span style=\"font-size:13px;color:#a31515\">r</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">Ribbon</span><span style=\"font-size:13px;color:#ff0000\"> Name</span><span style=\"font-size:13px;color:#0000ff\">=&quot;myRibbon&quot;&gt;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">     <span style=\"font-size:13px;color:#0000ff\">          </span></span></span><span style=\"font-size:13px;color:#0000ff\">&lt;</span><span style=\"font-size:13px;color:#a31515\">r</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">RibbonTab</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">                    </span></span><span style=\"font-size:13px;color:#0000ff\">&lt;</span><span style=\"font-size:13px;color:#a31515\">r</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">RibbonGroup</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">                         </span></span><span style=\"font-size:13px;color:#0000ff\">&lt;</span><span style=\"font-size:13px;color:#a31515\">r</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">RibbonButton</span><span style=\"font-size:13px;color:#ff0000\"> Command</span><span style=\"font-size:13px;color:#0000ff\">=&quot;{</span><span style=\"font-size:13px;color:#a31515\">StaticResource</span><span style=\"font-size:13px;color:#ff0000\"> myCommand</span><span style=\"font-size:13px;color:#0000ff\">}&quot;&gt;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">     <span style=\"font-size:13px;color:#0000ff\">                         </span></span></span><span style=\"font-size:13px;color:#0000ff\">&lt;</span><span style=\"font-size:13px;color:#a31515\">r</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">RibbonButton.ContextMenu</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">                              <span style=\"font-size:13px;color:#0000ff\">     </span></span></span><span style=\"font-size:13px;color:#0000ff\">&lt;</span><span style=\"font-size:13px;color:#a31515\">ContextMenu</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">                         <span style=\"font-size:13px;color:#0000ff\">               </span></span></span><span style=\"font-size:13px;color:#0000ff\">&lt;</span><span style=\"font-size:13px;color:#a31515\">MenuItem</span><span style=\"font-size:13px;color:#ff0000\"> Header</span><span style=\"font-size:13px;color:#0000ff\">=&quot;Add to Quick Access Toolbar&quot; </span><span style=\"font-size:13px;color:#ff0000\">Click</span><span style=\"font-size:13px;color:#0000ff\">=&quot;AddToQAT&quot;</span><span style=\"font-size:13px;color:#0000ff\">/&gt;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">                         <span style=\"font-size:13px;color:#0000ff\">     <span style=\"font-size:13px;color:#0000ff\">     </span></span></span></span><span style=\"font-size:13px;color:#0000ff\">&lt;/</span><span style=\"font-size:13px;color:#a31515\">ContextMenu</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">                         <span style=\"font-size:13px;color:#0000ff\">     </span></span></span><span style=\"font-size:13px;color:#0000ff\">&lt;/</span><span style=\"font-size:13px;color:#a31515\">r</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">RibbonButton.ContextMenu</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">                         </span></span><span style=\"font-size:13px;color:#0000ff\">&lt;/</span><span style=\"font-size:13px;color:#a31515\">r</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">RibbonButton</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">                    </span></span><span style=\"font-size:13px;color:#0000ff\">&lt;/</span><span style=\"font-size:13px;color:#a31515\">r</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">RibbonGroup</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">               </span></span><span style=\"font-size:13px;color:#0000ff\">&lt;/</span><span style=\"font-size:13px;color:#a31515\">r</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">RibbonTab</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">          </span></span><span style=\"font-size:13px;color:#0000ff\">&lt;/</span><span style=\"font-size:13px;color:#a31515\">r</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">Ribbon</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">     </span></span><span style=\"font-size:13px;color:#0000ff\">&lt;/</span><span style=\"font-size:13px;color:#a31515\">Grid</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n&lt;/</span><span style=\"font-size:13px;color:#a31515\">r</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">RibbonWindow</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n<br>\r\nIn the code behind:<br>\r\n<br>\r\n<span style=\"font-size:13px;color:#0000ff\">using</span><span style=\"font-size:13px\"> System;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">using</span><span style=\"font-size:13px\"> System.Windows;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">using</span><span style=\"font-size:13px\"> System.Windows.Controls;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">using</span><span style=\"font-size:13px\"> System.Windows.Input;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">using</span><span style=\"font-size:13px\"> Microsoft.Windows.Controls.Ribbon;<br>\r\n<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">namespace</span><span style=\"font-size:13px\"> RibbonAddToQAT<br>\r\n{<br>\r\n     </span><span style=\"font-size:13px;color:#0000ff\">public</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">partial</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">class</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">Window1</span><span style=\"font-size:13px\"> : </span><span style=\"font-size:13px;color:#2b91af\">RibbonWindow<br>\r\n<span style=\"font-size:13px;color:#0000ff\">     </span></span><span style=\"font-size:13px\">{<br>\r\n<span style=\"font-size:13px;color:#0000ff\">          </span></span><span style=\"font-size:13px;color:#0000ff\">public</span><span style=\"font-size:13px\"> Window1()<br>\r\n<span style=\"font-size:13px;color:#0000ff\">          </span>{<br>\r\n<span style=\"font-size:13px;color:#0000ff\">               </span>InitializeComponent();<br>\r\n<span style=\"font-size:13px;color:#0000ff\">     <span style=\"font-size:13px;color:#0000ff\">     </span></span>}<br>\r\n<br>\r\n<span style=\"font-size:13px;color:#0000ff\">     </span></span><span style=\"font-size:13px;color:#0000ff\">private</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">void</span><span style=\"font-size:13px\"> AddToQAT(</span><span style=\"font-size:13px;color:#0000ff\">object</span><span style=\"font-size:13px\"> sender, </span><span style=\"font-size:13px;color:#2b91af\">RoutedEventArgs</span><span style=\"font-size:13px\"> e)<br>\r\n<span style=\"font-size:13px;color:#0000ff\">     </span>{<br>\r\n<span style=\"font-size:13px;color:#0000ff\">     <span style=\"font-size:13px;color:#0000ff\">     </span></span></span><span style=\"font-size:13px;color:#008000\">// Step 1 - Find out what type of control is being added to the QAT<br>\r\n<span style=\"font-size:13px;color:#0000ff\">          </span></span><span style=\"font-size:13px;color:#2b91af\">Type</span><span style=\"font-size:13px\"> controlType = ((</span><span style=\"font-size:13px;color:#2b91af\">ContextMenu</span><span style=\"font-size:13px\">)((</span><span style=\"font-size:13px;color:#2b91af\">MenuItem</span><span style=\"font-size:13px\">)sender).Parent).PlacementTarget.GetType();<br>\r\n<br>\r\n<span style=\"font-size:13px;color:#0000ff\">          </span></span><span style=\"font-size:13px;color:#008000\">// Do a check for each control type in your Ribbon to determine what type the sending control is<br>\r\n<span style=\"font-size:13px;color:#0000ff\">          </span></span><span style=\"font-size:13px;color:#008000\">// This is an example of how to do it for RibbonButton<br>\r\n<span style=\"font-size:13px;color:#0000ff\">          </span></span><span style=\"font-size:13px;color:#0000ff\">if</span><span style=\"font-size:13px\"> (controlType == </span><span style=\"font-size:13px;color:#0000ff\">typeof</span><span style=\"font-size:13px\">(</span><span style=\"font-size:13px;color:#2b91af\">RibbonButton</span><span style=\"font-size:13px\">))<br>\r\n<span style=\"font-size:13px;color:#0000ff\">          </span>{<br>\r\n<span style=\"font-size:13px;color:#0000ff\">               </span></span><span style=\"font-size:13px;color:#008000\">// Step 2 - Clone the control<br>\r\n<span style=\"font-size:13px;color:#0000ff\">               </span></span><span style=\"font-size:13px;color:#008000\">// 2A - Once you know the type, create a new instance of that type<br>\r\n<span style=\"font-size:13px;color:#0000ff\">               </span></span><span style=\"font-size:13px;color:#2b91af\">RibbonButton</span><span style=\"font-size:13px\"> newButton = </span><span style=\"font-size:13px;color:#0000ff\">new</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">RibbonButton</span><span style=\"font-size:13px\">();<br>\r\n<br>\r\n<span style=\"font-size:13px;color:#0000ff\">               </span></span><span style=\"font-size:13px;color:#008000\">// 2B - Assign the same RibbonCommand to the new instance of the control as is used on the original instance.<br>\r\n<span style=\"font-size:13px;color:#0000ff\">               </span></span><span style=\"font-size:13px;color:#008000\">// This will make sure that the controls have the same visual and command properties<br>\r\n<span style=\"font-size:13px;color:#0000ff\">               </span></span><span style=\"font-size:13px\">newButton.Command = ((</span><span style=\"font-size:13px;color:#2b91af\">RibbonButton</span><span style=\"font-size:13px\">)((</span><span style=\"font-size:13px;color:#2b91af\">ContextMenu</span><span style=\"font-size:13px\">)((</span><span style=\"font-size:13px;color:#2b91af\">MenuItem</span><span style=\"font-size:13px\">)sender).Parent).PlacementTarget).Command;<br>\r\n<br>\r\n<span style=\"font-size:13px;color:#0000ff\">               </span></span><span style=\"font-size:13px;color:#008000\">// Step 3 - Add the new control to the QuickAccessToolBar<br>\r\n<span style=\"font-size:13px;color:#0000ff\">               </span></span><span style=\"font-size:13px\">myRibbon.QuickAccessToolBar.Items.Add(newButton);<br>\r\n<span style=\"font-size:13px;color:#0000ff\">               </span>}<br>\r\n<br>\r\n</span><span style=\"font-size:13px;color:#008000\">// Other Considerations<br>\r\n</span><span style=\"font-size:13px;color:#008000\">// - Control states. You may need to make sure that the control states are in sync. For example, if you have toggle buttons, the toggle state <br>\r\n</span><span style=\"font-size:13px;color:#008000\">// of the control on the QAT should be the same as the corresponding control on the Ribbon.<br>\r\n</span><span style=\"font-size:13px;color:#008000\">// - Serialization. You may want to serialize the controls in the QAT so that the same ones appear the next time the user opens the application<br>\r\n</span><span style=\"font-size:13px;color:#008000\">// - Scalability. In this case, we've defined the ContextMenu on the control itself, but in a real-world scenario, this approach doesn't really scale. <br>\r\n</span><span style=\"font-size:13px;color:#008000\">// Instead, what you'd want to do is to set the ContextMenu at the Ribbon level. However, this will break the check for the control type, since <br>\r\n</span><span style=\"font-size:13px;color:#008000\">// PlacementTarget will always return Ribbon. To find the control that was clicked, you can handle the PreviewMouseUp event and use it in the<br>\r\n</span><span style=\"font-size:13px;color:#008000\">// context menu handler.<br>\r\n</span><span style=\"font-size:13px\"><span style=\"font-size:13px;color:#0000ff\">          </span>} <br>\r\n<br>\r\n<span style=\"font-size:13px;color:#0000ff\">          </span></span><span style=\"font-size:13px;color:#0000ff\">private</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">void</span><span style=\"font-size:13px\"> RibbonCommand_CanExecute(</span><span style=\"font-size:13px;color:#0000ff\">object</span><span style=\"font-size:13px\"> sender, </span><span style=\"font-size:13px;color:#2b91af\">CanExecuteRoutedEventArgs</span><span style=\"font-size:13px\"> e)<br>\r\n<span style=\"font-size:13px;color:#0000ff\">          </span>{<br>\r\n<span style=\"font-size:13px;color:#0000ff\">               </span>e.CanExecute = </span><span style=\"font-size:13px;color:#0000ff\">true</span><span style=\"font-size:13px\">;<br>\r\n<span style=\"font-size:13px;color:#0000ff\">          </span>}<br>\r\n<br>\r\n<span style=\"font-size:13px;color:#0000ff\">          </span></span><span style=\"font-size:13px;color:#0000ff\">private</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">void</span><span style=\"font-size:13px\"> RibbonCommand_Executed(</span><span style=\"font-size:13px;color:#0000ff\">object</span><span style=\"font-size:13px\"> sender, </span><span style=\"font-size:13px;color:#2b91af\">ExecutedRoutedEventArgs</span><span style=\"font-size:13px\"> e)<br>\r\n<span style=\"font-size:13px;color:#0000ff\">          </span>{<br>\r\n<span style=\"font-size:13px;color:#0000ff\">               </span></span><span style=\"font-size:13px;color:#008000\">//Not implemented<br>\r\n<span style=\"font-size:13px;color:#0000ff\">          </span></span><span style=\"font-size:13px\">}<br>\r\n<span style=\"font-size:13px;color:#0000ff\">     </span>}<br>\r\n}</span><br>\r\n<p>&nbsp;</p>\r\n<p> </p>\r\n</span>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2008-12-03T16:57:16.943-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "154392",
    "ThreadId": "40293",
    "Html": "Are there any examples or guidance on how to serialize the QAT?&nbsp; <br>\r\n",
    "PostedDate": "2009-02-04T12:12:29.147-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]