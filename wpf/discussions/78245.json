[
  {
    "Id": "267672",
    "ThreadId": "78245",
    "Html": "<p>I create a column dynamically with the following code:</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><div style=\"color:Black;background-color:White\"><pre>DataGridTextColumn col = <span style=\"color:Blue\">new</span> DataGridTextColumn();\r\nTextBlock text = <span style=\"color:Blue\">new</span> TextBlock(<span style=\"color:Blue\">new</span> Run(<span style=\"color:#A31515\">&quot;Header&quot;</span>));\r\ncol.Header = text;\r\n<span style=\"color:Green\">//col.Header = &quot;Header&quot;;</span>\r\ngrid.Columns.Add(col);\r\n</pre>\r\n</div>\r\n</pre>\r\n</div>\r\n<p>When I toggle visibility from Visible to Hidden and backwards I receive the following error: &quot;Specified element is already the logical child of another element. Disconnect it first.&quot;.</p>\r\n<p>All is well when using just a text instead of a TextBlock (the commented line).</p>\r\n<p>&nbsp;</p>\r\n<p>Am I doing something wrong here or is this a bug?</p>\r\n<p>Frank</p>",
    "PostedDate": "2009-12-15T11:33:03.587-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "271713",
    "ThreadId": "78245",
    "Html": "<p>I am having the same problem. Have you found a workaround yet for this problem?</p>\r\n<p>Thanks in advance</p>",
    "PostedDate": "2009-12-30T07:21:20.807-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "271717",
    "ThreadId": "78245",
    "Html": "<p>The same problem arises when you create many columns in code btw.</p>\r\n<p>Yep I used a different approach (which works here) using headerbinding.</p>\r\n<p>The code:</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>Style headerStyle = (Style)Resources[<span style=\"color:#A31515\">&quot;ColumnHeaderStyle&quot;</span>];<br>DataGridTextColumn col = <span style=\"color:Blue\">new</span> DataGridTextColumn();<br>myColumnInfo colInfo = <span style=\"color:Blue\">new</span> myColumnInfo(...);<br>col.HeaderStyle = headerStyle;<br>col.Header = colInfo;<br>Binding visiblityBinding = new Binding(&quot;ColVisibility&quot;);<br>visiblityBinding.Source = colInfo;<br>BindingOperations.SetBinding(col, DataGridTextColumn.VisibilityProperty, visiblityBinding);<br></pre>\r\n</div>\r\n</p>\r\n<p>The Class:</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>[Serializable]\r\n    <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">class</span> myColumnInfo : INotifyPropertyChanged\r\n    {        \r\n        <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">string</span> Name { <span style=\"color:Blue\">get</span>; <span style=\"color:Blue\">set</span>; }\r\n        <span style=\"color:Blue\">private</span> Visibility colVisibility;\r\n        <span style=\"color:Blue\">public</span> myColumnInfo()\r\n            : <span style=\"color:Blue\">base</span>()\r\n        {\r\n            <span style=\"color:Green\">// for serialisation</span>\r\n        }\r\n        <span style=\"color:Blue\">public</span> myColumnInfo(...)\r\n        {           \r\n            Name = name;\r\n            colVisibility = Visibility.Visible;\r\n        }\r\n        <span style=\"color:Blue\">public</span> Visibility ColVisibility\r\n        {\r\n            <span style=\"color:Blue\">get</span> { <span style=\"color:Blue\">return</span> colVisibility; }\r\n            <span style=\"color:Blue\">set</span>\r\n            {\r\n                <span style=\"color:Blue\">if</span> (colVisibility != value)\r\n                {\r\n                    colVisibility = value;\r\n                    NotifyPropertyChanged(<span style=\"color:#A31515\">&quot;ColVisibility&quot;</span>);\r\n                }\r\n            }\r\n        }\r\n        [<span style=\"color:Blue\">field</span>: NonSerialized]\r\n        <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">event</span> PropertyChangedEventHandler PropertyChanged;\r\n        <span style=\"color:Blue\">private</span> <span style=\"color:Blue\">void</span> NotifyPropertyChanged(<span style=\"color:Blue\">string</span> propertyName)\r\n        {\r\n            <span style=\"color:Blue\">if</span> (PropertyChanged != <span style=\"color:Blue\">null</span>)\r\n            {\r\n                PropertyChanged(<span style=\"color:Blue\">this</span>,\r\n                  <span style=\"color:Blue\">new</span> PropertyChangedEventArgs(propertyName));\r\n            }\r\n        }\r\n    }\r\n</pre>\r\n</div>\r\n</p>\r\n<p>And the xaml:</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>&lt;Style x:Key=<span style=\"color:#A31515\">&quot;ColumnHeaderStyle&quot;</span> TargetType=<span style=\"color:#A31515\">&quot;dg:DataGridColumnHeader&quot;</span>&gt;\r\n                &lt;Setter Property=<span style=\"color:#A31515\">&quot;ContentTemplate&quot;</span>&gt;\r\n                    &lt;Setter.Value&gt;\r\n                        &lt;DataTemplate&gt;\r\n                            &lt;StackPanel&gt;                                \r\n                                &lt;TextBlock Text=<span style=\"color:#A31515\">&quot;{Binding Name}&quot;</span> HorizontalAlignment=<span style=\"color:#A31515\">&quot;Center&quot;</span> VerticalAlignment=<span style=\"color:#A31515\">&quot;Center&quot;</span> /&gt;\r\n                            &lt;/StackPanel&gt;\r\n                        &lt;/DataTemplate&gt;\r\n                    &lt;/Setter.Value&gt;\r\n                &lt;/Setter&gt;\r\n            &lt;/Style&gt;\r\n</pre>\r\n</div>\r\n</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-12-30T07:42:49.747-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "271875",
    "ThreadId": "78245",
    "Html": "<p>Hi All,</p>\r\n<p>Is it similar to this problem?</p>\r\n<p>http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=520201</p>",
    "PostedDate": "2009-12-30T17:26:46.327-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "271914",
    "ThreadId": "78245",
    "Html": "<p>It looks the same.</p>\r\n<p>I do have <span>EnableColumnVirtualization=true in my code.<br></span></p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-12-31T00:25:30.223-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]