[
  {
    "Id": "582524",
    "ThreadId": "250234",
    "Html": "\r\n<p>Hi,</p>\r\n<p>I'm having this strange issue on a specific computer running .NET 4.0 Framework. On another computer the error below does not occur, and I can gurantee that it's the same source code (TFS version controlled). I already tried reparing the .NET Framework 4.0\r\n installation.</p>\r\n<p>Heres the exception details. The core issue seems to be the System.IO.FileNotFoundException regarding the Microsoft.Windows.Shell assembly. Could this be my Windows 7 installation? It's not different that the other computer, but something might have broken\r\n it. Do you have any suggestions on how to fix this issue?</p>\r\n<p>Thank you very much!</p>\r\n<pre>System.Windows.Markup.XamlParseException occurred\r\n  Message='Initialization of 'Microsoft.Windows.Controls.Ribbon.RibbonSplitButton' threw an exception.' Line number '37' and line position '22'.\r\n  Source=PresentationFramework\r\n  LineNumber=37\r\n  LinePosition=22\r\n  StackTrace:\r\n       at System.Windows.Markup.XamlReader.RewrapException(Exception e, IXamlLineInfo lineInfo, Uri baseUri)\r\n       at System.Windows.Markup.WpfXamlLoader.Load(XamlReader xamlReader, IXamlObjectWriterFactory writerFactory, Boolean skipJournaledProperties, Object rootObject, XamlObjectWriterSettings settings, Uri baseUri)\r\n       at System.Windows.Markup.WpfXamlLoader.LoadBaml(XamlReader xamlReader, Boolean skipJournaledProperties, Object rootObject, XamlAccessLevel accessLevel, Uri baseUri)\r\n       at System.Windows.Markup.XamlReader.LoadBaml(Stream stream, ParserContext parserContext, Object parent, Boolean closeStream)\r\n       at System.Windows.Application.LoadComponent(Object component, Uri resourceLocator)\r\n       at Ams.RibbonModule.Views.OrderRibbonView.InitializeComponent() in c:\\Users\\thj\\Workspace\\Presentation.Ams.RibbonModule\\Views\\OrderRibbonView.xaml:line 1\r\n       at Ams.RibbonModule.Views.OrderRibbonView..ctor() in C:\\Users\\thj\\Workspace\\Presentation.Ams.RibbonModule\\Views\\OrderRibbonView.xaml.cs:line 26\r\n  InnerException: System.IO.FileNotFoundException\r\n       Message=Could not load file or assembly 'Microsoft.Windows.Shell, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The system cannot find the file specified.\r\n       Source=mscorlib\r\n       FileName=Microsoft.Windows.Shell, PublicKeyToken=31bf3856ad364e35\r\n       FusionLog==== Pre-bind state information ===\r\nLOG: User = STUG\\thj\r\nLOG: DisplayName = Microsoft.Windows.Shell, PublicKeyToken=31bf3856ad364e35\r\n (Partial)\r\nWRN: Partial binding information was supplied for an assembly:\r\nWRN: Assembly Name: Microsoft.Windows.Shell, PublicKeyToken=31bf3856ad364e35 | Domain ID: 1\r\nWRN: A partial bind occurs when only part of the assembly display name is provided.\r\nWRN: This might result in the binder loading an incorrect assembly.\r\nWRN: It is recommended to provide a fully specified textual identity for the assembly,\r\nWRN: that consists of the simple name, version, culture, and public key token.\r\nWRN: See whitepaper http://go.microsoft.com/fwlink/?LinkId=109270 for more information and common solutions to this issue.\r\nLOG: Appbase = file:///C:/Users/thj/Workspace/Presentation.Ams/bin/Debug/\r\nLOG: Initial PrivatePath = NULL\r\nCalling assembly : PresentationFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35.\r\n===\r\nLOG: This bind starts in default load context.\r\nLOG: Using application configuration file: C:\\Users\\thj\\Workspace\\Presentation.Ams\\bin\\Debug\\Ams.vshost.exe.Config\r\nLOG: Using host configuration file: \r\nLOG: Using machine configuration file from C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\config\\machine.config.\r\nLOG: Policy not being applied to reference at this time (private, custom, partial, or location-based assembly bind).\r\nLOG: Attempting download of new URL file:///C:/Users/thj/Workspace/Presentation.Ams/bin/Debug/Microsoft.Windows.Shell.DLL.\r\nLOG: Attempting download of new URL file:///C:/Users/thj/Workspace/Presentation.Ams/bin/Debug/Microsoft.Windows.Shell/Microsoft.Windows.Shell.DLL.\r\nLOG: Attempting download of new URL file:///C:/Users/thj/Workspace/Presentation.Ams/bin/Debug/Microsoft.Windows.Shell.EXE.\r\nLOG: Attempting download of new URL file:///C:/Users/thj/Workspace/Presentation.Ams/bin/Debug/Microsoft.Windows.Shell/Microsoft.Windows.Shell.EXE.\r\n\r\n       StackTrace:\r\n            at System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark&amp; stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)\r\n            at System.Reflection.RuntimeAssembly.nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark&amp; stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)\r\n            at System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark&amp; stackMark, Boolean forIntrospection, Boolean suppressSecurityChecks)\r\n            at System.Reflection.Assembly.Load(AssemblyName assemblyRef)\r\n            at System.Windows.Baml2006.Baml2006SchemaContext.ResolveAssembly(BamlAssembly bamlAssembly)\r\n            at System.Windows.Baml2006.Baml2006SchemaContext.ResolveBamlTypeToType(BamlType bamlType)\r\n            at System.Windows.Baml2006.Baml2006SchemaContext.ResolveBamlType(BamlType bamlType, Int16 typeId)\r\n            at System.Windows.Baml2006.Baml2006SchemaContext.GetXamlType(Int16 typeId)\r\n            at System.Windows.Baml2006.Baml2006SchemaContext.GetPropertyDeclaringType(Int16 propertyId)\r\n            at System.Windows.Baml2006.Baml2006Reader.GetStaticExtensionValue(Int16 valueId, Type&amp; memberType, Object&amp; providedValue)\r\n            at System.Windows.Baml2006.Baml2006Reader.Process_PropertyWithExtension()\r\n            at System.Windows.Baml2006.Baml2006Reader.Process_OneBamlRecord()\r\n            at System.Windows.Baml2006.Baml2006Reader.ReadObject(KeyRecord record)\r\n            at System.Windows.ResourceDictionary.CreateObject(KeyRecord key)\r\n            at System.Windows.ResourceDictionary.RealizeDeferContent(Object key, Object&amp; value, Boolean&amp; canCache)\r\n            at System.Windows.ResourceDictionary.GetValueWithoutLock(Object key, Boolean&amp; canCache)\r\n            at System.Windows.ResourceDictionary.GetValue(Object key, Boolean&amp; canCache)\r\n            at System.Windows.ResourceDictionary.FetchResource(Object resourceKey, Boolean allowDeferredResourceReference, Boolean mustReturnDeferredResourceReference, Boolean&amp; canCache)\r\n            at System.Windows.SystemResources.LookupResourceInDictionary(ResourceDictionary dictionary, Object key, Boolean allowDeferredResourceReference, Boolean mustReturnDeferredResourceReference, Boolean&amp; canCache)\r\n            at System.Windows.SystemResources.FindDictionaryResource(Object key, Type typeKey, ResourceKey resourceKey, Boolean isTraceEnabled, Boolean allowDeferredResourceReference, Boolean mustReturnDeferredResourceReference, Boolean&amp; canCache)\r\n            at System.Windows.SystemResources.FindResourceInternal(Object key, Boolean allowDeferredResourceReference, Boolean mustReturnDeferredResourceReference)\r\n            at System.Windows.SystemResources.FindResourceInternal(Object key)\r\n            at System.Windows.StyleHelper.GetThemeStyle(FrameworkElement fe, FrameworkContentElement fce)\r\n            at System.Windows.FrameworkElement.UpdateThemeStyleProperty()\r\n            at System.Windows.FrameworkElement.OnInitialized(EventArgs e)\r\n            at System.Windows.Controls.Menu.OnInitialized(EventArgs e)\r\n            at System.Windows.FrameworkElement.TryFireInitialized()\r\n            at System.Windows.FrameworkElement.EndInit()\r\n            at System.Windows.Controls.ItemsControl.EndInit()\r\n            at MS.Internal.Xaml.Runtime.ClrObjectRuntime.InitializationGuard(XamlType xamlType, Object obj, Boolean begin)\r\n       InnerException: \r\n</pre>\r\n",
    "PostedDate": "2011-03-18T03:10:09.687-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "582529",
    "ThreadId": "250234",
    "Html": "<p>Right after posting the question, I solved the problem...</p>\r\n<p>I still have a question though. What solved my problem was installing the \"Microsoft Ribbon for WPF.msi\" package found at MS Downloads. Before that all I had was the reference to the RibbonControlsLibrary. Now if I need to deploy this project to client computers, will they all have to install this package aswell, or can I include additional binaries in my project?</p>",
    "PostedDate": "2011-03-18T03:22:57.44-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "597601",
    "ThreadId": "250234",
    "Html": "<p>Hi thj,</p>\r\n<p>Were you able to find an answer to your question?</p>",
    "PostedDate": "2011-04-14T17:53:54.567-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "597602",
    "ThreadId": "250234",
    "Html": "<p>Its kind of urgent for me, so if you did, please do reply back</p>",
    "PostedDate": "2011-04-14T17:54:22.213-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "597739",
    "ThreadId": "250234",
    "Html": "<p>Hi abhiplex,</p>\r\n<p>No, unfortunately not. Installing \"Microsoft Ribbon for WPF.msi\" solved my problem, but I'm still wondering why.</p>",
    "PostedDate": "2011-04-15T00:45:29.773-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "621454",
    "ThreadId": "250234",
    "Html": "<p>I am having a similar issue and it is related to the version of Microsoft.Windows.Shell referenced by the project. The version of the RibbonControls.dll is trying to find is 3.5.41019.1 which is not what I have. There is a bug entered on Microsoft Connect for this: <a href=\"https://connect.microsoft.com/VisualStudio/feedback/details/642180/ribboncontrolslibrary-dll-for-net-4-0-should-use-the-frameworks-microsoft-windows-shell-instead-of-the-wpf-shell-integration-library\">https://connect.microsoft.com/VisualStudio/feedback/details/642180/ribboncontrolslibrary-dll-for-net-4-0-should-use-the-frameworks-microsoft-windows-shell-instead-of-the-wpf-shell-integration-library</a>&nbsp;</p>",
    "PostedDate": "2011-06-01T08:52:29.233-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "835102",
    "ThreadId": "250234",
    "Html": "<p>I also got the error, because i reinstalled my pc and didn't install the WPF Ribbon 4.0 from Microsoft. After install I needed to remove/add reference again, before my program would run.<br /> <br /> Fixing the problem in 4.5 isn't going to solve my problem, so I'm adding the Microsoft.Windows.Shell Reference to my project.</p>",
    "PostedDate": "2012-05-11T06:08:39.573-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]