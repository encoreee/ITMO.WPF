[
  {
    "Id": "242008",
    "ThreadId": "70985",
    "Html": "<p><span style=\"font-size:8pt;color:black\">Hello </span></p>\r\n<p><span style=\"font-size:8pt;color:black\">I have been trying to create an MVVM for 3 data grids that show related content as in tree related tables in a typed dataset. In code I had it working as simple as this</span></p>\r\n<p><span style=\"font-size:8pt;color:black\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BuyClientCustomDset.ClientRow buyClientRow = (BuyClientCustomDset.ClientRow)((TreeViewItem)e.OriginalSource).Tag;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Master<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Data.DataView gridDataView = new System.Data.DataView(this.viewModel.buyDset.ContributionPhone);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gridDataView.RowFilter = &quot;ClientId=&quot; + buyClientRow.ClientId;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.myMasterDataGrid.ItemsSource = gridDataView;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.myMasterDataGrid.ToolTip = &quot;Contribution Phones for client: &quot; + buyClientRow.ClientName;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Detail<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Binding b = new Binding();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; b.Source = gridDataView;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; b.Path = new PropertyPath(&quot;FK_CreativeReel_ContributionPhone&quot;);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.myDetailDataGrid.SetBinding(DataGrid.ItemsSourceProperty, b);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.myDetailDataGrid.ToolTip = &quot;Creative Reels with contribution client contribution phone selected above&quot;;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Detail detail<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Binding c = new Binding();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c.Source = gridDataView;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c.Path = new PropertyPath(&quot;FK_CreativeReel_ContributionPhone/FK_CreativeReelDelivery_CreativeReel&quot;);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.myDetailDetailDataGrid.SetBinding(DataGrid.ItemsSourceProperty, c);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.myDetailDetailDataGrid.ToolTip = &quot;Creative Reels Deliveries for creative selected above&quot;;</span></p>\r\n<p><span style=\"font-size:8pt;color:black\">This works like a charm.</span></p>\r\n<p><span style=\"font-size:8pt;color:black\">But I want to utilize a model-view-view model where the&nbsp;Property path (shown above) is not hardcoded but instead it is&nbsp;dynamically set according to the relationship of the following tables in the hierarchy, tables contained in a typed dataset that has many many tables. I would like to bind the related tables to three datagrid controls declared in the xaml file in such a way that: &nbsp;when I select another dataset&nbsp;path in the Tree-view control (also declared in the xaml file and also bound to the same typed dataset), the three data-grid controls in the right hand side of window will get properly populated with the selection and its children tables. Also when you select any row in any of the data-grid controls the children data-grid controls will be populated according to the relationship of the selection. It Seems easy in the code above but with the MVVM pattern I have tried many different ways without success, any help on how to set this up will be greatly appreciated. </span></p>\r\n<p><span style=\"font-size:8pt;color:black\">I have look into simpler examples with hardcoded binding paths, master-detail data-grids, etc. and they all work, it is only when I reach this level of complexity: &nbsp;multiple related tables (more than 5) in a typed dataset, a tree-view with more than three levels, and more than two data-grids in a &ldquo;Master, detail, and detail-detail&rdquo; fashion. &nbsp;So it will be greatly appreciated if in your answer, or link reference you address this level of complexity.</span></p>\r\n<p><span style=\"font-size:8pt;color:black\">Thank you in advance</span></p>\r\n<p><span style=\"font-size:8pt;color:black\">Cordially,</span></p>\r\n<p><span style=\"font-size:8pt;color:black\">Luis</span></p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-10-04T20:53:52.673-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]