[
  {
    "Id": "559511",
    "ThreadId": "244350",
    "Html": "\r\n<p>Hi,</p>\r\n<p>I am developping a WPF Sharepoint 2010 client&nbsp; windows application.</p>\r\n<p>I need to have a datagrid to display the content of a Document Library based on the DefaultView.</p>\r\n<p>For now, I manage to have the datagrid columns dynamically generated from the ViewFields collection from the DefaultView:</p>\r\n<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>                grid.ItemsSource = <span style=\"color:blue\">null</span>;\r\n                grid.Items.Clear();\r\n                grid.Columns.Clear();\r\n                List oList = SPWeb.Lists.GetById(docLib);\r\n                SPCtx.Load(oList);\r\n                SPCtx.Load(oList.Views);\r\n                SPCtx.ExecuteQuery();\r\n                <span style=\"color:blue\">int</span> viewIndex = 0;\r\n                Guid guidVue = Guid.Empty;\r\n                <span style=\"color:blue\">foreach</span> (View vue <span style=\"color:blue\">in</span> oList.Views)\r\n                {\r\n                    <span style=\"color:blue\">if</span> (vue.DefaultView)\r\n                    {\r\n                        guidVue = vue.Id;\r\n                    }\r\n                    viewIndex&#43;&#43;;\r\n                }\r\n                View defView = oList.GetView(guidVue);\r\n                SPCtx.Load(oList.GetView(guidVue));\r\n                SPCtx.ExecuteQuery();\r\n                \r\n                ViewFieldCollection viewFields = defView.ViewFields;\r\n                SPCtx.Load(viewFields);\r\n                SPCtx.ExecuteQuery();\r\n                List&lt;<span style=\"color:blue\">string</span>&gt; champs = <span style=\"color:blue\">new</span> List&lt;<span style=\"color:blue\">string</span>&gt;();\r\n                DataGridHyperlinkColumn hlID = <span style=\"color:blue\">new</span> DataGridHyperlinkColumn();\r\n                hlID.Header = <span style=\"color:#a31515\">&quot;ID&quot;</span>;\r\n                hlID.Binding = <span style=\"color:blue\">new</span> Binding(<span style=\"color:#a31515\">&quot;ID&quot;</span>);\r\n                grid.Columns.Add(hlID);\r\n                <span style=\"color:blue\">foreach</span> (<span style=\"color:blue\">string</span> fld <span style=\"color:blue\">in</span> viewFields)\r\n                {\r\n                    champs.Add(fld);\r\n                    grid.Columns.Add(CreateColumn(fld));\r\n                 }\r\n                ListItemCollection itemCollection = oList.GetItems(<span style=\"color:blue\">new</span> CamlQuery { ViewXml = <span style=\"color:#a31515\">&quot;&lt;View /&gt;&quot;</span> });   \r\n                SPCtx.Load(itemCollection);<span style=\"color:green\">//, items =&gt; items.Include(item =&gt; item[&quot;Title&quot;]));   </span>\r\n                SPCtx.ExecuteQuery();\r\n                <span style=\"color:blue\">foreach</span> (ListItem listItem <span style=\"color:blue\">in</span> itemCollection)\r\n                {\r\n                    <span style=\"color:blue\">var</span> row = <span style=\"color:blue\">new</span> DataGridRow();\r\n                    row.Item = GetString(listItem.FieldValues[<span style=\"color:#a31515\">&quot;ID&quot;</span>]);\r\n                    row.Header = <span style=\"color:#a31515\">&quot;id&quot;</span>;\r\n                    <span style=\"color:blue\">var</span> cell = <span style=\"color:blue\">new</span> DataGridCell();\r\n                    \r\n                    grid.Items.Add(row); \r\n                }\r\n\r\n</pre>\r\n</div>\r\n<p>Last 10 lines don't work...</p>\r\n<p>I can't find the way to populate the datagrid's rows...</p>\r\n<p>Is there a way with ItemsSource or whatever?</p>\r\n<p>Thanks for your help</p>\r\n",
    "PostedDate": "2011-02-02T09:06:53.93-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]