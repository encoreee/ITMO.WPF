[
  {
    "Id": "489683",
    "ThreadId": "226198",
    "Html": "<p>hi all,</p>\r\n<p>i have a requirement to change the permission of&nbsp; group &nbsp;(windows\\users) &nbsp;to full control using C# to some set of application folder.</p>\r\n<p>i mean, if u right click on any folder properties, in security tab, u have Users Group.</p>\r\n<p>for this i need to give full control permission programatically.</p>\r\n<p>&nbsp;<span style=\"font-size:x-small\"><font size=2>\r\n<p>&nbsp;</p>\r\n</font><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">List</span></span><span style=\"font-size:x-small\">&lt;</span><span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">string</span></span><span style=\"font-size:x-small\">&gt; users = </span><span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">new</span></span><span style=\"font-size:x-small\"> </span><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">List</span></span><span style=\"font-size:x-small\">&lt;</span><span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">string</span></span><font size=2>&gt;();</font></span></p>\r\n<span style=\"font-size:x-small\"><font size=2>\r\n<p>&nbsp;</p>\r\n</font><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">SelectQuery</span></span><span style=\"font-size:x-small\"> Squery = </span><span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">new</span></span><span style=\"font-size:x-small\"> </span><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">SelectQuery</span></span><span style=\"font-size:x-small\">(</span><span style=\"color:#a31515;font-size:x-small\"><span style=\"color:#a31515;font-size:x-small\">&quot;Win32_Group&quot;</span></span><span style=\"font-size:x-small\">, </span><span style=\"color:#a31515;font-size:x-small\"><span style=\"color:#a31515;font-size:x-small\">&quot;Domain='&quot;</span></span><span style=\"font-size:x-small\"> + System.</span><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">Environment</span></span><span style=\"font-size:x-small\">.MachineName.ToString() + </span><span style=\"color:#a31515;font-size:x-small\"><span style=\"color:#a31515;font-size:x-small\">&quot;'&quot;</span></span><font size=2>);</font></span><span style=\"font-size:x-small\"><font size=2>\r\n<p>&nbsp;</p>\r\n</font><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">ManagementObjectSearcher</span></span><span style=\"font-size:x-small\"> mos = </span><span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">new</span></span><span style=\"font-size:x-small\"> </span><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">ManagementObjectSearcher</span></span><font size=2>(Squery);</font></span><span style=\"font-size:x-small\"><font size=2>\r\n<p>&nbsp;</p>\r\n</font><span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">foreach</span></span><span style=\"font-size:x-small\"> (</span><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">ManagementObject</span></span><span style=\"font-size:x-small\"> mobj </span><span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">in</span></span><font size=2> mos.Get())</font></span><span style=\"font-size:x-small\">\r\n<p>{</p>\r\n<font size=2>\r\n<p>comboBox1.Items.Add(mobj[</p>\r\n</font><span style=\"color:#a31515;font-size:x-small\"><span style=\"color:#a31515;font-size:x-small\">&quot;Name&quot;</span></span><font size=2>].ToString());</font></span><span style=\"font-size:x-small\"><font size=2>\r\n<p>users.Add(mobj[</p>\r\n</font><span style=\"color:#a31515;font-size:x-small\"><span style=\"color:#a31515;font-size:x-small\">&quot;Name&quot;</span></span><font size=2>].ToString()); </font></span><span style=\"font-size:x-small\">\r\n<p>}</p>\r\n<p>&nbsp;</p>\r\n<font size=2>\r\n<p>&nbsp;</p>\r\n</font><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">FileStream</span></span><span style=\"font-size:x-small\"> fs = </span><span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">new</span></span><span style=\"font-size:x-small\"> </span><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">FileStream</span></span><span style=\"font-size:x-small\">(</span><span style=\"color:#a31515;font-size:x-small\"><span style=\"color:#a31515;font-size:x-small\">&quot;FolderPath.txt&quot;</span></span><span style=\"font-size:x-small\">, </span><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">FileMode</span></span><span style=\"font-size:x-small\">.Open, </span><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">FileAccess</span></span><font size=2>.Read);</font></span><span style=\"font-size:x-small\"><font size=2>\r\n<p>&nbsp;</p>\r\n</font><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">StreamReader</span></span><span style=\"font-size:x-small\"> reader = </span><span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">new</span></span><span style=\"font-size:x-small\"> </span><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">StreamReader</span></span><font size=2>(fs);</font></span><span style=\"font-size:x-small\"><font size=2>\r\n<p>&nbsp;</p>\r\n</font><span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">while</span></span><span style=\"font-size:x-small\"> ((strFolderpath = reader.ReadLine()) != </span><span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">null</span></span><font size=2>)</font></span><span style=\"font-size:x-small\">\r\n<p>{</p>\r\n<font size=2>\r\n<p>&nbsp;</p>\r\n</font><span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">for</span></span><span style=\"font-size:x-small\"> (</span><span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">int</span></span><font size=2> i = 0; i &lt; users.Count(); i++)</font></span><span style=\"font-size:x-small\">\r\n<p>{</p>\r\n<font size=2>\r\n<p>&nbsp;</p>\r\n</font><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">DirectoryInfo</span></span><span style=\"font-size:x-small\"> myDirectoryinfo = </span><span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">new</span></span><span style=\"font-size:x-small\"> </span><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">DirectoryInfo</span></span><font size=2>(strFolderpath.ToString());</font></span><span style=\"font-size:x-small\"><font size=2>\r\n<p>&nbsp;</p>\r\n</font><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">DirectorySecurity</span></span><font size=2> mydirectorySec = myDirectoryinfo.GetAccessControl();</font></span><span style=\"font-size:x-small\"><font size=2>\r\n<p>&nbsp;</p>\r\n</font><span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">string</span></span><span style=\"font-size:x-small\"> user = System.</span><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">Environment</span></span><span style=\"font-size:x-small\">.MachineName + </span><span style=\"color:#a31515;font-size:x-small\"><span style=\"color:#a31515;font-size:x-small\">'\\\\'</span></span><font size=2> + users[i].ToString();</font></span><span style=\"font-size:x-small\"><font size=2>\r\n<p>mydirectorySec.AddAccessRule(</p>\r\n</font><span style=\"color:#0000ff;font-size:x-small\"><span style=\"color:#0000ff;font-size:x-small\">new</span></span><span style=\"font-size:x-small\"> </span><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">FileSystemAccessRule</span></span><span style=\"font-size:x-small\">(user, </span><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">FileSystemRights</span></span><span style=\"font-size:x-small\">.FullControl, </span><span style=\"color:#2b91af;font-size:x-small\"><span style=\"color:#2b91af;font-size:x-small\">AccessControlType</span></span><font size=2>.Allow));</font></span><span style=\"font-size:x-small\">\r\n<p>myDirectoryinfo.SetAccessControl(mydirectorySec);</p>\r\n<p>}</p>\r\n<p>}</p>\r\n<p><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\">﻿</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>trying to do like this but i think we cannot pass user group, may be we need to pass user name.</p>\r\n<p><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\">﻿need solution.</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>\r\n<p><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\">please help.</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>\r\n<p><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\">thank you.﻿</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>\r\n<p><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\">﻿</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>\r\n<p><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\"><span style=\"font-size:x-small\">﻿</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>\r\n</span>\r\n<div id=\"_mcePaste\" style=\"width:1px;height:1px;overflow:hidden;top:0px;left:-10000px\">﻿</div>",
    "PostedDate": "2010-09-06T04:37:56.687-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]