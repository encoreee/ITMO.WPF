[
  {
    "Id": "123174",
    "ThreadId": "37127",
    "Html": "How do I handle a click event on a DataGridColumn (for example, when the user clicks on a DataGridHyperlinkColumn?).&nbsp; I didn't see an event for this on the element.<br>\r\n<br>\r\nThanks.<br>\r\n-Larry<br>\r\n",
    "PostedDate": "2008-10-06T07:19:42.457-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "123369",
    "ThreadId": "37127",
    "Html": "DataGridColumn derives directly from DependencyObject so there is no Click event on a column.&nbsp; There is a click event on a DataGridCell if you want to listen to that.&nbsp; For a DataGridHyperlinkColumn scenario there are a couple of ways to handle this.&nbsp; If you want to use a click event you can do something like the following:<br>\r\n<span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">\r\n<p>&lt;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#a31515\"><span style=\"font-size:13px;color:#a31515\">dg</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">:</span></span><span style=\"font-size:13px;color:#a31515\"><span style=\"font-size:13px;color:#a31515\">DataGridHyperlinkColumn</span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">&nbsp;</span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">Header</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=&quot;Homepage&quot;</span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\"> CanUserSort</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=&quot;False&quot;</span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\"> DataFieldBinding</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=&quot;{</span></span><span style=\"font-size:13px;color:#a31515\"><span style=\"font-size:13px;color:#a31515\">Binding</span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\"> Path</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=Homepage}&quot;&gt;<br>\r\n</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span></span><span style=\"font-size:13px;color:#a31515\"><span style=\"font-size:13px;color:#a31515\">dg</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">:</span></span><span style=\"font-size:13px;color:#a31515\"><span style=\"font-size:13px;color:#a31515\">DataGridHyperlinkColumn.ElementStyle</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span></span><span style=\"font-size:13px;color:#a31515\"><span style=\"font-size:13px;color:#a31515\">Style</span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\"> TargetType</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=&quot;TextBlock&quot;&gt;<br>\r\n</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span></span><span style=\"font-size:13px;color:#a31515\"><span style=\"font-size:13px;color:#a31515\">EventSetter</span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\"> Event</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=&quot;Hyperlink.Click&quot;</span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\"> Handler</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=&quot;OnHyperlinkClick&quot; /&gt;<br>\r\n</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span></span><span style=\"font-size:13px;color:#a31515\"><span style=\"font-size:13px;color:#a31515\">Style</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</span></span><span style=\"font-size:13px;color:#a31515\"><span style=\"font-size:13px;color:#a31515\">dg</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">:</span></span><span style=\"font-size:13px;color:#a31515\"><span style=\"font-size:13px;color:#a31515\">DataGridHyperlinkColumn.ElementStyle</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">&lt;/</span></span><span style=\"font-size:13px;color:#a31515\"><span style=\"font-size:13px;color:#a31515\">dg</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">:</span></span><span style=\"font-size:13px;color:#a31515\"><span style=\"font-size:13px;color:#a31515\">DataGridHyperlinkColumn</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">&gt;</span></span><br>\r\n<br>\r\n<span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">private</span></span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">void</span></span><span style=\"font-size:13px\"> OnHyperlinkClick(</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">object</span></span><span style=\"font-size:13px\"> sender, </span><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">RoutedEventArgs</span></span><span style=\"font-size:13px\"> e)<br>\r\n{<br>\r\n</span><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">&nbsp;&nbsp;&nbsp;&nbsp;Process</span></span><span style=\"font-size:13px\">.Start((e.Source </span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">as</span></span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">Hyperlink</span></span><span style=\"font-size:13px\">).NavigateUri.ToString());<br>\r\n}</span><br>\r\n<br>\r\nAnother way to handle it is&nbsp;to put the DataGrid in a NavigationWindow, then the hyperlink should work automatically.</p>\r\n",
    "PostedDate": "2008-10-06T18:30:53.407-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "123543",
    "ThreadId": "37127",
    "Html": "Thanks, this worked great!&nbsp; But would you mind explaining what's going on under the covers?&nbsp; I assume TextBlock is part of the DataGridHyperlinkColumn's visual tree, but I'm not understanding why the style has to target that.&nbsp; Couldn't the style just target the Hyperlink and set its click event?<br>\r\n<br>\r\n-Larry<br>\r\n",
    "PostedDate": "2008-10-07T11:16:13.06-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "123569",
    "ThreadId": "37127",
    "Html": "Each column has an ElementStyle and EditingElementStyle where you have access to set properties on the visual tree in both editing states.&nbsp; The stock columns (text, checkbox, combobox, hyperlink) each have a hard coded visual element for each state.&nbsp; For the hyperlink column the element in the non-editing state is a TextBlock (which wraps a hyperlink).&nbsp; So the style that you set on the ElementStyle for a DataGridHyperlinkColumn has to be a TextBlock.&nbsp; The fact that Hyperlink.Click is a routed event is very helpful in this situation.\r\n",
    "PostedDate": "2008-10-07T13:03:55.773-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "123574",
    "ThreadId": "37127",
    "Html": "Makes sense.&nbsp; Thanks for the explanation!<br>\r\n",
    "PostedDate": "2008-10-07T13:15:23.927-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "129961",
    "ThreadId": "37127",
    "Html": "<p>I've inherited DataGrid and placed my xaml styles etc in a file which I access via a ResourceDictionary. If I add a style into that xaml file it says it can't find the handler &quot;OnHyperlinkClick&quot;, which is correct because I don't have any code behind that class. So I created a xaml file for my inherited class which looks like this:-<br>\r\n<br>\r\n&lt;dg:DataGrid x:Class=&quot;SPF.Client.WPF.EnhancedDataGrid&quot;<br>\r\n    xmlns=&quot;<a href=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\">http://schemas.microsoft.com/winfx/2006/xaml/presentation</a>&quot;<br>\r\n    xmlns:x=&quot;<a href=\"http://schemas.microsoft.com/winfx/2006/xaml\">http://schemas.microsoft.com/winfx/2006/xaml</a>&quot;<br>\r\n    xmlns:dg=&quot;clr-namespace:SPF.Client.WPF.Controls;assembly=SPFClientWPFBase&quot;<br>\r\n    xmlns:sys=&quot;clr-namespace:System;assembly=mscorlib&quot;<br>\r\n    xmlns:col=&quot;clr-namespace:System.Collections;assembly=mscorlib&quot;<br>\r\n    xmlns:cm=&quot;clr-namespace:System.ComponentModel;assembly=WindowsBase&quot;<br>\r\n    xmlns:local=&quot;clr-namespace:SPF.Client.WPF&quot;        <br>\r\n    &gt;<br>\r\n    &lt;dg:DataGrid.Resources&gt;<br>\r\n            &lt;Style x:Key=&quot;SPFDataGridHyperlinkStyle&quot; TargetType=&quot;TextBlock&quot;&gt;<br>\r\n                &lt;EventSetter Event=&quot;Hyperlink.Click&quot; Handler=&quot;OnHyperlinkClicked&quot; /&gt;<br>\r\n            &lt;/Style&gt;<br>\r\n    &lt;/dg:DataGrid.Resources&gt;<br>\r\n    <br>\r\n&lt;/dg:DataGrid&gt;<br>\r\n<br>\r\nAnd was hoping the following line would work, I've done this by trapping OnAutoGeneratingColumn which creates the DataGridHyperLinkColumn <span style=\"font-size:13px;color:#008000\"><span style=\"font-size:13px;color:#008000\">\r\n<p>&nbsp;</p>\r\n<p>CType(lobjColumn, ListEditHyperlinkColumn).ElementStyle = CType(Me.FindResource(&quot;SPFDataGridHyperlinkStyle&quot;), Style)</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>But me.Resources is empty and I can't work out where to add the xaml??<br>\r\n<br>\r\nSo I then tried to create the Style in code:-<br>\r\n<br>\r\n                Dim lobjHyperLinkStyle As New Style(GetType(TextBlock))<br>\r\n                lobjHyperLinkStyle.Setters.Add(New EventSetter(TextBlock.MouseDownEvent, EnhancedGridHyperlinkClick))<br>\r\n                CType(lobjColumn, ListEditHyperlinkColumn).ElementStyle = lobjHyperLinkStyle<br>\r\n<br>\r\nWhich works until I get an exception in DataGridBoundColumn.ApplyStyle line 172 the exception is handlertype is not valid.<br>\r\n<br>\r\nany tips most appreciated.</p>\r\n",
    "PostedDate": "2008-11-04T08:31:23.883-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "130087",
    "ThreadId": "37127",
    "Html": "Instead on &quot;TextBlock.MouseDownEvent&quot;, have you tried &quot;Hyperlink.Click&quot;?\r\n",
    "PostedDate": "2008-11-04T15:45:21.327-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "130092",
    "ThreadId": "37127",
    "Html": "Hi, I actually just got it working using the code below:-<br>\r\n<br>\r\n                'Dim lobjSetter As New System.Windows.EventSetter<br>\r\n                'lobjSetter.Event = System.Windows.Documents.Hyperlink.ClickEvent<br>\r\n                'lobjSetter.Handler = New System.Windows.RoutedEventHandler(AddressOf Me.OnHyperlinkClicked)<br>\r\n                'Dim lobjHyperLinkStyle As New Style(GetType(TextBlock))<br>\r\n                'lobjHyperLinkStyle.Setters.Add(lobjSetter)<br>\r\n                'CType(lobjColumn, ListEditHyperlinkColumn).ElementStyle = lobjHyperLinkStyle<br>\r\n<br>\r\nIn my world I display another window and on clicking ok I then want to update the hyperlink text on the originally clicked cell, I couldn't work out how to do that. I managed to set the text on the textbox but not the hyperlink. Here is my event handler using the above code:-<br>\r\n<br>\r\n        'Public Sub OnHyperLinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.RoutedEventArgs)<br>\r\n        '    Dim lobjTextBlock As TextBlock = TryCast(sender, TextBlock)<br>\r\n        '                    'Dim lobjLink As System.Windows.Documents.Hyperlink = DirectCast(e.OriginalSource, System.Windows.Documents.Hyperlink)<br>\r\n        '                    'lobjLink.TargetName = lobjCellWrapper.ToString<br>\r\n        '                    'lobjLink.Background = New SolidColorBrush(Colors.Yellow)<br>\r\n<br>\r\nAny ideas?\r\n",
    "PostedDate": "2008-11-04T16:45:07.81-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "130195",
    "ThreadId": "37127",
    "Html": "<p>In your OnHyperLinkClicked method, try something like this instead:<br>\r\n<span style=\"font-size:13px;color:#2b91af\"><br>\r\nContentPresenter</span><span style=\"font-size:13px\"> cp = </span><span style=\"font-size:13px;color:#2b91af\">Helper</span><span style=\"font-size:13px\">.GetVisualChild&lt;</span><span style=\"font-size:13px;color:#2b91af\">ContentPresenter</span><span style=\"font-size:13px\">&gt;(sender </span><span style=\"font-size:13px;color:#0000ff\">as</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">Visual</span><span style=\"font-size:13px\">);<br>\r\ncp.Content = &quot;&lt;url string&gt;&quot;</span><span style=\"font-size:13px\">;</span><br>\r\n<br>\r\nWhere GetVisualChild looks like this:<br>\r\n<br>\r\n<span style=\"font-size:13px;color:#0000ff\">public</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">static</span><span style=\"font-size:13px\"> T GetVisualChild&lt;T&gt;(</span><span style=\"font-size:13px;color:#2b91af\">Visual</span><span style=\"font-size:13px\"> parent) </span><span style=\"font-size:13px;color:#0000ff\">where</span><span style=\"font-size:13px\"> T : </span><span style=\"font-size:13px;color:#2b91af\">Visual<br>\r\n</span><span style=\"font-size:13px\">{<br>\r\n    T child = </span><span style=\"font-size:13px;color:#0000ff\">default</span><span style=\"font-size:13px\">(T);<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">    int</span><span style=\"font-size:13px\"> numVisuals = </span><span style=\"font-size:13px;color:#2b91af\">VisualTreeHelper</span><span style=\"font-size:13px\">.GetChildrenCount(parent);<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">    for</span><span style=\"font-size:13px\"> (</span><span style=\"font-size:13px;color:#0000ff\">int</span><span style=\"font-size:13px\"> i = 0; i &lt; numVisuals; i++)<br>\r\n    {<br>\r\n</span><span style=\"font-size:13px;color:#2b91af\">        Visual</span><span style=\"font-size:13px\"> v = (</span><span style=\"font-size:13px;color:#2b91af\">Visual</span><span style=\"font-size:13px\">)</span><span style=\"font-size:13px;color:#2b91af\">VisualTreeHelper</span><span style=\"font-size:13px\">.GetChild(parent, i);<br>\r\n        child = v </span><span style=\"font-size:13px;color:#0000ff\">as</span><span style=\"font-size:13px\"> T;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">        if</span><span style=\"font-size:13px\"> (child == </span><span style=\"font-size:13px;color:#0000ff\">null</span><span style=\"font-size:13px\">)<br>\r\n        {<br>\r\n            child = GetVisualChild&lt;T&gt;(v);<br>\r\n        }<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">        if</span><span style=\"font-size:13px\"> (child != </span><span style=\"font-size:13px;color:#0000ff\">null</span><span style=\"font-size:13px\">)<br>\r\n        {<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">            break</span><span style=\"font-size:13px\">;<br>\r\n        }<br>\r\n    }<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">    return</span><span style=\"font-size:13px\"> child;<br>\r\n}\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p></p>\r\n",
    "PostedDate": "2008-11-05T05:47:02-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "130351",
    "ThreadId": "37127",
    "Html": "Now I've upgraded to V1 of the datagrid the code above which added the handler for the hyperlink click event is now giving an error whilst building the grid.<br>\r\n<br>\r\n'Hyperlink' TargetType does not match type of element 'TextBlock'. in DataGridBoundColumn line 165.<br>\r\n<br>\r\nThis was working yesterday on the CTP version - any ideas?<br>\r\n<br>\r\nAll I've done is inherit from DataGridHyperLinkColumn and set the style in code using:-<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim lobjSetter As New System.Windows.EventSetter<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lobjSetter.Event = System.Windows.Documents.Hyperlink.ClickEvent<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lobjSetter.Handler = New System.Windows.RoutedEventHandler(AddressOf Me.OnHyperlinkClicked)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim lobjHyperLinkStyle As New Style(GetType(System.Windows.Documents.Hyperlink))<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lobjHyperLinkStyle.Setters.Add(lobjSetter)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CType(lobjColumn, ListEditHyperlinkColumn).EditingElementStyle = lobjHyperLinkStyle<br>\r\n<br>\r\n<br>\r\n&nbsp;<br>\r\n",
    "PostedDate": "2008-11-05T15:10:54.99-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "243243",
    "ThreadId": "37127",
    "Html": "<p>&quot;Process<span style=\"font-size:13px\">.Start((e.Source </span><span style=\"color:#0000ff;font-size:13px\"><span style=\"color:#0000ff;font-size:13px\">as</span></span><span style=\"font-size:13px\"> </span><span style=\"color:#2b91af;font-size:13px\"><span style=\"color:#2b91af;font-size:13px\">Hyperlink</span></span><span style=\"font-size:13px\">).NavigateUri.ToString());&quot;<br></span></p>\r\n<p><span style=\"font-size:13px\">&nbsp;</span></p>\r\n<p><span style=\"font-size:13px\">I have tried this and NavigateURI is returning a null value. The datagrid hyperlink column is displaying integers.</span></p>\r\n<p><span style=\"font-size:13px\">So what now??</span></p>\r\n<p><span style=\"font-size:13px\"></span></p>\r\n&nbsp;",
    "PostedDate": "2009-10-07T20:49:19.26-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]