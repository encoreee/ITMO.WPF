[
  {
    "Id": "208947",
    "ThreadId": "61596",
    "Html": "<div>how to find cell related to ContextMenuEventArgs? (if there is any cell related)</div>\r\n<div>my try with</div>\r\n<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Microsoft::Windows::Controls::DataGridCell^ cell = WpfGuiHelpers::FindParent&lt;Microsoft::Windows::Controls::DataGridCell&gt;((Visual^)e-&gt;OriginalSource);<br>fails because OriginalSource (sometimes?)&nbsp;has no Parent (!? how it is possible?)</div>\r\n<div></div>\r\n<div>maybe i can&nbsp;use this-&gt;CurrentCell but i'm not sure it is always correct one</div>\r\n<div>thanks for reply</div>\r\n<div>my source part:</div>\r\n<div>void XGridControl::OnContextMenuOpening(ContextMenuEventArgs^ e)<br>{<br>&nbsp;&nbsp;&nbsp; __super::OnContextMenuOpening(e);</div>\r\n<div>&nbsp;&nbsp;&nbsp; Microsoft::Windows::Controls::Primitives::DataGridColumnHeadersPresenter^ hdr<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = WpfGuiHelpers::FindVisualChild&lt;Microsoft::Windows::Controls::Primitives::DataGridColumnHeadersPresenter&gt;(this);<br>&nbsp;&nbsp;&nbsp; if(hdr)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GeneralTransform^ pTransfWpfElementToWindow = hdr-&gt;TransformToAncestor( this );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Point offsetPoint = pTransfWpfElementToWindow-&gt;Transform( Point(0, 0) );</div>\r\n<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GeneralTransform^ pTransfWpfElementToWindow2 = ((Visual^)e-&gt;OriginalSource)-&gt;TransformToAncestor( this );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Point cursorPoint = pTransfWpfElementToWindow2-&gt;Transform( Point(e-&gt;CursorLeft, e-&gt;CursorTop) );</div>\r\n<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(e-&gt;CursorLeft != -1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; e-&gt;CursorTop != -1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; offsetPoint.X &lt;= cursorPoint.X<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; cursorPoint.X &lt;= (offsetPoint.X + hdr-&gt;ActualWidth)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; offsetPoint.Y &lt;= cursorPoint.Y<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; cursorPoint.Y &lt;= (offsetPoint.Y + hdr-&gt;ActualHeight)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; )<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</div>\r\n<div>//header</div>\r\n<div>...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;</div>\r\n<div>//maybe cell<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Microsoft::Windows::Controls::DataGridCell^ cell = WpfGuiHelpers::FindParent&lt;Microsoft::Windows::Controls::DataGridCell&gt;((Visual^)e-&gt;OriginalSource);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(cell)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</div>\r\n<div>...<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br>}<br></div>",
    "PostedDate": "2009-07-06T07:20:31.23-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]