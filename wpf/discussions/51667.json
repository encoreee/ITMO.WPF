[
  {
    "Id": "173310",
    "ThreadId": "51667",
    "Html": "I get exception when I try to commit <em>empty</em> DataGrid row.\r\n<blockquote>\r\n<p>Exception calling &quot;ShowDialog&quot; with\r\n&quot;0&quot; argument(s): &quot;Object reference not\r\nset to an instance of an object.&quot;</p>\r\n</blockquote>\r\n<p>Steps to reproduce:</p>\r\n<ul>\r\n    <li>Goto &quot;new row&quot;</li>\r\n    <li>Press F2</li>\r\n    <li>Press ENTER</li>\r\n</ul>\r\n<p>This works ok:</p>\r\n<ul>\r\n    <li>Goto &quot;new row&quot;</li>\r\n    <li>Press F2</li>\r\n    <li>Press ESC</li>\r\n</ul>\r\n<p>As well as:</p>\r\n<ul>\r\n    <li>Goto &quot;new row&quot;</li>\r\n    <li>Press F2</li>\r\n    <li>Type &quot;sdfdsf&quot;</li>\r\n    <li>Press ENTER</li>\r\n</ul>\r\nCode is being called from powershell v2,..below is some of the code used:<br>\r\n<br>\r\nadd-type @&quot;<br>\r\n&nbsp;&nbsp;&nbsp; public class Person<br>\r\n&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public Person() {}<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public string First { get; set; }<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public string Last { get; set; }<br>\r\n&nbsp;&nbsp;&nbsp; }<br>\r\n&quot;@ -Language CsharpVersion3<br>\r\n<br>\r\n#Creates an object of a generic type: <br>\r\n$people = New-GenericObject 'System.Collections.Generic.List' @('Person')<br>\r\n$form.Resources[&quot;people&quot;] = $people<br>\r\n<br>\r\n#<br>\r\n$form.ShowDialog() <br>\r\n<br>\r\n<br>\r\n&lt;StackPanel&gt;<br>\r\n&nbsp;&nbsp;&nbsp; &lt;dg:DataGrid ItemsSource=&quot;{DynamicResource people}&quot; CanUserAddRows=&quot;True&quot; AutoGenerateColumns=&quot;False&quot;&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;dg:DataGrid.Columns&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;dg:DataGridTextColumn Header=&quot;First&quot; Binding=&quot;{Binding First}&quot;&gt;&lt;/dg:DataGridTextColumn&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;dg:DataGridTextColumn Header=&quot;Last&quot; Binding=&quot;{Binding Last}&quot;&gt;&lt;/dg:DataGridTextColumn&gt;<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/dg:DataGrid.Columns&gt;<br>\r\n&nbsp;&nbsp;&nbsp; &lt;/dg:DataGrid&gt;<br>\r\n&nbsp; &lt;/StackPanel&gt;<br>\r\n<br>\r\nAny help would be appreciated! \r\n",
    "PostedDate": "2009-03-29T20:24:25.493-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "173500",
    "ThreadId": "51667",
    "Html": "Using Trap does not seem to even catch it...seems the only solution is to never select a value if you don't need it...if blank it will throw an error (and my app crashes). Anyone have a hack or a solution?<br>\r\n<br>\r\nYou can find a link to the sample code here: http://cid-0dba2a6e137e8a9a.skydrive.live.com/self.aspx/Public/demo%7C%5F000.rar\r\n<div style=\"display:none\" id=divCleekiAttrib></div>\r\n<br>\r\n<div style=\"display:none\" id=divCleekiAttrib></div>\r\n<div id=divCleekiAttrib style=\"display:none\"></div>\r\n",
    "PostedDate": "2009-03-30T08:30:13.153-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "173724",
    "ThreadId": "51667",
    "Html": "Some more details..and I found an issue almost the same thing: http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=361723<br>\r\n<br>\r\n<pre><code><span>System</span><span>.</span><span>NullReferenceException</span><span>:</span><span> </span><span>Object</span><span> reference </span><span>not</span><span> </span><span>set</span><span> to an instance of an </span><span>object</span><span>.</span><span><br>&nbsp; &nbsp;at MS</span><span>.</span><span>Internal</span><span>.</span><span>Data</span><span>.</span><span>PropertyPathWorker</span><span>.</span><span>DetermineWhetherDBNullIsValid</span><span>()</span><span><br>&nbsp; &nbsp;at MS</span><span>.</span><span>Internal</span><span>.</span><span>Data</span><span>.</span><span>PropertyPathWorker</span><span>.</span><span>get_IsDBNullValidForUpdate</span><span>()</span><span><br>&nbsp; &nbsp;at MS</span><span>.</span><span>Internal</span><span>.</span><span>Data</span><span>.</span><span>ClrBindingWorker</span><span>.</span><span>get_IsDBNullValidForUpdate</span><span>()</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Data</span><span>.</span><span>BindingExpression</span><span>.</span><span>ConvertProposedValue</span><span>(</span><span>Object</span><span> value</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Data</span><span>.</span><span>BindingExpressionBase</span><span>.</span><span>UpdateValue</span><span>()</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Data</span><span>.</span><span>BindingExpression</span><span>.</span><span>Update</span><span>(</span><span>Boolean</span><span> synchronous</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Data</span><span>.</span><span>BindingExpression</span><span>.</span><span>UpdateSource</span><span>()</span><span><br>&nbsp; &nbsp;at </span><span>Microsoft</span><span>.</span><span>Windows</span><span>.</span><span>Controls</span><span>.</span><span>DataGridHelper</span><span>.</span><span>UpdateSource</span><span>(</span><span>FrameworkElement</span><span> element</span><span>,</span><span> </span><span>DependencyProperty</span><span> dp</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>Microsoft</span><span>.</span><span>Windows</span><span>.</span><span>Controls</span><span>.</span><span>DataGridTextColumn</span><span>.</span><span>CommitCellEdit</span><span>(</span><span>FrameworkElement</span><span> editingElement</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>Microsoft</span><span>.</span><span>Windows</span><span>.</span><span>Controls</span><span>.</span><span>DataGridColumn</span><span>.</span><span>CommitEdit</span><span>(</span><span>FrameworkElement</span><span> editingElement</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>Microsoft</span><span>.</span><span>Windows</span><span>.</span><span>Controls</span><span>.</span><span>DataGridCell</span><span>.</span><span>CommitEdit</span><span>()</span><span><br>&nbsp; &nbsp;at </span><span>Microsoft</span><span>.</span><span>Windows</span><span>.</span><span>Controls</span><span>.</span><span>DataGrid</span><span>.</span><span>OnExecutedCommitEdit</span><span>(</span><span>ExecutedRoutedEventArgs</span><span> e</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>Microsoft</span><span>.</span><span>Windows</span><span>.</span><span>Controls</span><span>.</span><span>DataGrid</span><span>.</span><span>OnExecutedCommitEdit</span><span>(</span><span>Object</span><span> sender</span><span>,</span><span> </span><span>ExecutedRoutedEventArgs</span><span> e</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Input</span><span>.</span><span>CommandBinding</span><span>.</span><span>OnExecuted</span><span>(</span><span>Object</span><span> sender</span><span>,</span><span> </span><span>ExecutedRoutedEventArgs</span><span> e</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Input</span><span>.</span><span>CommandManager</span><span>.</span><span>ExecuteCommandBinding</span><span>(</span><span>Object</span><span> sender</span><span>,</span><span> </span><span>ExecutedRoutedEventArgs</span><span> e</span><span>,</span><span> </span><span>CommandBinding</span><span> commandBinding</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Input</span><span>.</span><span>CommandManager</span><span>.</span><span>FindCommandBinding</span><span>(</span><span>CommandBindingCollection</span><span> commandBindings</span><span>,</span><span> </span><span>Object</span><span> sender</span><span>,</span><span> </span><span>RoutedEventArgs</span><span> e</span><span>,</span><span> </span><span>ICommand</span><span> command</span><span>,</span><span> </span><span>Boolean</span><span> execute</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Input</span><span>.</span><span>CommandManager</span><span>.</span><span>FindCommandBinding</span><span>(</span><span>Object</span><span> sender</span><span>,</span><span> </span><span>RoutedEventArgs</span><span> e</span><span>,</span><span> </span><span>ICommand</span><span> command</span><span>,</span><span> </span><span>Boolean</span><span> execute</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Input</span><span>.</span><span>CommandManager</span><span>.</span><span>OnExecuted</span><span>(</span><span>Object</span><span> sender</span><span>,</span><span> </span><span>ExecutedRoutedEventArgs</span><span> e</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>UIElement</span><span>.</span><span>OnExecutedThunk</span><span>(</span><span>Object</span><span> sender</span><span>,</span><span> </span><span>ExecutedRoutedEventArgs</span><span> e</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Input</span><span>.</span><span>ExecutedRoutedEventArgs</span><span>.</span><span>InvokeEventHandler</span><span>(</span><span>Delegate</span><span> genericHandler</span><span>,</span><span> </span><span>Object</span><span> target</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>RoutedEventArgs</span><span>.</span><span>InvokeHandler</span><span>(</span><span>Delegate</span><span> handler</span><span>,</span><span> </span><span>Object</span><span> target</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>RoutedEventHandlerInfo</span><span>.</span><span>InvokeHandler</span><span>(</span><span>Object</span><span> target</span><span>,</span><span> </span><span>RoutedEventArgs</span><span> routedEventArgs</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>EventRoute</span><span>.</span><span>InvokeHandlersImpl</span><span>(</span><span>Object</span><span> source</span><span>,</span><span> </span><span>RoutedEventArgs</span><span> args</span><span>,</span><span> </span><span>Boolean</span><span> reRaised</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>UIElement</span><span>.</span><span>RaiseEventImpl</span><span>(</span><span>DependencyObject</span><span> sender</span><span>,</span><span> </span><span>RoutedEventArgs</span><span> args</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>UIElement</span><span>.</span><span>RaiseEvent</span><span>(</span><span>RoutedEventArgs</span><span> args</span><span>,</span><span> </span><span>Boolean</span><span> trusted</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Input</span><span>.</span><span>RoutedCommand</span><span>.</span><span>ExecuteImpl</span><span>(</span><span>Object</span><span> parameter</span><span>,</span><span> </span><span>IInputElement</span><span> target</span><span>,</span><span> </span><span>Boolean</span><span> userInitiated</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Input</span><span>.</span><span>RoutedCommand</span><span>.</span><span>Execute</span><span>(</span><span>Object</span><span> parameter</span><span>,</span><span> </span><span>IInputElement</span><span> target</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>Microsoft</span><span>.</span><span>Windows</span><span>.</span><span>Controls</span><span>.</span><span>DataGrid</span><span>.</span><span>EndEdit</span><span>(</span><span>RoutedCommand</span><span> command</span><span>,</span><span> </span><span>DataGridCell</span><span> cellContainer</span><span>,</span><span> </span><span>DataGridEditingUnit</span><span> editingUnit</span><span>,</span><span> </span><span>Boolean</span><span> exitEditMode</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>Microsoft</span><span>.</span><span>Windows</span><span>.</span><span>Controls</span><span>.</span><span>DataGrid</span><span>.</span><span>CommitEdit</span><span>(</span><span>DataGridEditingUnit</span><span> editingUnit</span><span>,</span><span> </span><span>Boolean</span><span> exitEditingMode</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>Microsoft</span><span>.</span><span>Windows</span><span>.</span><span>Controls</span><span>.</span><span>DataGrid</span><span>.</span><span>CommitAnyEdit</span><span>()</span><span><br>&nbsp; &nbsp;at </span><span>Microsoft</span><span>.</span><span>Windows</span><span>.</span><span>Controls</span><span>.</span><span>DataGrid</span><span>.</span><span>OnEnterKeyDown</span><span>(</span><span>KeyEventArgs</span><span> e</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>Microsoft</span><span>.</span><span>Windows</span><span>.</span><span>Controls</span><span>.</span><span>DataGrid</span><span>.</span><span>OnKeyDown</span><span>(</span><span>KeyEventArgs</span><span> e</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>UIElement</span><span>.</span><span>OnKeyDownThunk</span><span>(</span><span>Object</span><span> sender</span><span>,</span><span> </span><span>KeyEventArgs</span><span> e</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Input</span><span>.</span><span>KeyEventArgs</span><span>.</span><span>InvokeEventHandler</span><span>(</span><span>Delegate</span><span> genericHandler</span><span>,</span><span> </span><span>Object</span><span> genericTarget</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>RoutedEventArgs</span><span>.</span><span>InvokeHandler</span><span>(</span><span>Delegate</span><span> handler</span><span>,</span><span> </span><span>Object</span><span> target</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>RoutedEventHandlerInfo</span><span>.</span><span>InvokeHandler</span><span>(</span><span>Object</span><span> target</span><span>,</span><span> </span><span>RoutedEventArgs</span><span> routedEventArgs</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>EventRoute</span><span>.</span><span>InvokeHandlersImpl</span><span>(</span><span>Object</span><span> source</span><span>,</span><span> </span><span>RoutedEventArgs</span><span> args</span><span>,</span><span> </span><span>Boolean</span><span> reRaised</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>UIElement</span><span>.</span><span>RaiseEventImpl</span><span>(</span><span>DependencyObject</span><span> sender</span><span>,</span><span> </span><span>RoutedEventArgs</span><span> args</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>UIElement</span><span>.</span><span>RaiseEvent</span><span>(</span><span>RoutedEventArgs</span><span> args</span><span>,</span><span> </span><span>Boolean</span><span> trusted</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Input</span><span>.</span><span>InputManager</span><span>.</span><span>ProcessStagingArea</span><span>()</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Input</span><span>.</span><span>InputManager</span><span>.</span><span>ProcessInput</span><span>(</span><span>InputEventArgs</span><span> input</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Input</span><span>.</span><span>InputProviderSite</span><span>.</span><span>ReportInput</span><span>(</span><span>InputReport</span><span> inputReport</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Interop</span><span>.</span><span>HwndKeyboardInputProvider</span><span>.</span><span>ReportInput</span><span>(</span><span>IntPtr</span><span> hwnd</span><span>,</span><span> </span><span>InputMode</span><span> mode</span><span>,</span><span> Int32 timestamp</span><span>,</span><span> </span><span>RawKeyboardActions</span><span> actions</span><span>,</span><span> Int32 scanCode</span><span>,</span><span> </span><span>Boolean</span><span> isExtendedKey</span><span>,</span><span> </span><span>Boolean</span><span> isSystemKey</span><span>,</span><span> Int32 virtualKey</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Interop</span><span>.</span><span>HwndKeyboardInputProvider</span><span>.</span><span>ProcessKeyAction</span><span>(</span><span>MSG</span><span>&amp;</span><span> msg</span><span>,</span><span> </span><span>Boolean</span><span>&amp;</span><span> handled</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Interop</span><span>.</span><span>HwndSource</span><span>.</span><span>CriticalTranslateAccelerator</span><span>(</span><span>MSG</span><span>&amp;</span><span> msg</span><span>,</span><span> </span><span>ModifierKeys</span><span> modifiers</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Interop</span><span>.</span><span>HwndSource</span><span>.</span><span>OnPreprocessMessage</span><span>(</span><span>Object</span><span> param</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Threading</span><span>.</span><span>ExceptionWrapper</span><span>.</span><span>InternalRealCall</span><span>(</span><span>Delegate</span><span> callback</span><span>,</span><span> </span><span>Object</span><span> args</span><span>,</span><span> </span><span>Boolean</span><span> isSingleParameter</span><span>)</span><span><br>&nbsp; &nbsp;at </span><span>System</span><span>.</span><span>Windows</span><span>.</span><span>Threading</span><span>.</span><span>ExceptionWrapper</span><span>.</span><span>TryCatchWhen</span><span>(</span><span>Object</span><span> source</span><span>,</span><span> </span><span>Delegate</span><span> callback</span><span>,</span><span> </span><span>Object</span><span> args</span><span>,</span><span> </span><span>Boolean</span><span> isSingleParameter</span><span>,</span><span> </span><span>Delegate</span><span> catchHandler</span><span>)</span><span><br></span><span>Exception</span><span> calling </span><span>&quot;Run&quot;</span><span> </span><span>with</span><span> </span><span>&quot;1&quot;</span><span> argument</span><span>(</span><span>s</span><span>):</span><span> </span><span>&quot;Object reference not set to an instance of an object.&quot;</span><span><br></span></code></pre>\r\n<br>\r\n",
    "PostedDate": "2009-03-30T20:10:53.127-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]