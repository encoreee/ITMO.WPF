[
  {
    "Id": "477311",
    "ThreadId": "222699",
    "Html": "<p>Hi again all. I wonder if I can pick your brains.</p>\r\n<p>I have a datagrid (From EF) which is actually a View from SQL Server 2005. By clicking on a record in the datagrid I take the user into that record and he/she can make updates via db.savechanges. One thing I do is change a status field which is showing on the datagrid. I am having problems updating the datagrid to reflect any changes made.</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> sendReport()\r\n\r\n    <span style=\"color:blue\">Dim</span> reportSheet <span style=\"color:blue\">As</span> tblReportSheet = <span style=\"color:blue\">Me</span>.ReportData.View.CurrentItem\r\n    <span style=\"color:blue\">Try</span>\r\n      reportSheet.RS_CallStatus = <span style=\"color:#a31515\">&quot;WAIT&quot;</span>\r\n      reportSheet.RS_ActualSent = Now\r\n      dbx.SaveChanges()\r\n\r\n    <span style=\"color:blue\">Catch</span> ex <span style=\"color:blue\">As</span> Exception\r\n      MessageBox.Show(ex.Message &amp; vbCrLf &amp; vbCrLf &amp; ex.Source)\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Try</span>\r\n\r\n  <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n</pre>\r\n<pre>The datagrids itemsource is a CollectionViewSource. Populated like so;</pre>\r\n<pre>\r\n<div style=\"color:black;background-color:white\"><pre><span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> PopulateListOfCalls()\r\n\r\n    <span style=\"color:blue\">Dim</span> status <span style=\"color:blue\">As</span> <span style=\"color:blue\">New</span> List(Of <span style=\"color:blue\">String</span>)\r\n    status.Add(<span style=\"color:#a31515\">&quot;WAIT&quot;</span>)\r\n    status.Add(<span style=\"color:#a31515\">&quot;OPEN&quot;</span>)\r\n    <span style=\"color:blue\">Dim</span> list <span style=\"color:blue\">As</span> IQueryable(Of View_EngineerManage) = <span style=\"color:blue\">From</span> x <span style=\"color:blue\">In</span> dbx.View_EngineerManage <span style=\"color:blue\">Where</span> x.RS_EngineerName = User.User <span style=\"color:blue\">AndAlso</span> status.Contains(x.RS_CallStatus)\r\n    <span style=\"color:green\">'Convert to observable collection so you can filter the list</span>\r\n\r\n    <span style=\"color:blue\">For</span> <span style=\"color:blue\">Each</span> item <span style=\"color:blue\">As</span> View_EngineerManage <span style=\"color:blue\">In</span> list\r\n      obList.Add(item)\r\n    <span style=\"color:blue\">Next</span>\r\n    <span style=\"color:blue\">Me</span>.EngListViewSource = <span style=\"color:blue\">CType</span>(<span style=\"color:blue\">Me</span>.FindResource(<span style=\"color:#a31515\">&quot;DataActiveCalls&quot;</span>), CollectionViewSource)\r\n    EngListViewSource.Source = obList\r\n\r\n  <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n\r\n</pre>\r\n</div>\r\nAny help? Many thanks Scott</pre>\r\n</div>",
    "PostedDate": "2010-08-06T03:17:47.58-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "477385",
    "ThreadId": "222699",
    "Html": "<p>after dbx.SaveChanges()</p>\r\n<p>call EngListViewSource.View.Refresh()</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-08-06T07:38:54.04-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "477389",
    "ThreadId": "222699",
    "Html": "<p>Hi. Thanks for getting back to me. This has not worked. The datagrid remains in the same state.</p>\r\n<p>I also tried it on another peice of code that add one record to a DB and still no joy.</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> butAddNewRemedial_Click(<span style=\"color:blue\">ByVal</span> sender <span style=\"color:blue\">As</span> System.Object, <span style=\"color:blue\">ByVal</span> e <span style=\"color:blue\">As</span> System.Windows.RoutedEventArgs)\r\n        <span style=\"color:blue\">If</span> RemedialWork.View.CurrentPosition = -1 <span style=\"color:blue\">Then</span>\r\n            <span style=\"color:blue\">Dim</span> newRecord <span style=\"color:blue\">As</span> <span style=\"color:blue\">New</span> tblRemedialWork\r\n\r\n            newRecord.RW_CallNo = ViewManageRecord.RS_CallNo\r\n            newRecord.RW_EngineerName = ViewManageRecord.RS_EngineerName\r\n            newRecord.RW_DateAdded = Now\r\n            newRecord.RW_Status = <span style=\"color:#a31515\">&quot;ACTIVE&quot;</span>\r\n            dbx.AddTotblRemedialWorks(newRecord)\r\n\r\n            <span style=\"color:blue\">Try</span>\r\n                dbx.SaveChanges()\r\n                RemedialWork.View.Refresh()\r\n            <span style=\"color:blue\">Catch</span> ex <span style=\"color:blue\">As</span> Exception\r\n                MessageBox.Show(ex.Message &amp; vbCrLf &amp; vbCrLf &amp; ex.Source)\r\n            <span style=\"color:blue\">End</span> <span style=\"color:blue\">Try</span>\r\n\r\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n</pre>\r\n</div>",
    "PostedDate": "2010-08-06T07:50:18.243-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "477401",
    "ThreadId": "222699",
    "Html": "<p>I got it working with the last bit of code. By requerying the linq query.</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>\r\n    <span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> butAddNewRemedial_Click(<span style=\"color:blue\">ByVal</span> sender <span style=\"color:blue\">As</span> System.Object, <span style=\"color:blue\">ByVal</span> e <span style=\"color:blue\">As</span> System.Windows.RoutedEventArgs)\r\n        <span style=\"color:blue\">If</span> RemedialWork.View.CurrentPosition = -1 <span style=\"color:blue\">Then</span>\r\n            <span style=\"color:blue\">Dim</span> newRecord <span style=\"color:blue\">As</span> <span style=\"color:blue\">New</span> tblRemedialWork\r\n\r\n            newRecord.RW_CallNo = ViewManageRecord.RS_CallNo\r\n            newRecord.RW_EngineerName = ViewManageRecord.RS_EngineerName\r\n            newRecord.RW_DateAdded = Now\r\n            newRecord.RW_Status = <span style=\"color:#a31515\">&quot;ACTIVE&quot;</span>\r\n            dbx.AddTotblRemedialWorks(newRecord)\r\n\r\n            <span style=\"color:blue\">Try</span>\r\n                dbx.SaveChanges()\r\n                RemedialWork.View.Refresh()\r\n\r\n                <span style=\"color:#ff00ff\">Dim remData = From n In dbx.tblRemedialWorks\r\n                      Where n.RW_CallNo = ViewManageRecord.RS_CallNo\r\n\r\n                Me.RemedialWork = CType(Me.FindResource(&quot;RemedialWork&quot;), CollectionViewSource)\r\n                Me.RemedialWork.Source = remData\r\n</span>\r\n\r\n            <span style=\"color:blue\">Catch</span> ex <span style=\"color:blue\">As</span> Exception\r\n                MessageBox.Show(ex.Message &amp; vbCrLf &amp; vbCrLf &amp; ex.Source)\r\n            <span style=\"color:blue\">End</span> <span style=\"color:blue\">Try</span>\r\n\r\n        <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n</pre>\r\n<pre>But the datagrid will not refresh! Maybe because it's a VIEW that I'm using from SQL Server!</pre>\r\n</div>",
    "PostedDate": "2010-08-06T08:16:25.33-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "477403",
    "ThreadId": "222699",
    "Html": "<p>Hi,</p>\r\n<p>Can u confirm that ur RemedialWork table has the updated value before the view.refresh call? Also that the binding on the data grid is OneWay / TwoWay or AutoGeneratedColumns = True (if ur underlying source is data table.)?</p>",
    "PostedDate": "2010-08-06T08:18:22.397-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "477407",
    "ThreadId": "222699",
    "Html": "<p>Have u&nbsp;bound the RemedialWork.View to the grid? or RemdialWork table itself? Try View.</p>",
    "PostedDate": "2010-08-06T08:21:01.227-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "477412",
    "ThreadId": "222699",
    "Html": "<p>Hi.</p>\r\n<p>I stopped the code at dbx.SaveChanges and the RemedialWork table has populated correctly.</p>\r\n<p>The databindings are as follows;</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">DataGrid.Columns</span><span style=\"color:blue\">&gt;</span>\r\n                                        <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">DataGridTextColumn</span> <span style=\"color:red\">x:Name</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RS_CallNo</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Binding</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">{Binding RS_CallNo, Mode=OneWay}</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Header</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Call No</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">IsReadOnly</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">True</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Width</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Auto</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Foreground</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Red</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n                                        <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">DataGridTextColumn</span> <span style=\"color:red\">x:Name</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RS_DateAdded</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Binding</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">{Binding RS_DateAdded, Mode=OneWay, StringFormat=dd/mm/yyyy}</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Header</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Date Added</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">IsReadOnly</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">True</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Width</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Auto</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n                                        <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">DataGridTextColumn</span> <span style=\"color:red\">x:Name</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Call_Site_Name</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Binding</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">{Binding Call_Site_Name, Mode=OneWay}</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Header</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Site Name</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">IsReadOnly</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">True</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Width</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">*</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n                                        <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">DataGridTextColumn</span> <span style=\"color:red\">x:Name</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Call_Site_Post_Code</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Binding</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">{Binding Call_Site_Post_Code, Mode=OneWay}</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Header</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Postcode</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">IsReadOnly</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">True</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Width</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Auto</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n                                        <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">DataGridTextColumn</span> <span style=\"color:red\">x:Name</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RS_EngineerName</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Binding</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">{Binding RS_EngineerName, Mode=OneWay}</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Header</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Engineer Name</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">IsReadOnly</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">True</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Width</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Auto</span><span style=\"color:black\">&quot;</span> <span style=\"color:blue\">/&gt;</span>\r\n                                        <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">DataGridTextColumn</span> <span style=\"color:red\">x:Name</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RS_ReportStatus</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Binding</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">{Binding RS_ReportStatus, Mode=OneWay}</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Header</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Report Status</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">IsReadOnly</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">True</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Width</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Auto</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Foreground</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Firebrick</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n                                        <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">DataGridTextColumn</span> <span style=\"color:red\">x:Name</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RS_CallStatus</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Binding</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">{Binding RS_CallStatus, Mode=TwoWay}</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Header</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Call Status</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">IsReadOnly</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">True</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Width</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Auto</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">Foreground</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Blue</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n                                    <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">DataGrid.Columns</span><span style=\"color:blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>RS_CallStatus I just set to TwoWay and no difference. AutoGeneratedColumns = FALSE</p>\r\n<p>RemedialWork data is NOT in a grid. I was just trying both avenues i.e. Normal data fields&nbsp;and a datagrid. Best ignore RemedialWork as its updating ok on a linq refresh.</p>",
    "PostedDate": "2010-08-06T08:35:37.573-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "477498",
    "ThreadId": "222699",
    "Html": "<p>I got a hint from this question <a href=\"http://stackoverflow.com/questions/930350/how-to-refresh-a-wpf-datagrid\">http://stackoverflow.com/questions/930350/how-to-refresh-a-wpf-datagrid</a></p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>obList(0).RS_CallStatus = <span style=\"color:#a31515\">&quot;WAIT&quot;</span>\r\n</pre>\r\n<pre>OK, SO I now need to get the correct record from the observable collection, but I'm most of the way there.</pre>\r\n<pre>Would actually be better if I could just rip the itemssource off the datagrid and put it back on. Maybe look into that.</pre>\r\n<pre>Thanks for your help. Scott</pre>\r\n</div>",
    "PostedDate": "2010-08-06T13:03:31.133-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "477746",
    "ThreadId": "222699",
    "Html": "<p>OK. The final part of this jigsaw (for anyone else in the same boat)</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:green\">'Manual refresh of View.</span>\r\n        dbx.Refresh(System.Data.Objects.RefreshMode.ClientWins, dbx.View_EngineerManage)\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>I added this at the top of the code in the procedure PopulateListOfCalls in the first post. Cheers Scott</p>",
    "PostedDate": "2010-08-08T03:31:13.067-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]