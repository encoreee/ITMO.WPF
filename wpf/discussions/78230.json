[
  {
    "Id": "267625",
    "ThreadId": "78230",
    "Html": "<div style=\"color:Black;background-color:White\">\r\n<pre>Hi,</pre>\r\n<pre>I am trying to add 1st row of the Datagrid to be one with a mulitpl selection(Combox). The other rows will be will be editable text. I do this by binding to a dataset. If I want an extra column I am able to do it easily by adding a templatedcolumn in the XAML datagrid. </pre>\r\n<pre>Is there some way to similarly add row.</pre>\r\n<pre>P.S(The requirement is to reverse the rows and columns to avoid scrolling).</pre>\r\n<pre>I have pasted below the sample code.</pre>\r\n<pre>XAML\r\n&lt;Grid Height=<span style=\"color:#A31515\">&quot;339&quot;</span> Width=<span style=\"color:#A31515\">&quot;697&quot;</span>&gt;\r\n        &lt;Label Margin=<span style=\"color:#A31515\">&quot;96,33,379,206&quot;</span>&gt;Name:&lt;/Label&gt;\r\n        &lt;Label Name=<span style=\"color:#A31515\">&quot;tableName&quot;</span> Content=<span style=\"color:#A31515\">&quot;{Binding Name}&quot;</span>  Margin=<span style=\"color:#A31515\">&quot;143,33,176,267&quot;</span>&gt;&lt;/Label&gt;\r\n        &lt;Label Margin=<span style=\"color:#A31515\">&quot;67,62,411,238&quot;</span>&gt;Reset Action:&lt;/Label&gt;\r\n        &lt;ComboBox Height=<span style=\"color:#A31515\">&quot;23&quot;</span> HorizontalAlignment=<span style=\"color:#A31515\">&quot;Left&quot;</span>  Margin=<span style=\"color:#A31515\">&quot;152,62,0,0&quot;</span> ItemsSource=<span style=\"color:#A31515\">&quot;{Binding ResetAction}&quot;</span>  SelectedValue=<span style=\"color:#A31515\">&quot;{Binding Path=ResetAction}&quot;</span>  Name=<span style=\"color:#A31515\">&quot;resetaction&quot;</span>  VerticalAlignment=<span style=\"color:#A31515\">&quot;Top&quot;</span> Width=<span style=\"color:#A31515\">&quot;120&quot;</span> /&gt;\r\n        &lt;dg:DataGrid IsReadOnly=<span style=\"color:#A31515\">&quot;False&quot;</span>  Name=<span style=\"color:#A31515\">&quot;tablegrid&quot;</span> AutoGenerateColumns=<span style=\"color:#A31515\">&quot;True&quot;</span>  RowHeight=<span style=\"color:#A31515\">&quot;20&quot;</span> Margin=<span style=\"color:#A31515\">&quot;152,91,58,39&quot;</span>&gt;\r\n                                  \r\n        &lt;/dg:DataGrid&gt;\r\n        &lt;Button Name=<span style=\"color:#A31515\">&quot;Addbutton&quot;</span> Click=<span style=\"color:#A31515\">&quot;Addbutton_Click&quot;</span> Margin=<span style=\"color:#A31515\">&quot;258,303,378,9&quot;</span>&gt;Add&lt;/Button&gt;\r\n        &lt;Button Name=<span style=\"color:#A31515\">&quot;Deletebutton&quot;</span> Click=<span style=\"color:#A31515\">&quot;Deletebutton_Click&quot;</span> Margin=<span style=\"color:#A31515\">&quot;0,306,309,9&quot;</span> HorizontalAlignment=<span style=\"color:#A31515\">&quot;Right&quot;</span> Width=<span style=\"color:#A31515\">&quot;53&quot;</span>&gt;Delete&lt;/Button&gt;\r\n    &lt;/Grid&gt;\r\n\r\n<span style=\"color:Blue\">using</span> System;\r\n<span style=\"color:Blue\">using</span> System.Collections.Generic;\r\n<span style=\"color:Blue\">using</span> System.Linq;\r\n<span style=\"color:Blue\">using</span> System.Text;\r\n<span style=\"color:Blue\">using</span> System.Windows;\r\n<span style=\"color:Blue\">using</span> System.Windows.Controls;\r\n<span style=\"color:Blue\">using</span> System.Windows.Data;\r\n<span style=\"color:Blue\">using</span> System.Windows.Documents;\r\n<span style=\"color:Blue\">using</span> System.Windows.Input;\r\n<span style=\"color:Blue\">using</span> System.Windows.Media;\r\n<span style=\"color:Blue\">using</span> System.Windows.Media.Imaging;\r\n<span style=\"color:Blue\">using</span> System.Windows.Navigation;\r\n<span style=\"color:Blue\">using</span> System.Windows.Shapes;\r\n<span style=\"color:Blue\">using</span> Microsoft.SqlServer.Management.Smo;\r\n<span style=\"color:Blue\">using</span> System.Collections.ObjectModel;\r\n<span style=\"color:Blue\">using</span> System.Data;\r\n<span style=\"color:Blue\">using</span> System.ComponentModel; \r\n\r\n<span style=\"color:Blue\">namespace</span> TreeViewControlWPF\r\n{\r\n    <span style=\"color:Gray\">///</span> <span style=\"color:Gray\">&lt;summary&gt;</span>\r\n    <span style=\"color:Gray\">///</span><span style=\"color:Green\"> Interaction logic for TestTable.xaml</span>\r\n    <span style=\"color:Gray\">///</span> <span style=\"color:Gray\">&lt;/summary&gt;</span>\r\n    <span style=\"color:Gray\">///</span><span style=\"color:Green\"> </span>\r\n    <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">partial</span> <span style=\"color:Blue\">class</span> TestTable : UserControl\r\n    {\r\n        <span style=\"color:Blue\">public</span> DataSet ds;\r\n        <span style=\"color:Blue\">public</span> DataTable datatable;\r\n        <span style=\"color:Blue\">int</span> i = 1;\r\n        <span style=\"color:Blue\">public</span> TestTable()\r\n        {\r\n            InitializeComponent();\r\n            resetaction.Items.Add(resetAction.clear);\r\n            resetaction.Items.Add(resetAction.noClear);\r\n\r\n            \r\n\r\n            ds = <span style=\"color:Blue\">new</span> DataSet();\r\n            datatable = <span style=\"color:Blue\">new</span> DataTable();\r\n            ds.Tables.Add(datatable);\r\n            datatable = addColumn(datatable, <span style=\"color:#A31515\">&quot;Field&quot;</span>);\r\n            datatable = CreateTable(datatable);\r\n            tablegrid.DataContext = ds.Tables[0];\r\n            tablegrid.ItemsSource = (ds.Tables[0] <span style=\"color:Blue\">as</span> IListSource).GetList();\r\n            \r\n        }\r\n\r\n        <span style=\"color:Blue\">private</span> <span style=\"color:Blue\">void</span> Deletebutton_Click(<span style=\"color:Blue\">object</span> sender, RoutedEventArgs e)\r\n        {\r\n\r\n        }\r\n        <span style=\"color:Blue\">private</span> DataTable CreateTable(DataTable datatable)\r\n        {\r\n      \r\n            DataRow row;\r\n            <span style=\"color:Blue\">string</span> tablename = <span style=\"color:#A31515\">&quot;Employee&quot;</span>;<span style=\"color:Green\">//tableName.DataContext.ToString();</span>\r\n            <span style=\"color:Blue\">string</span> SQLServerInstance = <span style=\"color:#A31515\">&quot; &quot;</span>; //server name\r\n            <span style=\"color:Blue\">string</span> DatabaseName = <span style=\"color:#A31515\">&quot; &quot;</span>; //Database Name\r\n            Server server = <span style=\"color:Blue\">new</span> Server();\r\n            server.ConnectionContext.ServerInstance = SQLServerInstance;\r\n            server.ConnectionContext.LoginSecure = <span style=\"color:Blue\">true</span>;\r\n            server.ConnectionContext.Connect();\r\n            Database database = <span style=\"color:Blue\">new</span> Database(server, DatabaseName);\r\n\r\n\r\nMicrosoft.SqlServer.Management.Smo.Table table = <span style=\"color:Blue\">new</span> Microsoft.SqlServer.Management.Smo.Table(database, tablename);\r\n            table.Refresh();\r\n\r\n            <span style=\"color:Blue\">foreach</span> (Column column <span style=\"color:Blue\">in</span> table.Columns)\r\n            {\r\n                row = datatable.NewRow();\r\n                row[<span style=\"color:#A31515\">&quot;Field&quot;</span>] = column.Name;\r\n                datatable.Rows.Add(row);\r\n            }\r\n\r\n            <span style=\"color:Blue\">return</span> datatable;\r\n        }\r\n\r\n    \r\n        <span style=\"color:Blue\">private</span> DataTable addColumn(DataTable table, <span style=\"color:Blue\">string</span> columnName)\r\n        {\r\n            DataColumn col = <span style=\"color:Blue\">new</span> DataColumn(columnName, <span style=\"color:Blue\">typeof</span>(<span style=\"color:Blue\">string</span>));\r\n            table.Columns.Add(col);\r\n            <span style=\"color:Blue\">return</span> table;\r\n        }\r\n\r\n        <span style=\"color:Blue\">private</span> <span style=\"color:Blue\">void</span> Addbutton_Click(<span style=\"color:Blue\">object</span> sender, RoutedEventArgs e)\r\n        {\r\n            tablegrid.ItemsSource = <span style=\"color:Blue\">null</span>; \r\n            \r\n            <span style=\"color:Blue\">string</span> recordstring=<span style=\"color:#A31515\">&quot;Record&quot;</span>;\r\n            recordstring = recordstring + <span style=\"color:#A31515\">&quot; &quot;</span> + i;         \r\n            datatable = addColumn(datatable,recordstring);           \r\n            i = i + 1;                      \r\n            tablegrid.DataContext = ds.Tables[0];\r\n            tablegrid.ItemsSource = (ds.Tables[0] <span style=\"color:Blue\">as</span> IListSource).GetList();            \r\n            \r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n</pre>\r\n</div>",
    "PostedDate": "2009-12-15T09:21:45.62-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]