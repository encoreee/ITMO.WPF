[
  {
    "Id": "187286",
    "ThreadId": "55467",
    "Html": "TypeInitializeException will be thrown with inner exception detail &quot;The URI prefix is not recognized.&quot;<br>\r\nAccording to my understanding, the exception happens because the following code in RibbonWindow constructor:<br>\r\n<a href=\"http://www.aisto.com/roeder/dotnet/Default.aspx?Target=code://RibbonControlsLibrary:3.5.31016.1:31bf3856ad364e35/Microsoft.Windows.Controls.Ribbon.RibbonWindow/_dictionary:System.Windows.ResourceDictionary\" title=\"ResourceDictionary Microsoft.Windows.Controls.Ribbon.RibbonWindow._dictionary;\">_dictionary</a>.<a href=\"http://www.aisto.com/roeder/dotnet/Default.aspx?Target=code://PresentationFramework:3.0.0.0:31bf3856ad364e35/System.Windows.ResourceDictionary/property:Source:System.Uri\" title=\"Uri System.Windows.ResourceDictionary.Source { ... }\">Source</a> = <span style=\"color:#1000a0\">new</span> <a href=\"http://www.aisto.com/roeder/dotnet/Default.aspx?Target=code://System:2.0.0.0:b77a5c561934e089/System.Uri/.ctor(String,System.UriKind)\" title=\"System.Uri.Uri(string, UriKind);\">Uri</a>(<span style=\"color:#800000\">&quot;/RibbonControlsLibrary;component/Themes/RibbonWindow.xaml&quot;</span>, <a href=\"http://www.aisto.com/roeder/dotnet/Default.aspx?Target=code://System:2.0.0.0:b77a5c561934e089/System.UriKind\" title=System.UriKind>UriKind</a>.<a href=\"http://www.aisto.com/roeder/dotnet/Default.aspx?Target=code://System:2.0.0.0:b77a5c561934e089/System.UriKind/Relative\" title=\"UriKind System.UriKind.Relative;\">Relative</a>) <br>\r\nThe above code works perfectly if there exists WPF Application instance which do some initialization to help find URI package. Unfortunately there's no WPF Applicaiton instance in my app, so comes the excepion.<br>\r\n<br>\r\nSince WPF Window class can be instantiated in winform project, I think same request to RibbonWindow is reasonable. Actually the minor change may fix the issue:<br>\r\n<a href=\"http://www.aisto.com/roeder/dotnet/Default.aspx?Target=code://RibbonControlsLibrary:3.5.31016.1:31bf3856ad364e35/Microsoft.Windows.Controls.Ribbon.RibbonWindow/_dictionary:System.Windows.ResourceDictionary\" title=\"ResourceDictionary Microsoft.Windows.Controls.Ribbon.RibbonWindow._dictionary;\">_dictionary</a>.<a href=\"http://www.aisto.com/roeder/dotnet/Default.aspx?Target=code://PresentationFramework:3.0.0.0:31bf3856ad364e35/System.Windows.ResourceDictionary/property:Source:System.Uri\" title=\"Uri System.Windows.ResourceDictionary.Source { ... }\">Source</a> = <span style=\"color:#1000a0\">new</span> <a href=\"http://www.aisto.com/roeder/dotnet/Default.aspx?Target=code://System:2.0.0.0:b77a5c561934e089/System.Uri/.ctor(String,System.UriKind)\" title=\"System.Uri.Uri(string, UriKind);\">Uri</a>(<span style=\"color:#800000\">&quot;<strong>pack://application:,,,</strong> /RibbonControlsLibrary;component/Themes/RibbonWindow.xaml&quot;</span>, <a href=\"http://www.aisto.com/roeder/dotnet/Default.aspx?Target=code://System:2.0.0.0:b77a5c561934e089/System.UriKind\" title=System.UriKind>UriKind</a>.<a href=\"http://www.aisto.com/roeder/dotnet/Default.aspx?Target=code://System:2.0.0.0:b77a5c561934e089/System.UriKind/Relative\" title=\"UriKind System.UriKind.Relative;\">Relative</a>) <br>\r\n<br>\r\nI hope it would be helpful.\r\n",
    "PostedDate": "2009-05-06T02:58:38.02-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]