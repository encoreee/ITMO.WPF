[
  {
    "Id": "410369",
    "ThreadId": "201484",
    "Html": "<p>I'm having some difficulty creating a line chart programmatically.&nbsp; Here is some code I have:</p>\r\n<p>using System;<br>using System.Windows;<br>using System.Windows.Markup;<br>using System.Reflection;<br>using System.IO;<br>using System.Windows.Controls.DataVisualization.Charting;<br>using System.Collections.Generic;</p>\r\n<p>public class Application<br>{<br>&nbsp;[STAThread]<br>&nbsp;public static void Main(string[] args)<br>&nbsp;{<br>&nbsp;&nbsp;System.Windows.Application app = new System.Windows.Application();<br>&nbsp;&nbsp;System.Windows.Window window = new System.Windows.Window();<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;Chart chart = new System.Windows.Controls.DataVisualization.Charting.Chart();<br>&nbsp;&nbsp;LinearAxis axis = new System.Windows.Controls.DataVisualization.Charting.LinearAxis();<br>&nbsp;&nbsp;axis.Orientation = AxisOrientation.X;<br>&nbsp;&nbsp;axis.Title = &quot;Last 8 Hours&quot;;<br>&nbsp;&nbsp;axis.Interval = 1;<br>&nbsp;&nbsp;chart.Axes.Add(axis);<br>&nbsp;&nbsp;axis = new LinearAxis();<br>&nbsp;&nbsp;axis.Orientation = AxisOrientation.Y;<br>&nbsp;&nbsp;axis.Title = &quot;Error Counts&quot;;<br>&nbsp;&nbsp;chart.Axes.Add(axis);<br>&nbsp;&nbsp;System.Windows.Controls.DataVisualization.Charting.LineSeries line =<br>&nbsp;&nbsp;&nbsp;&nbsp;new System.Windows.Controls.DataVisualization.Charting.LineSeries();<br>&nbsp;&nbsp;line.Title = &quot;Current Day&quot;;<br>&nbsp;&nbsp;line.IndependentValuePath = &quot;X&quot;;<br>&nbsp;&nbsp;line.DependentValuePath = &quot;Y&quot;;<br>&nbsp;&nbsp;IList&lt;Point&gt; points = new List&lt;Point&gt;();<br>&nbsp;&nbsp;points.Add(new Point(1, 25));<br>&nbsp;&nbsp;points.Add(new Point(2, 13));<br>&nbsp;&nbsp;points.Add(new Point(3, 130));<br>&nbsp;&nbsp;line.ItemsSource = points;<br>&nbsp;&nbsp;chart.Series.Add(line);<br>&nbsp;&nbsp;chart.Background = System.Windows.Media.Brushes.Lime;<br>&nbsp;&nbsp;chart.HorizontalAlignment = HorizontalAlignment.Stretch;<br>&nbsp;&nbsp;window.Content = chart;<br>&nbsp;&nbsp;app.Run(window);<br>&nbsp;}<br>}</p>\r\n<p>When I run the above code I get the exception below.&nbsp; The type listed in the exception seems to be a type from Silverlight which I don't have installed.&nbsp; What's going on?&nbsp; I did some googling and saw that someone else had some problem with this type of exception and it had something to do with an invalid template, or something like that.&nbsp; Does someone have some chart samples which don't rely on XAML but instead create everything programmatically?</p>\r\n<p>Thanks,</p>\r\n<p>Nick</p>\r\n<p><br>Unhandled Exception: System.Windows.Markup.XamlParseException:&nbsp; Cannot find type 'System.Windows.VisualStateGroup'. The assembly used when compiling might be different than that used when loading and the type is missing.&nbsp; Error at object 'System.Windows.Controls.ControlTemplate'. ---&gt; System.ApplicationException: Cannot find type 'System.Windows.VisualStateGroup'. The assembly used when compiling might be different than that used when loading and the type is missing.<br>&nbsp;&nbsp; at System.Windows.Markup.BamlMapTable.ThrowException(String id, String parameter)<br>&nbsp;&nbsp; at System.Windows.Markup.BamlMapTable.GetTypeFromId(Int16 id)<br>&nbsp;&nbsp; at System.Windows.Markup.OptimizedTemplateContent.CheckElementStartForOptimization(BamlRecord bamlRecord)<br>&nbsp;&nbsp; at System.Windows.Markup.OptimizedTemplateContent.ReadRecord(BamlRecord bamlRecord)<br>&nbsp;&nbsp; at System.Windows.Markup.OptimizedTemplateContent.AddContentRecord(BamlRecord bamlRecord)<br>&nbsp;&nbsp; at System.Windows.Markup.TemplateBamlRecordReader.AddContentRecord(BamlRecord bamlRecord)<br>&nbsp;&nbsp; at System.Windows.Markup.TemplateBamlRecordReader.ReadElementStartRecord(BamlElementStartRecord bamlElementStartRecord)<br>&nbsp;&nbsp; at System.Windows.Markup.TemplateBamlRecordReader.ReadRecord(BamlRecord bamlRecord)<br>&nbsp;&nbsp; at System.Windows.Markup.BamlRecordReader.Read(Boolean singleRecord)<br>&nbsp;&nbsp; at System.Windows.Markup.TemplateTreeBuilderBamlTranslator.ParseFragment()<br>&nbsp;&nbsp; at System.Windows.Markup.TreeBuilder.Parse()<br>&nbsp;&nbsp; at System.Windows.Markup.XamlTemplateSerializer.ConvertBamlToObject(BamlRecordReader reader, BamlRecord bamlRecord, ParserContext context)<br>&nbsp;&nbsp; at System.Windows.Markup.BamlRecordReader.ReadElementStartRecord(BamlElementStartRecord bamlElementRecord)<br>&nbsp;&nbsp; at System.Windows.Markup.StyleBamlRecordReader.ReadElementStartRecord(BamlElementStartRecord bamlElementRecord)<br>&nbsp;&nbsp; at System.Windows.Markup.BamlRecordReader.ReadRecord(BamlRecord bamlRecord)<br>&nbsp;&nbsp; --- End of inner exception stack trace ---<br>&nbsp;&nbsp; at System.Windows.Markup.XamlParseException.ThrowException(String message, Exception innerException, Int32 lineNumber, Int32 linePosition, Uri baseUri, XamlObjectIds currentXamlObjectIds, XamlObjectIds contextXamlObjectIds, Type objectType)<br>&nbsp;&nbsp; at System.Windows.Markup.XamlParseException.ThrowException(ParserContext parserContext, Int32 lineNumber, Int32 linePosition, String message, Exception innerException)<br>&nbsp;&nbsp; at System.Windows.Markup.BamlRecordReader.ReadRecord(BamlRecord bamlRecord)<br>&nbsp;&nbsp; at System.Windows.Markup.StyleBamlRecordReader.ReadRecord(BamlRecord bamlRecord)<br>&nbsp;&nbsp; at System.Windows.Markup.BamlRecordReader.Read(Boolean singleRecord)<br>&nbsp;&nbsp; at System.Windows.Markup.StyleTreeBuilderBamlTranslator.ParseFragment()<br>&nbsp;&nbsp; at System.Windows.Markup.TreeBuilder.Parse()<br>&nbsp;&nbsp; at System.Windows.Markup.XamlStyleSerializer.ConvertBamlToObject(BamlRecordReader reader, BamlRecord bamlRecord, ParserContext context)<br>&nbsp;&nbsp; at System.Windows.Markup.BamlRecordReader.ReadElementStartRecord(BamlElementStartRecord bamlElementRecord)<br>&nbsp;&nbsp; at System.Windows.Markup.BamlRecordReader.ReadRecord(BamlRecord bamlRecord)<br>&nbsp;&nbsp; at System.Windows.Markup.BamlRecordReader.ReadElement(Int64 startPosition, XamlObjectIds contextXamlObjectIds, Object dictionaryKey)<br>&nbsp;&nbsp; at System.Windows.ResourceDictionary.CreateObject(Int32 valuePosition, Object key)<br>&nbsp;&nbsp; at System.Windows.ResourceDictionary.RealizeDeferContent(Object key, Object&amp; value, Boolean&amp; canCache)<br>&nbsp;&nbsp; at System.Windows.ResourceDictionary.GetValueWithoutLock(Object key, Boolean&amp; canCache)<br>&nbsp;&nbsp; at System.Windows.ResourceDictionary.GetValue(Object key, Boolean&amp; canCache)<br>&nbsp;&nbsp; at System.Windows.ResourceDictionary.FetchResource(Object resourceKey, Boolean allowDeferredResourceReference, Boolean mustReturnDeferredResourceReference, Boolean&amp; canCache)<br>&nbsp;&nbsp; at System.Windows.SystemResources.LookupResourceInDictionary(ResourceDictionary dictionary, Object key, Boolean allowDeferredResourceReference, Boolean mustReturnDeferredResourceReference, Boolean&amp; canCache)<br>&nbsp;&nbsp; at System.Windows.SystemResources.FindDictionaryResource(Object key, Type typeKey, ResourceKey resourceKey, Boolean isTraceEnabled, Boolean allowDeferredResourceReference, Boolean mustReturnDeferredResourceReference, Boolean&amp; canCache)<br>&nbsp;&nbsp; at System.Windows.SystemResources.FindResourceInternal(Object key, Boolean allowDeferredResourceReference, Boolean mustReturnDeferredResourceReference)<br>&nbsp;&nbsp; at System.Windows.StyleHelper.GetThemeStyle(FrameworkElement fe, FrameworkContentElement fce)<br>&nbsp;&nbsp; at System.Windows.FrameworkElement.UpdateThemeStyleProperty()<br>&nbsp;&nbsp; at System.Windows.FrameworkElement.OnInitialized(EventArgs e)<br>&nbsp;&nbsp; at System.Windows.FrameworkElement.TryFireInitialized()<br>&nbsp;&nbsp; at System.Windows.FrameworkElement.ChangeLogicalParent(DependencyObject newParent)<br>&nbsp;&nbsp; at MS.Internal.FrameworkObject.ChangeLogicalParent(DependencyObject newParent)<br>&nbsp;&nbsp; at System.Windows.FrameworkElement.AddLogicalChild(Object child)<br>&nbsp;&nbsp; at System.Windows.Controls.UIElementCollection.SetLogicalParent(UIElement element)<br>&nbsp;&nbsp; at System.Windows.Controls.UIElementCollection.AddInternal(UIElement element)<br>&nbsp;&nbsp; at System.Windows.Controls.UIElementCollection.Add(UIElement element)<br>&nbsp;&nbsp; at System.Windows.Controls.DataVisualization.Charting.DataPointSingleSeriesWithAxes.CreateLegendItemDataPoint()<br>&nbsp;&nbsp; at System.Windows.Controls.DataVisualization.Charting.DataPointSingleSeriesWithAxes.OnPlotAreaChanged(Panel oldValue, Panel newValue)<br>&nbsp;&nbsp; at System.Windows.Controls.DataVisualization.Charting.DataPointSeries.set_PlotArea(Panel value)<br>&nbsp;&nbsp; at System.Windows.Controls.DataVisualization.Charting.DataPointSeries.OnApplyTemplate()<br>&nbsp;&nbsp; at System.Windows.Controls.DataVisualization.Charting.LineAreaBaseSeries`1.OnApplyTemplate()<br>&nbsp;&nbsp; at System.Windows.FrameworkElement.ApplyTemplate()<br>&nbsp;&nbsp; at System.Windows.FrameworkElement.MeasureCore(Size availableSize)<br>&nbsp;&nbsp; at System.Windows.UIElement.Measure(Size availableSize)<br>&nbsp;&nbsp; at System.Windows.Controls.DataVisualization.Charting.Primitives.EdgePanel.MeasureOverride(Size constraint)<br>&nbsp;&nbsp; at System.Windows.FrameworkElement.MeasureCore(Size availableSize)<br>&nbsp;&nbsp; at System.Windows.UIElement.Measure(Size availableSize)<br>&nbsp;&nbsp; at System.Windows.Controls.Grid.MeasureCell(Int32 cell, Boolean forceInfinityV)<br>&nbsp;&nbsp; at System.Windows.Controls.Grid.MeasureCellsGroup(Int32 cellsHead, Size referenceSize, Boolean ignoreDesiredSizeU, Boolean forceInfinityV)<br>&nbsp;&nbsp; at System.Windows.Controls.Grid.MeasureOverride(Size constraint)<br>&nbsp;&nbsp; at System.Windows.FrameworkElement.MeasureCore(Size availableSize)<br>&nbsp;&nbsp; at System.Windows.UIElement.Measure(Size availableSize)<br>&nbsp;&nbsp; at System.Windows.Controls.Grid.MeasureCell(Int32 cell, Boolean forceInfinityV)<br>&nbsp;&nbsp; at System.Windows.Controls.Grid.MeasureCellsGroup(Int32 cellsHead, Size referenceSize, Boolean ignoreDesiredSizeU, Boolean forceInfinityV)<br>&nbsp;&nbsp; at System.Windows.Controls.Grid.MeasureOverride(Size constraint)<br>&nbsp;&nbsp; at System.Windows.FrameworkElement.MeasureCore(Size availableSize)<br>&nbsp;&nbsp; at System.Windows.UIElement.Measure(Size availableSize)<br>&nbsp;&nbsp; at System.Windows.Controls.Border.MeasureOverride(Size constraint)<br>&nbsp;&nbsp; at System.Windows.FrameworkElement.MeasureCore(Size availableSize)<br>&nbsp;&nbsp; at System.Windows.UIElement.Measure(Size availableSize)<br>&nbsp;&nbsp; at System.Windows.Controls.Control.MeasureOverride(Size constraint)<br>&nbsp;&nbsp; at System.Windows.FrameworkElement.MeasureCore(Size availableSize)<br>&nbsp;&nbsp; at System.Windows.UIElement.Measure(Size availableSize)<br>&nbsp;&nbsp; at MS.Internal.Helper.MeasureElementWithSingleChild(UIElement element, Size constraint)<br>&nbsp;&nbsp; at System.Windows.Controls.ContentPresenter.MeasureOverride(Size constraint)<br>&nbsp;&nbsp; at System.Windows.FrameworkElement.MeasureCore(Size availableSize)<br>&nbsp;&nbsp; at System.Windows.UIElement.Measure(Size availableSize)<br>&nbsp;&nbsp; at System.Windows.Controls.Decorator.MeasureOverride(Size constraint)<br>&nbsp;&nbsp; at System.Windows.Documents.AdornerDecorator.MeasureOverride(Size constraint)<br>&nbsp;&nbsp; at System.Windows.FrameworkElement.MeasureCore(Size availableSize)<br>&nbsp;&nbsp; at System.Windows.UIElement.Measure(Size availableSize)<br>&nbsp;&nbsp; at System.Windows.Controls.Border.MeasureOverride(Size constraint)<br>&nbsp;&nbsp; at System.Windows.FrameworkElement.MeasureCore(Size availableSize)<br>&nbsp;&nbsp; at System.Windows.UIElement.Measure(Size availableSize)<br>&nbsp;&nbsp; at System.Windows.Window.MeasureOverrideHelper(Size constraint)<br>&nbsp;&nbsp; at System.Windows.Window.MeasureOverride(Size availableSize)<br>&nbsp;&nbsp; at System.Windows.FrameworkElement.MeasureCore(Size availableSize)<br>&nbsp;&nbsp; at System.Windows.UIElement.Measure(Size availableSize)<br>&nbsp;&nbsp; at System.Windows.Interop.HwndSource.SetLayoutSize()<br>&nbsp;&nbsp; at System.Windows.Interop.HwndSource.set_RootVisualInternal(Visual value)<br>&nbsp;&nbsp; at System.Windows.Interop.HwndSource.set_RootVisual(Visual value)<br>&nbsp;&nbsp; at System.Windows.Window.SetRootVisual()<br>&nbsp;&nbsp; at System.Windows.Window.SetupInitialState(Double requestedTop, Double requestedLeft, Double requestedWidth, Double requestedHeight)<br>&nbsp;&nbsp; at System.Windows.Window.CreateSourceWindowImpl()<br>&nbsp;&nbsp; at System.Windows.Window.SafeCreateWindow()<br>&nbsp;&nbsp; at System.Windows.Window.ShowHelper(Object booleanBox)<br>&nbsp;&nbsp; at System.Windows.Window.Show()<br>&nbsp;&nbsp; at System.Windows.Application.&lt;RunInternal&gt;b__8(Object obj)<br>&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)<br>&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br>&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.InvokeImpl()<br>&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.InvokeInSecurityContext(Object state)<br>&nbsp;&nbsp; at System.Threading.ExecutionContext.runTryCode(Object userData)<br>&nbsp;&nbsp; at System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData)<br>&nbsp;&nbsp; at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)<br>&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)<br>&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.Invoke()<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.ProcessQueue()<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.WndProcHook(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)<br>&nbsp;&nbsp; at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)<br>&nbsp;&nbsp; at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)<br>&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)<br>&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Boolean isSingleParameter)<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.Invoke(DispatcherPriority priority, Delegate method, Object arg)<br>&nbsp;&nbsp; at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)<br>&nbsp;&nbsp; at MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG&amp; msg)<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)<br>&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.Run()<br>&nbsp;&nbsp; at System.Windows.Application.RunDispatcher(Object ignore)<br>&nbsp;&nbsp; at System.Windows.Application.RunInternal(Window window)<br>&nbsp;&nbsp; at System.Windows.Application.Run(Window window)<br>&nbsp;&nbsp; at Application.Main(String[] args) in c:\\workspaces\\stability\\main\\tools\\error\\Errors.cs:line 41</p>",
    "PostedDate": "2010-02-26T14:28:37.867-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]