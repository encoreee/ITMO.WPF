[
  {
    "Id": "579155",
    "ThreadId": "249355",
    "Html": "<p>We actually created our own HightlighedTextBlock before I found out about Jeff Wilcox's, but it is very similar.</p>\n<p>We are using the HightlightedTextBlock in WPF and binding to the SearchText property with XAML; note we are using the DataGridSelectionAdapter to show results in a grid -- we do not seem to get the problem with the default ListBox:</p>\n<p>&nbsp;</p>\n<p><span style=\"color: #a31515; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">&lt;</span><span style=\"color: #a31515; font-size: 7.5pt;\">DataTemplate</span><span style=\"color: red; font-size: 7.5pt;\">&nbsp;x</span><span style=\"color: blue; font-size: 7.5pt;\">:</span><span style=\"color: red; font-size: 7.5pt;\">Key</span><span style=\"color: blue; font-size: 7.5pt;\">=\"AutoCompleteConfirmItemTemplate\"&gt;</span></p>\n<p><span style=\"color: #a31515; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">&lt;</span><span style=\"color: #a31515; font-size: 7.5pt;\">StackPanel</span><span style=\"color: red; font-size: 7.5pt;\">&nbsp;Orientation</span><span style=\"color: blue; font-size: 7.5pt;\">=\"Horizontal\"&gt;</span></p>\n<p><span style=\"color: #a31515; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">&lt;</span><span style=\"color: #a31515; font-size: 7.5pt;\">controls</span><span style=\"color: blue; font-size: 7.5pt;\">:</span><span style=\"color: #a31515; font-size: 7.5pt;\">HighlightedTextBlock</span></p>\n<p><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: red; font-size: 7.5pt;\">&nbsp;Highlight</span><span style=\"color: blue; font-size: 7.5pt;\">=\"{</span><span style=\"color: #a31515; font-size: 7.5pt;\">Binding</span><span style=\"color: red; font-size: 7.5pt;\">&nbsp;Path</span><span style=\"color: blue; font-size: 7.5pt;\">=SearchText,</span><span style=\"color: red; font-size: 7.5pt;\">RelativeSource</span><span style=\"color: blue; font-size: 7.5pt;\">={</span><span style=\"color: #a31515; font-size: 7.5pt;\">RelativeSource</span><span style=\"color: red; font-size: 7.5pt;\">&nbsp;AncestorType</span><span style=\"color: blue; font-size: 7.5pt;\">={</span><span style=\"color: #a31515; font-size: 7.5pt;\">x</span><span style=\"color: blue; font-size: 7.5pt;\">:</span><span style=\"color: #a31515; font-size: 7.5pt;\">Type</span><span style=\"color: red; font-size: 7.5pt;\">&nbsp;wpftoolkit</span><span style=\"color: blue; font-size: 7.5pt;\">:</span><span style=\"color: red; font-size: 7.5pt;\">AutoCompleteBox</span><span style=\"color: blue; font-size: 7.5pt;\">}}}\"</span></p>\n<p><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: red; font-size: 7.5pt;\">&nbsp;RawText</span><span style=\"color: blue; font-size: 7.5pt;\">=\"{</span><span style=\"color: #a31515; font-size: 7.5pt;\">Binding</span><span style=\"color: red; font-size: 7.5pt;\">&nbsp;Path</span><span style=\"color: blue; font-size: 7.5pt;\">=Name}\"</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span></p>\n<p><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">&nbsp;/&gt;</span></p>\n<p><span style=\"color: #a31515; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">&lt;/</span><span style=\"color: #a31515; font-size: 7.5pt;\">StackPanel</span><span style=\"color: blue; font-size: 7.5pt;\">&gt;</span></p>\n<p><span style=\"color: #a31515; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">&lt;/</span><span style=\"color: #a31515; font-size: 7.5pt;\">DataTemplate</span><span style=\"color: blue; font-size: 7.5pt;\">&gt;</span></p>\n<p>&nbsp;</p>\n<p>Note that in our HightlightedTextBlock, SearchText is WHAT to highlight, and RawText is the text that we are displaying. The problem appears to be with our binding and virtualization (which we need, since we have thousands of items, so we do not want to turn this off). We find that we get many exceptions such as these, and when we scroll through, many items will not have the proper highlighting accordingly:</p>\n<p>&nbsp;</p>\n<p>System.Windows.Data Error: 4 : Cannot find source for binding with reference 'RelativeSource FindAncestor, AncestorType='X.Client.Controls.AutoCompleteBoxEx', AncestorLevel='1''. BindingExpression:Path=SearchText; DataItem=null; target element is 'HighlightedTextBlock' (Name=''); target property is 'Highlight' (type 'String')</p>\n<p>&nbsp;</p>\n<p>Any ideas on how we should properly implement binding to SearchText taking into account virtualization?</p>\n<p>&nbsp;</p>\n<p>Again, we are using the DataGridSelectionAdapter.&nbsp;</p>\n<p>Any thoughts on how to resolve these?</p>\n<p>&nbsp;</p>\n<p>The exceptions seems to be related to performance problems with the control (they slow it down).</p>\n<p>&nbsp;</p>\n<p>We would happily pay a vendor for a supported control that fixed these issues, but we haven&rsquo;t found one yet. We would very much appreciate any help anyone might be able to provide.</p>\n<p>&nbsp;</p>\n<p>For reference, here is our implementation of a HightlightedTextBlock:</p>\n<p>&nbsp;</p>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">public</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">class</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">HighlightedTextBlock</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;:&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">TextBlock</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;{</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">public</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">string</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;Highlight</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">get</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;{&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">return</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;(</span><span style=\"color: blue; font-size: 7.5pt;\">string</span><span style=\"color: black; font-size: 7.5pt;\">)</span><span style=\"color: blue; font-size: 7.5pt;\">this</span><span style=\"color: black; font-size: 7.5pt;\">.GetValue(HighlightProperty);&nbsp;}</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">set</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;{&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">this</span><span style=\"color: black; font-size: 7.5pt;\">.SetValue(HighlightProperty,&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">value</span><span style=\"color: black; font-size: 7.5pt;\">);&nbsp;}</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">public</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">static</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">readonly</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">DependencyProperty</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;HighlightProperty&nbsp;=&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">DependencyProperty</span><span style=\"color: black; font-size: 7.5pt;\">.Register(</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: #a31515; font-size: 7.5pt;\">\"Highlight\"</span><span style=\"color: black; font-size: 7.5pt;\">,&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">typeof</span><span style=\"color: black; font-size: 7.5pt;\">(</span><span style=\"color: blue; font-size: 7.5pt;\">string</span><span style=\"color: black; font-size: 7.5pt;\">),&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">typeof</span><span style=\"color: black; font-size: 7.5pt;\">(</span><span style=\"color: #2b91af; font-size: 7.5pt;\">HighlightedTextBlock</span><span style=\"color: black; font-size: 7.5pt;\">),&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">new</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">PropertyMetadata</span><span style=\"color: black; font-size: 7.5pt;\">(</span><span style=\"color: blue; font-size: 7.5pt;\">string</span><span style=\"color: black; font-size: 7.5pt;\">.Empty,&nbsp;OnTextOrHighlightChanged));</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\"> </span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">public</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">string</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;RawText</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">get</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;{&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">return</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;(</span><span style=\"color: blue; font-size: 7.5pt;\">string</span><span style=\"color: black; font-size: 7.5pt;\">)</span><span style=\"color: blue; font-size: 7.5pt;\">this</span><span style=\"color: black; font-size: 7.5pt;\">.GetValue(RawTextProperty);&nbsp;}</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">set</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;{&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">this</span><span style=\"color: black; font-size: 7.5pt;\">.SetValue(RawTextProperty,&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">value</span><span style=\"color: black; font-size: 7.5pt;\">);&nbsp;}</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">public</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">static</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">readonly</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">DependencyProperty</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;RawTextProperty&nbsp;=&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">DependencyProperty</span><span style=\"color: black; font-size: 7.5pt;\">.Register(</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: #a31515; font-size: 7.5pt;\">\"RawText\"</span><span style=\"color: black; font-size: 7.5pt;\">,&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">typeof</span><span style=\"color: black; font-size: 7.5pt;\">(</span><span style=\"color: blue; font-size: 7.5pt;\">string</span><span style=\"color: black; font-size: 7.5pt;\">),&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">typeof</span><span style=\"color: black; font-size: 7.5pt;\">(</span><span style=\"color: #2b91af; font-size: 7.5pt;\">HighlightedTextBlock</span><span style=\"color: black; font-size: 7.5pt;\">),&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">new</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">PropertyMetadata</span><span style=\"color: black; font-size: 7.5pt;\">(</span><span style=\"color: blue; font-size: 7.5pt;\">string</span><span style=\"color: black; font-size: 7.5pt;\">.Empty,&nbsp;OnTextOrHighlightChanged));</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\"> </span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\"> </span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">static</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;HighlightedTextBlock()</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: green; font-size: 7.5pt;\">//TextBlock.TextProperty.AddOwner(typeof(HighlightedTextBlock),&nbsp;new&nbsp;FrameworkPropertyMetadata(string.Empty,&nbsp;OnTextOrHighlightChanged));</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DefaultStyleKeyProperty.OverrideMetadata(</span><span style=\"color: blue; font-size: 7.5pt;\">typeof</span><span style=\"color: black; font-size: 7.5pt;\">(</span><span style=\"color: #2b91af; font-size: 7.5pt;\">HighlightedTextBlock</span><span style=\"color: black; font-size: 7.5pt;\">),&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">new</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">FrameworkPropertyMetadata</span><span style=\"color: black; font-size: 7.5pt;\">(</span><span style=\"color: blue; font-size: 7.5pt;\">typeof</span><span style=\"color: black; font-size: 7.5pt;\">(</span><span style=\"color: #2b91af; font-size: 7.5pt;\">HighlightedTextBlock</span><span style=\"color: black; font-size: 7.5pt;\">)));</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\"> </span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">private</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">static</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">void</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;OnTextOrHighlightChanged(</span><span style=\"color: #2b91af; font-size: 7.5pt;\">DependencyObject</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;obj,&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">DependencyPropertyChangedEventArgs</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;args)</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">HighlightedTextBlock</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;textBlock&nbsp;=&nbsp;(</span><span style=\"color: #2b91af; font-size: 7.5pt;\">HighlightedTextBlock</span><span style=\"color: black; font-size: 7.5pt;\">)obj;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;textBlock.Inlines.Clear();</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\"> </span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">string</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;_matchPre&nbsp;=&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">string</span><span style=\"color: black; font-size: 7.5pt;\">.Empty;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">string</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;_match&nbsp;=&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">string</span><span style=\"color: black; font-size: 7.5pt;\">.Empty;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">string</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;_matchPost&nbsp;=&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">string</span><span style=\"color: black; font-size: 7.5pt;\">.Empty;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">string</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;_highlight&nbsp;=&nbsp;textBlock.Highlight;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">string</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;_text&nbsp;=&nbsp;textBlock.RawText;&nbsp;</span><span style=\"color: green; font-size: 7.5pt;\">//&nbsp;textBlock.Text;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">int</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;index&nbsp;=&nbsp;-1;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\"> </span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">if</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;(_highlight&nbsp;!=&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">null</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&amp;&amp;&nbsp;_text&nbsp;!=&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">null</span><span style=\"color: black; font-size: 7.5pt;\">)</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index&nbsp;=&nbsp;&nbsp;_text.IndexOf(_highlight,&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">StringComparison</span><span style=\"color: black; font-size: 7.5pt;\">.CurrentCultureIgnoreCase);</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\"> </span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">if</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;(index&nbsp;&lt;&nbsp;0)</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_matchPre&nbsp;=&nbsp;_text;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">else</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_matchPre&nbsp;=&nbsp;_text.Substring(0,&nbsp;index);</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_match&nbsp;=&nbsp;_text.Substring(index,&nbsp;_highlight.Length);</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_matchPost&nbsp;=&nbsp;_text.Substring(index&nbsp;+&nbsp;_highlight.Length);</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\"> </span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">if</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;(&nbsp;_matchPre&nbsp;!=&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">null</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&amp;&amp;&nbsp;_matchPre.Length&nbsp;&gt;&nbsp;0)</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;textBlock.Inlines.Add(</span><span style=\"color: blue; font-size: 7.5pt;\">new</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">Run</span><span style=\"color: black; font-size: 7.5pt;\">(_matchPre));</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">if</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;(&nbsp;_match&nbsp;!=&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">null</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&amp;&amp;&nbsp;_match.Length&nbsp;&gt;&nbsp;0)</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;textBlock.Inlines.Add(</span><span style=\"color: blue; font-size: 7.5pt;\">new</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">Run</span><span style=\"color: black; font-size: 7.5pt;\">(_match)&nbsp;{&nbsp;FontWeight&nbsp;=&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">FontWeights</span><span style=\"color: black; font-size: 7.5pt;\">.Bold&nbsp;});</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">if</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;(_matchPost&nbsp;!=&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">null</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&amp;&amp;&nbsp;_matchPost.Length&nbsp;&gt;&nbsp;0)</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;textBlock.Inlines.Add(</span><span style=\"color: blue; font-size: 7.5pt;\">new</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">Run</span><span style=\"color: black; font-size: 7.5pt;\">(_matchPost));</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\"> </span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre>\n<p>&nbsp;</p>\n<p>We experience the problem with both AutoCompleteBox and AutoCompleteBoxEx, which is a slight variation to allow the arrows keys to scroll through the default ListBox and also to allow the user to start typing after hitting an Access Key if the AutoCompleteBox is the Target of a label:</p>\n<p>&nbsp;</p>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">public</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">class</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">AutoCompleteBoxEx</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;:&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">AutoCompleteBox</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;{</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">private</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">bool</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;_selectorIsListBox&nbsp;=&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">false</span><span style=\"color: black; font-size: 7.5pt;\">;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">private</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">bool</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;_selectorSelectionChangedHandlerRegisterd&nbsp;=&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">false</span><span style=\"color: black; font-size: 7.5pt;\">;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">private</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">const</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">int</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;selectorMaxHeight&nbsp;=&nbsp;250;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">private</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">TextBox</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;_textBox;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">private</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">ListBox</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;_selector;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\"> </span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">public</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;AutoCompleteBoxEx()</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">this</span><span style=\"color: black; font-size: 7.5pt;\">.Loaded&nbsp;+=</span><span style=\"color: blue; font-size: 7.5pt;\">new</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;System.Windows.</span><span style=\"color: #2b91af; font-size: 7.5pt;\">RoutedEventHandler</span><span style=\"color: black; font-size: 7.5pt;\">(AutoCompleteBoxEx_Loaded);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\"> </span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">protected</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">override</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">void</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;OnGotFocus(System.Windows.</span><span style=\"color: #2b91af; font-size: 7.5pt;\">RoutedEventArgs</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;e)</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">base</span><span style=\"color: black; font-size: 7.5pt;\">.OnGotFocus(e);</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\"> </span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">if</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;(_textBox&nbsp;==&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">null</span><span style=\"color: black; font-size: 7.5pt;\">)</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_textBox&nbsp;=&nbsp;Template.FindName(</span><span style=\"color: #a31515; font-size: 7.5pt;\">\"Text\"</span><span style=\"color: black; font-size: 7.5pt;\">,&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">this</span><span style=\"color: black; font-size: 7.5pt;\">)&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">as</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">TextBox</span><span style=\"color: black; font-size: 7.5pt;\">;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\"> </span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">if</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;(_textBox&nbsp;!=&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">null</span><span style=\"color: black; font-size: 7.5pt;\">)</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_textBox.Focus();</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\"> </span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">protected</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">void</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;AutoCompleteBoxEx_Loaded(</span><span style=\"color: blue; font-size: 7.5pt;\">object</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;sender,&nbsp;System.Windows.</span><span style=\"color: #2b91af; font-size: 7.5pt;\">RoutedEventArgs</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;e)</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">if</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;(_selector&nbsp;==&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">null</span><span style=\"color: black; font-size: 7.5pt;\">)</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_selector&nbsp;=&nbsp;Template.FindName(</span><span style=\"color: #a31515; font-size: 7.5pt;\">\"Selector\"</span><span style=\"color: black; font-size: 7.5pt;\">,&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">this</span><span style=\"color: black; font-size: 7.5pt;\">)&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">as</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">ListBox</span><span style=\"color: black; font-size: 7.5pt;\">;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\"> </span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">if</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;(_selector&nbsp;!=&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">null</span><span style=\"color: black; font-size: 7.5pt;\">)</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_selectorIsListBox&nbsp;=&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">true</span><span style=\"color: black; font-size: 7.5pt;\">;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\"> </span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">if</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;(!_selectorSelectionChangedHandlerRegisterd&nbsp;&amp;&amp;&nbsp;_selectorIsListBox&nbsp;&amp;&amp;&nbsp;_selector&nbsp;!=&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">null</span><span style=\"color: black; font-size: 7.5pt;\">)</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_selector.SelectionChanged&nbsp;+=&nbsp;listBox_SelectionChanged;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_selector.MaxHeight&nbsp;=&nbsp;selectorMaxHeight;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_selectorSelectionChangedHandlerRegisterd&nbsp;=&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">true</span><span style=\"color: black; font-size: 7.5pt;\">;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">void</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;listBox_SelectionChanged(</span><span style=\"color: blue; font-size: 7.5pt;\">object</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;sender,&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">SelectionChangedEventArgs</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;e)</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"color: #2b91af; font-size: 7.5pt;\">ListBox</span><span style=\"color: black; font-size: 7.5pt;\">&nbsp;box&nbsp;=&nbsp;((</span><span style=\"color: #2b91af; font-size: 7.5pt;\">ListBox</span><span style=\"color: black; font-size: 7.5pt;\">)sender);&nbsp;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;box.ScrollIntoView(box.SelectedItem);&nbsp;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.Handled&nbsp;=&nbsp;</span><span style=\"color: blue; font-size: 7.5pt;\">true</span><span style=\"color: black; font-size: 7.5pt;\">;&nbsp;</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre>\n<pre><span style=\"color: black; font-size: 7.5pt;\">&nbsp;&nbsp;&nbsp;&nbsp;}</span></pre>",
    "PostedDate": "2011-03-11T10:29:24.863-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]