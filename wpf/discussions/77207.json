[
  {
    "Id": "263936",
    "ThreadId": "77207",
    "Html": "<p>Hi all,</p>\r\n<p>I'm using the chartingToolkit:LineSeries to view a dynamic list of trend values. The list has a maximum size of 100 and is refreshed two times second. That means the trend grows up to fit the whole view and than it moves from the right to left. That works fine, but only for a short time because memory and cpu usage is increasing rapidly. Did I something wrong? Here's the code:</p>\r\n<p>WPF:</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">chartingToolkit</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">Chart</span> <span style=\"color:Red\">Name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">chart</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Title</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Deviation</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">BorderThickness</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">0</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Blue\">&gt;</span>\r\n\t<span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">chartingToolkit</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">LineSeries</span> <span style=\"color:Red\">Name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">trend_x</span><span style=\"color:Black\">&quot;</span>\r\n\t\t\t<span style=\"color:Red\">ItemsSource</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding UpdateSourceTrigger=Explicit}</span><span style=\"color:Black\">&quot;</span>\r\n\t\t\t<span style=\"color:Red\">DependentValueBinding</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding X}</span><span style=\"color:Black\">&quot;</span>\r\n\t\t\t<span style=\"color:Red\">IndependentValueBinding</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding Y}</span><span style=\"color:Black\">&quot;</span>\r\n\t\t\t<span style=\"color:Red\">IndependentValuePath</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Running Meter</span><span style=\"color:Black\">&quot;</span>\r\n\t\t\t<span style=\"color:Red\">DependentValuePath</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Deviation X</span><span style=\"color:Black\">&quot;</span>\r\n\t\t\t<span style=\"color:Red\">Title</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Deviation X</span><span style=\"color:Black\">&quot;</span>\r\n\t\t\t<span style=\"color:Red\">Loaded</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">chart_Loaded</span><span style=\"color:Black\">&quot;</span>\r\n\t\t\t<span style=\"color:Red\">Height</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Auto</span><span style=\"color:Black\">&quot;</span> \r\n\t\t\t<span style=\"color:Red\">AnimationSequence</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">FirstToLast</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Blue\">&gt;</span>\r\n\t  \r\n\t\t<span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">chartingToolkit</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">LineSeries.DataPointStyle</span><span style=\"color:Blue\">&gt;</span>\r\n\t\t\t<span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">Style</span> <span style=\"color:Red\">TargetType</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">chartingToolkit:LineDataPoint</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n\t\t\t\t<span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">Setter</span> <span style=\"color:Red\">Property</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Visibility</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Collapsed</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n\t\t\t\t<span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">Setter</span> <span style=\"color:Red\">Property</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Background</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">Value</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Green</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n\t\t\t<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">Style</span><span style=\"color:Blue\">&gt;</span>\r\n\t\t<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">chartingToolkit</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">LineSeries.DataPointStyle</span><span style=\"color:Blue\">&gt;</span>\r\n\t\t\r\n\t<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">chartingToolkit</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">LineSeries</span><span style=\"color:Blue\">&gt;</span>\r\n\t<span style=\"color:Green\">&lt;!-- Shared axis --&gt;</span>\r\n\t<span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">chartingToolkit</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">Chart.Axes</span><span style=\"color:Blue\">&gt;</span>\r\n\t\t<span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">chartingToolkit</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">LinearAxis</span>\r\n\t\t\t\t\t<span style=\"color:Red\">Orientation</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">X</span><span style=\"color:Black\">&quot;</span>\r\n\t\t\t\t\t<span style=\"color:Red\">FlowDirection</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">LeftToRight</span><span style=\"color:Black\">&quot;</span>\r\n\t\t\t\t\t<span style=\"color:Red\">Title</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Running Meter</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n\t\t<span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">chartingToolkit</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">LinearAxis</span>\r\n\t\t\t\t\t<span style=\"color:Red\">Orientation</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Y</span><span style=\"color:Black\">&quot;</span>\r\n\t\t\t\t\t<span style=\"color:Red\">Maximum</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">4</span><span style=\"color:Black\">&quot;</span>\r\n\t\t\t\t\t<span style=\"color:Red\">Minimum</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">-4</span><span style=\"color:Black\">&quot;</span>\r\n\t\t\t\t\t<span style=\"color:Red\">ShowGridLines</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">True</span><span style=\"color:Black\">&quot;</span>\r\n\t\t\t\t\t<span style=\"color:Red\">Interval</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">1.0</span><span style=\"color:Black\">&quot;</span> \r\n\t\t\t\t\t<span style=\"color:Red\">Title</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Deviation</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n\t<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">chartingToolkit</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">Chart.Axes</span><span style=\"color:Blue\">&gt;</span> \r\n<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">chartingToolkit</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">Chart</span><span style=\"color:Blue\">&gt;</span>\t\t\t\t\r\n\r\n</pre>\r\n</div>\r\n</p>\r\n<p>Code behind:</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">private</span> <span style=\"color:Blue\">void</span> chart_Loaded(<span style=\"color:Blue\">object</span> sender, System.Windows.RoutedEventArgs e)\r\n{\r\n    <span style=\"color:Blue\">if</span> (trend_x.ItemsSource == <span style=\"color:Blue\">null</span>)\r\n    {\r\n        trend_x.ItemsSource = TrendSimulation.List_X;\r\n        TrendSimulation.Trend_x = trend_x;\r\n        TrendSimulation.startThread();\r\n    }\r\n}\r\n\r\n</pre>\r\n</div>\r\n</p>\r\n<p>Value simulation thread including the refresh call:</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">private</span> <span style=\"color:Blue\">static</span> <span style=\"color:Blue\">void</span> ThreadFunc()\r\n{\r\n    <span style=\"color:Blue\">while</span> (<span style=\"color:Blue\">true</span>)\r\n    {\r\n        sign = random.NextDouble() &gt; 0.5 ? 4 : -4;\r\n        DataItem d_x = <span style=\"color:Blue\">new</span> DataItem(r, Math.Round(random.NextDouble() * sign, 2));\r\n        list_x.add(d_x);\r\n        r += 0.4;\r\n\r\n        <span style=\"color:Blue\">if</span> (trend_x != <span style=\"color:Blue\">null</span>)\r\n        {\r\n            trend_x.Dispatcher.Invoke(\r\n                System.Windows.Threading.DispatcherPriority.Normal, <span style=\"color:Blue\">new</span> Action(\r\n                <span style=\"color:Blue\">delegate</span>()\r\n                {\r\n                    trend_x.Refresh();\r\n                }\r\n            ));\r\n        }\r\n\r\n        \r\n        Thread.Sleep(500);\r\n    }\r\n}\r\n</pre>\r\n</div>\r\n</p>\r\n<p>And the List class:</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">class</span> DataList : List&lt;DataItem&gt;\r\n{\r\n    <span style=\"color:Blue\">private</span> <span style=\"color:Blue\">int</span> size = 100;\r\n\r\n    <span style=\"color:Blue\">public</span> DataList()\r\n    {\r\n        <span style=\"color:Blue\">this</span>.Capacity = size;\r\n    }\r\n\r\n    <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">int</span> Size\r\n    {\r\n        <span style=\"color:Blue\">get</span> { <span style=\"color:Blue\">return</span> size; }\r\n        <span style=\"color:Blue\">set</span> { size = value; <span style=\"color:Blue\">this</span>.Capacity = size;}\r\n    }\r\n\r\n    <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">void</span> add(DataItem item)\r\n    {\r\n        <span style=\"color:Blue\">if</span> (Count &gt;= Size)\r\n        {\r\n            RemoveAt(0);\r\n        }\r\n        Add(item);\r\n    }\r\n\r\n}\r\n\r\n<span style=\"color:Blue\">public</span> <span style=\"color:Blue\">class</span> DataItem\r\n{\r\n    <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">double</span> Y { <span style=\"color:Blue\">get</span>; <span style=\"color:Blue\">private</span> <span style=\"color:Blue\">set</span>; }\r\n    <span style=\"color:Blue\">public</span> <span style=\"color:Blue\">double</span> X { <span style=\"color:Blue\">get</span>; <span style=\"color:Blue\">private</span> <span style=\"color:Blue\">set</span>; }\r\n    <span style=\"color:Blue\">public</span> DataItem(<span style=\"color:Blue\">double</span> y, <span style=\"color:Blue\">double</span> x)\r\n    {\r\n        Y = y;\r\n        X = x;\r\n    }\r\n}\r\n\r\n</pre>\r\n</div>\r\n</p>\r\n<p>Any help is highly appreciated.</p>\r\n<p>&nbsp;</p>\r\n<p>Thanks</p>\r\n<p>Manni</p>",
    "PostedDate": "2009-12-05T07:23:23.653-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]