[
  {
    "Id": "260131",
    "ThreadId": "76056",
    "Html": "<p>As the title says, there is a combobox custom column in DataGrid,</p>\r\n<p>when the IsVirtulizing is set to true, after the scroll of DataGrid,</p>\r\n<p>there is no selected item in ComboBox.</p>\r\n<p>The first item should selected in default, which is defined in the DateTemplate.</p>\r\n<p>Following is the link of demo program.</p>\r\n<p>http://dl.dropbox.com/u/1526548/ComboBoxInDataGrid.zip</p>\r\n<p>Following is the XAML and code.</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>  <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">Window.Resources</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">DataTemplate</span> <span style=\"color:Red\">x:Key</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">myComboBox</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">ComboBox</span> <span style=\"color:Red\">x:Name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">colEdit</span><span style=\"color:Black\">&quot;</span>\r\n                     <span style=\"color:Red\">ItemsSource</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding Path=GenderList}</span><span style=\"color:Black\">&quot;</span>\r\n                                       <span style=\"color:Red\">SelectedValuePath</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">[1]</span><span style=\"color:Black\">&quot;</span>\r\n                                       <span style=\"color:Red\">DisplayMemberPath</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">[1]</span><span style=\"color:Black\">&quot;</span>\r\n                                       <span style=\"color:Red\">VerticalContentAlignment</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Center</span><span style=\"color:Black\">&quot;</span>\r\n                                       <span style=\"color:Red\">SelectedIndex</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">0</span><span style=\"color:Black\">&quot;</span>\r\n                                       <span style=\"color:Red\">HorizontalAlignment</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Stretch</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">ComboBox</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">DataTemplate</span><span style=\"color:Blue\">&gt;</span>\r\n    <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">Window.Resources</span><span style=\"color:Blue\">&gt;</span>\r\n    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">Grid</span> <span style=\"color:Red\">Name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Grid1</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">dg</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGrid</span> \r\n                     <span style=\"color:Red\">x:Name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">DataGrid1</span><span style=\"color:Black\">&quot;</span>\r\n                     <span style=\"color:Red\">SelectionMode</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Single</span><span style=\"color:Black\">&quot;</span>\r\n                     <span style=\"color:Red\">SelectionUnit</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">FullRow</span><span style=\"color:Black\">&quot;</span> \r\n                     <span style=\"color:Red\">AutoGenerateColumns</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">False</span><span style=\"color:Black\">&quot;</span>   \r\n                     <span style=\"color:Red\">CanUserAddRows</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">False</span><span style=\"color:Black\">&quot;</span>\r\n                     <span style=\"color:Red\">CanUserDeleteRows</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">False</span><span style=\"color:Black\">&quot;</span>\r\n                     <span style=\"color:Red\">CanUserReorderColumns</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">False</span><span style=\"color:Black\">&quot;</span>\r\n                  <span style=\"color:Red\">VirtualizingStackPanel.IsVirtualizing</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">True</span><span style=\"color:Black\">&quot;</span> \r\n                      <span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">dg</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGrid.Columns</span><span style=\"color:Blue\">&gt;</span>\r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">dg</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGridTextColumn</span> <span style=\"color:Red\">Binding</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{Binding Path=Name}</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Blue\">/&gt;</span> \r\n                <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">dg</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGridTemplateColumn</span> <span style=\"color:Red\">x:Name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">dgColNormal</span><span style=\"color:Black\">&quot;</span>\r\n                                           <span style=\"color:Red\">Header</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">Gender</span><span style=\"color:Black\">&quot;</span>\r\n                                           <span style=\"color:Red\">Width</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">88.27</span><span style=\"color:Black\">&quot;</span>\r\n                                           <span style=\"color:Red\">CellTemplate</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">{StaticResource myComboBox}</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n\r\n            <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">dg</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGrid.Columns</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">dg</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">DataGrid</span><span style=\"color:Blue\">&gt;</span>\r\n    <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">Grid</span><span style=\"color:Blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>\r\n<span style=\"color:Blue\">Imports</span> System.ComponentModel\r\n<span style=\"color:Blue\">Imports</span> System.Collections.ObjectModel\r\n\r\n<span style=\"color:Blue\">Public</span> <span style=\"color:Blue\">Class</span> MyDataItem\r\n    <span style=\"color:Blue\">Implements</span> INotifyPropertyChanged\r\n\r\n    <span style=\"color:Blue\">Public</span> <span style=\"color:Blue\">Event</span> PropertyChanged <span style=\"color:Blue\">As</span> PropertyChangedEventHandler _\r\n                 <span style=\"color:Blue\">Implements</span> INotifyPropertyChanged.PropertyChanged\r\n\r\n    <span style=\"color:Blue\">Private</span> <span style=\"color:Blue\">Sub</span> NotifyPropertyChanged(<span style=\"color:Blue\">ByVal</span> info <span style=\"color:Blue\">As</span> <span style=\"color:Blue\">String</span>)\r\n        <span style=\"color:Blue\">Try</span>\r\n            <span style=\"color:Blue\">RaiseEvent</span> PropertyChanged(<span style=\"color:Blue\">Me</span>, <span style=\"color:Blue\">New</span> PropertyChangedEventArgs(info))\r\n        <span style=\"color:Blue\">Finally</span>\r\n\r\n        <span style=\"color:Blue\">End</span> <span style=\"color:Blue\">Try</span>\r\n    <span style=\"color:Blue\">End</span> <span style=\"color:Blue\">Sub</span>\r\n\r\n    <span style=\"color:Blue\">Private</span> m_Name <span style=\"color:Blue\">As</span> <span style=\"color:Blue\">String</span>\r\n\r\n    <span style=\"color:Blue\">Private</span> m_GenerList <span style=\"color:Blue\">As</span> List(Of <span style=\"color:Blue\">String</span>())\r\n\r\n    <span style=\"color:Blue\">Public</span> <span style=\"color:Blue\">Property</span> Name() <span style=\"color:Blue\">As</span> <span style=\"color:Blue\">String</span>\r\n        <span style=\"color:Blue\">Get</span>\r\n            <span style=\"color:Blue\">Return</span> m_Name\r\n        <span style=\"color:Blue\">End</span> <span style=\"color:Blue\">Get</span>\r\n        <span style=\"color:Blue\">Set</span>(<span style=\"color:Blue\">ByVal</span> value <span style=\"color:Blue\">As</span> <span style=\"color:Blue\">String</span>)\r\n            m_Name = value\r\n        <span style=\"color:Blue\">End</span> <span style=\"color:Blue\">Set</span>\r\n    <span style=\"color:Blue\">End</span> <span style=\"color:Blue\">Property</span>\r\n\r\n    <span style=\"color:Blue\">Public</span> <span style=\"color:Blue\">Property</span> GenderList() <span style=\"color:Blue\">As</span> List(Of <span style=\"color:Blue\">String</span>())\r\n        <span style=\"color:Blue\">Get</span>\r\n            <span style=\"color:Blue\">Return</span> m_GenerList\r\n        <span style=\"color:Blue\">End</span> <span style=\"color:Blue\">Get</span>\r\n        <span style=\"color:Blue\">Set</span>(<span style=\"color:Blue\">ByVal</span> value <span style=\"color:Blue\">As</span> List(Of <span style=\"color:Blue\">String</span>()))\r\n\r\n        <span style=\"color:Blue\">End</span> <span style=\"color:Blue\">Set</span>\r\n    <span style=\"color:Blue\">End</span> <span style=\"color:Blue\">Property</span>\r\n\r\n    <span style=\"color:Blue\">Public</span> <span style=\"color:Blue\">Sub</span> <span style=\"color:Blue\">New</span>()\r\n        <span style=\"color:Blue\">Dim</span> unknown(1) <span style=\"color:Blue\">As</span> <span style=\"color:Blue\">String</span>\r\n        unknown(0) = <span style=\"color:#A31515\">&quot;U&quot;</span>\r\n        unknown(1) = <span style=\"color:#A31515\">&quot;Unknown&quot;</span>\r\n        m_GenerList = <span style=\"color:Blue\">New</span> List(Of <span style=\"color:Blue\">String</span>())\r\n        m_GenerList.Add(unknown)\r\n\r\n        <span style=\"color:Blue\">Dim</span> Male(1) <span style=\"color:Blue\">As</span> <span style=\"color:Blue\">String</span>\r\n        Male(0) = <span style=\"color:#A31515\">&quot;M&quot;</span>\r\n        Male(1) = <span style=\"color:#A31515\">&quot;Male&quot;</span>\r\n        m_GenerList.Add(Male)\r\n\r\n        <span style=\"color:Blue\">Dim</span> Female(1) <span style=\"color:Blue\">As</span> <span style=\"color:Blue\">String</span>\r\n        Female(0) = <span style=\"color:#A31515\">&quot;F&quot;</span>\r\n        Female(1) = <span style=\"color:#A31515\">&quot;Female&quot;</span>\r\n        m_GenerList.Add(Female)\r\n\r\n\r\n    <span style=\"color:Blue\">End</span> <span style=\"color:Blue\">Sub</span>\r\n<span style=\"color:Blue\">End</span> <span style=\"color:Blue\">Class</span>\r\n\r\n</pre>\r\n</div>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">Imports</span> System.Collections.ObjectModel\r\n\r\n<span style=\"color:Blue\">Class</span> Window1\r\n\r\n    <span style=\"color:Blue\">Private</span> <span style=\"color:Blue\">Sub</span> Grid1_Loaded(<span style=\"color:Blue\">ByVal</span> sender <span style=\"color:Blue\">As</span> System.Object, <span style=\"color:Blue\">ByVal</span> e <span style=\"color:Blue\">As</span> System.Windows.RoutedEventArgs) <span style=\"color:Blue\">Handles</span> Grid1.Loaded\r\n        <span style=\"color:Blue\">Dim</span> dataGridItemSource <span style=\"color:Blue\">As</span> <span style=\"color:Blue\">New</span> ObservableCollection(Of MyDataItem)\r\n\r\n        <span style=\"color:Blue\">For</span> i <span style=\"color:Blue\">As</span> <span style=\"color:Blue\">Integer</span> = 0 <span style=\"color:Blue\">To</span> 100\r\n            <span style=\"color:Blue\">Dim</span> itemData <span style=\"color:Blue\">As</span> <span style=\"color:Blue\">New</span> MyDataItem\r\n            itemData.Name = <span style=\"color:#A31515\">&quot;User &quot;</span> &amp; i\r\n            dataGridItemSource.Add(itemData)\r\n        <span style=\"color:Blue\">Next</span> i\r\n        <span style=\"color:Blue\">Me</span>.DataGrid1.ItemsSource = dataGridItemSource\r\n    <span style=\"color:Blue\">End</span> <span style=\"color:Blue\">Sub</span>\r\n<span style=\"color:Blue\">End</span> <span style=\"color:Blue\">Class</span>\r\n</pre>\r\n</div>\r\n</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-11-24T00:45:00.78-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]