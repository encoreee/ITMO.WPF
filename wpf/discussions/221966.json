[
  {
    "Id": "474641",
    "ThreadId": "221966",
    "Html": "<p>Hello,</p>\r\n<p>I have a simple WPF application in which there is a datagrid. I want to populate it when I click a button:</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre><span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> buttonTest_Click(<span style=\"color:blue\">object</span> sender, RoutedEventArgs e)\r\n        {\r\n\r\n            File files = <span style=\"color:blue\">new</span> File(<span style=\"color:blue\">this</span>.textBoxScegliSorgente.Text, datePicker.SelectedDate.Value);\r\n            <span style=\"color:blue\">this</span>.dataGridElencoFiles.DataContext = files;\r\n        }\r\nThe File Class is this:</pre>\r\n<pre><div style=\"color:black;background-color:white\"><pre><span style=\"color:blue\">using</span> System;\r\n<span style=\"color:blue\">using</span> System.Collections.Generic;\r\n<span style=\"color:blue\">using</span> System.Linq;\r\n<span style=\"color:blue\">using</span> System.Text;\r\n<span style=\"color:blue\">using</span> System.IO;\r\n<span style=\"color:blue\">using</span> System.Security.AccessControl;\r\n<span style=\"color:blue\">using</span> System.Reflection;\r\n<span style=\"color:blue\">using</span> System.Collections;\r\n<span style=\"color:blue\">using</span> System.ComponentModel;\r\n\r\n<span style=\"color:blue\">namespace</span> ArchiviazioneVecchiDocumenti\r\n{\r\n    <span style=\"color:blue\">public</span> <span style=\"color:blue\">class</span> File\r\n    {\r\n\r\n        <span style=\"color:blue\">private</span> List&lt;<span style=\"color:blue\">string</span>&gt; percorso = <span style=\"color:blue\">new</span> List&lt;<span style=\"color:blue\">string</span>&gt;();\r\n        <span style=\"color:blue\">public</span> List&lt;<span style=\"color:blue\">string</span>&gt; Percorso\r\n        { <span style=\"color:blue\">get</span> { <span style=\"color:blue\">return</span> percorso; } }\r\n        <span style=\"color:blue\">private</span> List&lt;<span style=\"color:blue\">string</span>&gt; nomeFile = <span style=\"color:blue\">new</span> List&lt;<span style=\"color:blue\">string</span>&gt;();\r\n        <span style=\"color:blue\">public</span> List&lt;<span style=\"color:blue\">string</span>&gt; NomeFile\r\n        { <span style=\"color:blue\">get</span> { <span style=\"color:blue\">return</span> nomeFile; } }\r\n        <span style=\"color:blue\">private</span> List&lt;DateTime&gt; dataUltimaModifica = <span style=\"color:blue\">new</span> List&lt;DateTime&gt;();\r\n        <span style=\"color:blue\">public</span> List&lt;DateTime&gt; DataUltimaModifica\r\n        { <span style=\"color:blue\">get</span> { <span style=\"color:blue\">return</span> dataUltimaModifica; } }\r\n        <span style=\"color:blue\">private</span> List&lt;DateTime&gt; dataUltimoAccesso = <span style=\"color:blue\">new</span> List&lt;DateTime&gt;();\r\n        <span style=\"color:blue\">public</span> List&lt;DateTime&gt; DataUltimoAccesso\r\n        { <span style=\"color:blue\">get</span> { <span style=\"color:blue\">return</span> dataUltimoAccesso; } }\r\n        <span style=\"color:blue\">private</span> List&lt;<span style=\"color:blue\">long</span>&gt; dimensione = <span style=\"color:blue\">new</span> List&lt;<span style=\"color:blue\">long</span>&gt;();\r\n        <span style=\"color:blue\">public</span> List&lt;<span style=\"color:blue\">long</span>&gt; Dimensione\r\n        { <span style=\"color:blue\">get</span> { <span style=\"color:blue\">return</span> dimensione; } }\r\n        <span style=\"color:blue\">private</span> List&lt;<span style=\"color:blue\">string</span>&gt; logErrori = <span style=\"color:blue\">new</span> List&lt;<span style=\"color:blue\">string</span>&gt;();\r\n        <span style=\"color:blue\">public</span> List&lt;<span style=\"color:blue\">string</span>&gt; LogErrori\r\n        { <span style=\"color:blue\">get</span> { <span style=\"color:blue\">return</span> logErrori; } }\r\n\r\n        <span style=\"color:green\">/*  campi recuperati provvisori */</span>\r\n        <span style=\"color:blue\">private</span> DirectoryInfo sorgente;\r\n        <span style=\"color:blue\">private</span> DirectoryInfo destinazione;\r\n        <span style=\"color:blue\">private</span> DateTime data;\r\n        <span style=\"color:blue\">private</span> <span style=\"color:blue\">string</span> radioscelta;\r\n        <span style=\"color:blue\">private</span> <span style=\"color:blue\">bool</span> test;\r\n        <span style=\"color:blue\">private</span> DirectoryInfo[] directories;\r\n        <span style=\"color:blue\">private</span> FileInfo[] filesInDir;\r\n        <span style=\"color:blue\">private</span> WshShellClass WshShell;\r\n\r\n\r\n        <span style=\"color:blue\">public</span> File(<span style=\"color:blue\">string</span> sorgente, DateTime data)\r\n        {\r\n            <span style=\"color:blue\">this</span>.sorgente = <span style=\"color:blue\">new</span> DirectoryInfo(sorgente);\r\n            <span style=\"color:blue\">this</span>.data = data;\r\n            <span style=\"color:blue\">this</span>.test = <span style=\"color:blue\">true</span>;\r\n            ExploreDirectory(<span style=\"color:blue\">this</span>.sorgente);\r\n        }\r\n        <span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> ExploreDirectory(DirectoryInfo dir)\r\n        {\r\n            <span style=\"color:blue\">try</span>\r\n            {\r\n                <span style=\"color:blue\">this</span>.filesInDir = dir.GetFiles();\r\n\r\n            }\r\n            <span style=\"color:blue\">catch</span> (Exception e)\r\n            {\r\n\r\n                <span style=\"color:blue\">this</span>.logErrori.Add(e.Message[0].ToString());\r\n\r\n            }\r\n            <span style=\"color:blue\">foreach</span> (FileInfo file <span style=\"color:blue\">in</span> filesInDir)\r\n            {\r\n                <span style=\"color:blue\">if</span> (file.Extension != <span style=\"color:#a31515\">&quot;.lnk&quot;</span>)\r\n                {\r\n                    <span style=\"color:blue\">if</span> (file.LastWriteTime &lt; <span style=\"color:blue\">this</span>.data)\r\n                    {\r\n                        <span style=\"color:blue\">if</span> (<span style=\"color:blue\">this</span>.test == <span style=\"color:blue\">true</span>)\r\n                        {\r\n\r\n                            <span style=\"color:blue\">try</span>\r\n                            {\r\n                                List&lt;<span style=\"color:blue\">string</span>&gt; veraPathLunga = <span style=\"color:blue\">new</span> List&lt;<span style=\"color:blue\">string</span>&gt;();\r\n                                veraPathLunga.Add(dir.Name + &quot;\\\\&quot;);\r\n\r\n                                DirectoryInfo temp = dir;\r\n                                <span style=\"color:blue\">while</span> (temp.Name != <span style=\"color:blue\">this</span>.sorgente.Name)\r\n                                {\r\n                                    veraPathLunga.Add(temp.Parent.ToString() + &quot;\\\\&quot;);\r\n                                    temp = temp.Parent;\r\n                                }\r\n                                veraPathLunga.Reverse();\r\n                                veraPathLunga[0] = <span style=\"color:blue\">this</span>.sorgente.FullName;\r\n                                <span style=\"color:blue\">string</span> percorsoFileUnito = <span style=\"color:blue\">string</span>.Join(<span style=\"color:#a31515\">&quot;&quot;</span>, veraPathLunga.ToArray());\r\n                                <span style=\"color:blue\">this</span>.percorso.Add(percorsoFileUnito);\r\n                                <span style=\"color:blue\">this</span>.nomeFile.Add(file.Name);\r\n                                <span style=\"color:blue\">this</span>.dimensione.Add(file.Length);\r\n                                <span style=\"color:blue\">this</span>.dataUltimaModifica.Add(file.LastWriteTime);\r\n                                <span style=\"color:blue\">this</span>.dataUltimoAccesso.Add(file.LastAccessTime);\r\n                            }\r\n                            <span style=\"color:blue\">catch</span> (Exception e)\r\n                            {\r\n\r\n                                <span style=\"color:blue\">this</span>.logErrori.Add(e.Message[0].ToString());\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n\r\n            <span style=\"color:blue\">try</span>\r\n            {\r\n                <span style=\"color:blue\">this</span>.directories = dir.GetDirectories();\r\n            }\r\n            <span style=\"color:blue\">catch</span> (Exception e)\r\n            {\r\n                <span style=\"color:blue\">this</span>.logErrori.Add(dir.Name + <span style=\"color:#a31515\">&quot;   &quot;</span> + e.Message[0].ToString());\r\n            }\r\n\r\n            <span style=\"color:blue\">foreach</span> (DirectoryInfo newDir <span style=\"color:blue\">in</span> <span style=\"color:blue\">this</span>.directories)\r\n            {\r\n                ExploreDirectory(newDir);\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n}\r\n<div style=\"color:black;background-color:white\"><pre>This is the XAML</pre>\r\n<pre>&lt;Window x:Class=<span style=\"color:#a31515\">&quot;ArchiviazioneVecchiDocumenti.Principale&quot;</span>\r\n    xmlns=<span style=\"color:#a31515\">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span>\r\n    xmlns:x=<span style=\"color:#a31515\">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span>\r\n        xmlns:wf=<span style=\"color:#a31515\">&quot;clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms&quot;</span> \r\n        xmlns:app=<span style=\"color:#a31515\">&quot;clr-namespace:ArchiviazioneVecchiDocumenti&quot;</span>\r\n        xmlns:my=<span style=\"color:#a31515\">&quot;http://schemas.microsoft.com/wpf/2008/toolkit&quot;</span>\r\n        \r\n    Title=<span style=\"color:#a31515\">&quot;Principale&quot;</span> Height=<span style=\"color:#a31515\">&quot;600&quot;</span> Width=<span style=\"color:#a31515\">&quot;800&quot;</span> &gt;\r\n    &lt;Window.Resources&gt;\r\n        &lt;!--&lt;ObjectDataProvider x:Key=<span style=\"color:#a31515\">&quot;filesWpf&quot;</span> ObjectType=<span style=\"color:#a31515\">&quot;{x:Type app:File}&quot;</span>/&gt;\r\n        &lt;app:File x:Key=<span style=\"color:#a31515\">&quot;fileBinding&quot;</span>/&gt;--&gt;\r\n    &lt;/Window.Resources&gt;\r\n    &lt;Grid&gt;\r\n        &lt;Grid.RowDefinitions&gt;\r\n            &lt;RowDefinition Height=<span style=\"color:#a31515\">&quot;auto&quot;</span>/&gt;\r\n            &lt;RowDefinition Height=<span style=\"color:#a31515\">&quot;*&quot;</span>/&gt;\r\n        &lt;/Grid.RowDefinitions&gt;\r\n        &lt;DockPanel Grid.Row=<span style=\"color:#a31515\">&quot;0&quot;</span>&gt;\r\n            &lt;ToolBarTray DockPanel.Dock=<span style=\"color:#a31515\">&quot;Top&quot;</span> Background=<span style=\"color:#a31515\">&quot;LightGray&quot;</span>&gt;\r\n                &lt;ToolBar Name=<span style=\"color:#a31515\">&quot;ButtonBar&quot;</span> Band=<span style=\"color:#a31515\">&quot;0&quot;</span> BandIndex=<span style=\"color:#a31515\">&quot;0&quot;</span> &gt;                    \r\n                        &lt;Grid VerticalAlignment=<span style=\"color:#a31515\">&quot;Center&quot;</span>&gt;\r\n                            &lt;Grid.RowDefinitions&gt;\r\n                                &lt;RowDefinition Height=<span style=\"color:#a31515\">&quot;auto&quot;</span>/&gt;\r\n                                &lt;RowDefinition Height=<span style=\"color:#a31515\">&quot;auto&quot;</span>/&gt;\r\n                            &lt;/Grid.RowDefinitions&gt;\r\n                            &lt;Grid.ColumnDefinitions&gt;\r\n                                &lt;ColumnDefinition Width=<span style=\"color:#a31515\">&quot;auto&quot;</span>/&gt;\r\n                                &lt;ColumnDefinition Width=<span style=\"color:#a31515\">&quot;auto&quot;</span>/&gt;\r\n                            &lt;/Grid.ColumnDefinitions&gt;\r\n                            &lt;Button Height=<span style=\"color:#a31515\">&quot;23&quot;</span> Name=<span style=\"color:#a31515\">&quot;buttonSceglisorgente&quot;</span>   Click=<span style=\"color:#a31515\">&quot;buttonScegliSorgente_Click&quot;</span> ToolTip=<span style=\"color:#a31515\">&quot;scegli la cartella o il disco locale in cui vuoi cercare i files da archiviare.&quot;</span> Grid.Row=<span style=\"color:#a31515\">&quot;0&quot;</span> Grid.Column=<span style=\"color:#a31515\">&quot;0&quot;</span>&gt;Scegli cartella Sorgente&lt;/Button&gt;\r\n                            &lt;TextBox  Height=<span style=\"color:#a31515\">&quot;23&quot;</span> Name=<span style=\"color:#a31515\">&quot;textBoxScegliSorgente&quot;</span>  Width=<span style=\"color:#a31515\">&quot;334&quot;</span>  Grid.Row=<span style=\"color:#a31515\">&quot;0&quot;</span> Grid.Column=<span style=\"color:#a31515\">&quot;1&quot;</span> ToolTip=<span style=\"color:#a31515\">&quot;scegli la cartella o il disco locale in cui vuoi cercare i files da archiviare.&quot;</span> IsEnabled=<span style=\"color:#a31515\">&quot;False&quot;</span>/&gt;\r\n                            &lt;Button Height=<span style=\"color:#a31515\">&quot;23&quot;</span>   Name=<span style=\"color:#a31515\">&quot;buttonScegliCestino&quot;</span>  Click=<span style=\"color:#a31515\">&quot;buttonScegliCestino_Click&quot;</span> ToolTip=<span style=\"color:#a31515\">&quot;Scegli la cartella in cuo vuoi mettere i files obsoleti.&quot;</span> Grid.Row=<span style=\"color:#a31515\">&quot;1&quot;</span> Grid.Column=<span style=\"color:#a31515\">&quot;0&quot;</span>&gt;Scegli cartella Destinazione&lt;/Button&gt;\r\n                            &lt;TextBox  Height=<span style=\"color:#a31515\">&quot;23&quot;</span> Name=<span style=\"color:#a31515\">&quot;textBoxSelectCestino&quot;</span>  Width=<span style=\"color:#a31515\">&quot;334&quot;</span>  Grid.Row=<span style=\"color:#a31515\">&quot;1&quot;</span> Grid.Column=<span style=\"color:#a31515\">&quot;1&quot;</span> ToolTip=<span style=\"color:#a31515\">&quot;Scegli la cartella in cuo vuoi mettere i files obsoleti.&quot;</span> IsEnabled=<span style=\"color:#a31515\">&quot;False&quot;</span>/&gt;\r\n                        &lt;/Grid&gt;\r\n                &lt;/ToolBar&gt;\r\n                &lt;ToolBar Name=<span style=\"color:#a31515\">&quot;kk&quot;</span> Band=<span style=\"color:#a31515\">&quot;0&quot;</span>&gt;\r\n                    &lt;Grid VerticalAlignment=<span style=\"color:#a31515\">&quot;Center&quot;</span>&gt;\r\n                        &lt;Grid.RowDefinitions&gt;\r\n                            &lt;RowDefinition Height=<span style=\"color:#a31515\">&quot;auto&quot;</span>/&gt;\r\n                            &lt;RowDefinition Height=<span style=\"color:#a31515\">&quot;auto&quot;</span>/&gt;\r\n                        &lt;/Grid.RowDefinitions&gt;\r\n                        &lt;Grid.ColumnDefinitions&gt;\r\n                            &lt;ColumnDefinition Width=<span style=\"color:#a31515\">&quot;auto&quot;</span>/&gt;\r\n                            &lt;ColumnDefinition Width=<span style=\"color:#a31515\">&quot;auto&quot;</span>/&gt;\r\n                        &lt;/Grid.ColumnDefinitions&gt;\r\n                        &lt;my:DatePicker Height=<span style=\"color:#a31515\">&quot;25&quot;</span> HorizontalAlignment=<span style=\"color:#a31515\">&quot;Center&quot;</span>  Name=<span style=\"color:#a31515\">&quot;datePicker&quot;</span>  Width=<span style=\"color:#a31515\">&quot;130&quot;</span> Grid.Row=<span style=\"color:#a31515\">&quot;0&quot;</span> Grid.Column=<span style=\"color:#a31515\">&quot;0&quot;</span>/&gt;\r\n                        &lt;StackPanel Grid.Row=<span style=\"color:#a31515\">&quot;1&quot;</span> Grid.Column=<span style=\"color:#a31515\">&quot;0&quot;</span>&gt;\r\n                            &lt;RadioButton IsChecked=<span style=\"color:#a31515\">&quot;True&quot;</span>  Name=<span style=\"color:#a31515\">&quot;radioButtonAccesso&quot;</span> ToolTip=<span style=\"color:#a31515\">&quot;Archiviazione in base alla data dell'ultimo accesso al file.&quot;</span> &gt;Data Ultimo Accesso&lt;/RadioButton&gt;\r\n                            &lt;RadioButton   Name=<span style=\"color:#a31515\">&quot;radioButtonModifica&quot;</span> ToolTip=<span style=\"color:#a31515\">&quot;Archiviazione in base alla data dell'ultima modifica.&quot;</span> &gt;Data Ultima Modifica&lt;/RadioButton&gt;\r\n                        &lt;/StackPanel&gt;                        \r\n                        &lt;Button Height=<span style=\"color:#a31515\">&quot;30&quot;</span> Width=<span style=\"color:#a31515\">&quot;60&quot;</span>  Name=<span style=\"color:#a31515\">&quot;buttonTest&quot;</span> ToolTip=<span style=\"color:#a31515\">&quot;Esegui un test per vedere quanti files puoi archiviare&quot;</span> Grid.Row=<span style=\"color:#a31515\">&quot;0&quot;</span> Grid.Column=<span style=\"color:#a31515\">&quot;1&quot;</span> Click=<span style=\"color:#a31515\">&quot;buttonTest_Click&quot;</span>&gt;Test&lt;/Button&gt;\r\n                        &lt;Button  Height=<span style=\"color:#a31515\">&quot;30&quot;</span> Width=<span style=\"color:#a31515\">&quot;60&quot;</span> ToolTip=<span style=\"color:#a31515\">&quot;Procedi all'archiviazione dei vecchi documenti.&quot;</span> Grid.Row=<span style=\"color:#a31515\">&quot;1&quot;</span> Grid.Column=<span style=\"color:#a31515\">&quot;1&quot;</span> Click=<span style=\"color:#a31515\">&quot;buttonProcedi_Click&quot;</span>&gt;Procedi&lt;/Button&gt;\r\n                    &lt;/Grid&gt;\r\n                &lt;/ToolBar&gt;\r\n            &lt;/ToolBarTray&gt;\r\n        &lt;/DockPanel&gt;        \r\n        &lt;TabControl Name=<span style=\"color:#a31515\">&quot;tabControl1&quot;</span> Grid.Row=<span style=\"color:#a31515\">&quot;1&quot;</span> Margin=<span style=\"color:#a31515\">&quot;0,10,0,0&quot;</span>&gt;\r\n            &lt;TabItem Header=<span style=\"color:#a31515\">&quot;Elenco Files&quot;</span> Name=<span style=\"color:#a31515\">&quot;tabelencoFile&quot;</span>&gt;\r\n                &lt;Grid&gt;\r\n                    &lt;!--&lt;my:DataGrid  ItemsSource=<span style=\"color:#a31515\">&quot;{Binding Source={StaticResource fileBinding}}&quot;</span> HorizontalAlignment=<span style=\"color:#a31515\">&quot;Stretch&quot;</span> Margin=<span style=\"color:#a31515\">&quot;5&quot;</span> Name=<span style=\"color:#a31515\">&quot;dataGridElencoFiles&quot;</span>    &gt;--&gt;\r\n                    &lt;my:DataGrid  ItemsSource=<span style=\"color:#a31515\">&quot;{Binding}&quot;</span> AutoGenerateColumns=<span style=\"color:#a31515\">&quot;True&quot;</span> HorizontalAlignment=<span style=\"color:#a31515\">&quot;Stretch&quot;</span> Margin=<span style=\"color:#a31515\">&quot;5&quot;</span> Name=<span style=\"color:#a31515\">&quot;dataGridElencoFiles&quot;</span>    &gt;    \r\n                    &lt;!--&lt;my:DataGrid.Columns&gt;\r\n                            &lt;my:DataGridTextColumn Header=<span style=\"color:#a31515\">&quot;Percorso&quot;</span>  Width=<span style=\"color:#a31515\">&quot;SizeToCells&quot;</span> Binding=<span style=\"color:#a31515\">&quot;{Binding Percorso}&quot;</span> IsReadOnly=<span style=\"color:#a31515\">&quot;True&quot;</span>/&gt;\r\n                            &lt;my:DataGridTextColumn Header=<span style=\"color:#a31515\">&quot;Nome File&quot;</span> Width=<span style=\"color:#a31515\">&quot;SizeToCells&quot;</span> Binding=<span style=\"color:#a31515\">&quot;{Binding NomeFile}&quot;</span> IsReadOnly=<span style=\"color:#a31515\">&quot;True&quot;</span>/&gt;\r\n\r\n                        &lt;/my:DataGrid.Columns&gt;--&gt;\r\n                    &lt;/my:DataGrid&gt;\r\n                &lt;/Grid&gt;\r\n            &lt;/TabItem&gt;\r\n            &lt;TabItem Header=<span style=\"color:#a31515\">&quot;Elenco Errori&quot;</span> Name=<span style=\"color:#a31515\">&quot;tabElencoErrori&quot;</span>&gt;\r\n                &lt;Grid&gt;\r\n                    &lt;my:DataGrid AutoGenerateColumns=<span style=\"color:#a31515\">&quot;False&quot;</span> HorizontalAlignment=<span style=\"color:#a31515\">&quot;Stretch&quot;</span> Margin=<span style=\"color:#a31515\">&quot;5&quot;</span> Name=<span style=\"color:#a31515\">&quot;dataGridElencoErrori&quot;</span>  /&gt;\r\n                &lt;/Grid&gt;\r\n            &lt;/TabItem&gt;\r\n            &lt;TabItem Header=<span style=\"color:#a31515\">&quot;Log&quot;</span> Name=<span style=\"color:#a31515\">&quot;tabLog&quot;</span>&gt;\r\n                &lt;Grid&gt;\r\n                    &lt;my:DataGrid AutoGenerateColumns=<span style=\"color:#a31515\">&quot;False&quot;</span> HorizontalAlignment=<span style=\"color:#a31515\">&quot;Stretch&quot;</span> Margin=<span style=\"color:#a31515\">&quot;5&quot;</span> Name=<span style=\"color:#a31515\">&quot;dataGridLog&quot;</span>  /&gt;\r\n                &lt;/Grid&gt;\r\n            &lt;/TabItem&gt;\r\n        &lt;/TabControl&gt;\r\n    &lt;/Grid&gt;\r\n&lt;/Window&gt;\r\n\r\n</pre>\r\n<pre>Can anyone give me a hand?</pre>\r\n<pre>Thanks</pre>\r\n</div>\r\n</pre>\r\n</div>\r\n</pre>\r\n</div>",
    "PostedDate": "2010-07-30T02:23:22.82-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]