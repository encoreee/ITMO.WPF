[
  {
    "Id": "147616",
    "ThreadId": "44352",
    "Html": "Hi,<br>\r\n<br>\r\nI am trying to create a context menu for the datagrid header columns. This is being done using an attached property. Single-step trough the code below proves that the style is created, and assigned to the HeaderStyle property on every column. But the style is not applied.<br>\r\n<br>\r\nSo my question is, what am I doing wrong? :-)<br>\r\n<hr>\r\n<pre>    public class DataGridHeaderContextMenu : ContextMenu<br>    {<br>        #region AutoGenerateProperty<br>        public static readonly DependencyProperty AutoGenerateProperty = DependencyProperty.RegisterAttached(&quot;AutoGenerate&quot;, typeof(bool), typeof(DataGridHeaderContextMenu), new PropertyMetadata(false, new PropertyChangedCallback(autoGenerate_Changed)));<br><br>        public static void SetAutoGenerate(UIElement element, Boolean value)<br>        {<br>            element.SetValue(AutoGenerateProperty, value);<br>        }<br><br>        public static Boolean GetAutoGenerate(UIElement element)<br>        {<br>            return (Boolean)element.GetValue(AutoGenerateProperty);<br>        }<br><br>        static void autoGenerate_Changed(DependencyObject obj, DependencyPropertyChangedEventArgs e)<br>        {<br>            if (obj is Microsoft.Windows.Controls.DataGrid)<br>            {<br>                if ((bool)e.NewValue)<br>                {<br>                    DataGrid grid = (DataGrid)obj;<br><br>                    DataGridHeaderContextMenu menu = new DataGridHeaderContextMenu(grid);<br><br>                    Style style = new Style(typeof(DataGridColumnHeader));<br>                    style.Setters.Add(new Setter(DataGridColumnHeader.ContextMenuProperty, menu));<br><br>                    foreach (DataGridColumn column in grid.Columns)<br>                    {<br>                        column.HeaderStyle = style;<br>                    }<br>                }<br>            }<br>            else<br>            {<br>                Trace.WriteLine(&quot;DataGridHeaderContextMenu: Only 'Microsoft.Windows.Controls.DataGrid' is supported.&quot;);<br>            }<br>        }<br>        #endregion<br><br>        public DataGridHeaderContextMenu(DataGrid grid)<br>        {<br>            Items.Add(&quot;Header dummy menu&quot;);<br>        }<br>    }</pre>\r\n",
    "PostedDate": "2009-01-15T23:48:27.037-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "147618",
    "ThreadId": "44352",
    "Html": "Instead of:\r\n<pre>                    foreach (DataGridColumn column in grid.Columns)<br>                    {<br>                        column.HeaderStyle = style;<br>                    }</pre>\r\nUse:\r\n<pre>                    grid.ColumnHeaderStyle = style;</pre>\r\nAnd it works :-)\r\n",
    "PostedDate": "2009-01-15T23:57:16.53-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]