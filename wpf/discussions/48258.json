[
  {
    "Id": "161023",
    "ThreadId": "48258",
    "Html": "When setting the display index of my columns I am getting an ArgumentOutofRangeException.&nbsp; I am restoring the column order and visibility based on some information I received from an external source.&nbsp; The code to set the display index and visible properties is called from the Loaded event on a user control.&nbsp; The code is below.&nbsp; This problem does not occur all the time only when I have certain columns in a certain order.&nbsp; I have found a HACK to work around this but was hopeful there is a solution to this or I am doing something wrong.&nbsp; Thanks for any help<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List&lt;PersonColumnInfo&gt; columns = info[listId];<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var orderColumns = columns.OrderBy(p =&gt; p.CurrentColumnIndex);<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (var item in orderColumns)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; grid.Columns[item.OrigColumnIndex].DisplayIndex = item.CurrentColumnIndex;<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!item.IsVisible)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; grid.Columns[item.OrigColumnIndex].Visibility = Visibility.Hidden;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; grid.Columns[item.OrigColumnIndex].Width = new DataGridLength(Convert.ToDouble(item.Width));<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n<br>\r\nSystem.ArgumentOutOfRangeException was unhandled<br>\r\n&nbsp; Message=&quot;Specified argument was out of the range of valid values.\\r\\nParameter name: index&quot;<br>\r\n&nbsp; Source=&quot;PresentationCore&quot;<br>\r\n&nbsp; ParamName=&quot;index&quot;<br>\r\n&nbsp; StackTrace:<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Media.VisualCollection.get_Item(Int32 index)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Controls.UIElementCollection.get_Item(Int32 index)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Controls.UIElementCollection.System.Collections.IList.get_Item(Int32 index)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Windows.Controls.DataGridCellsPanel.ArrangeOverride(Size arrangeSize)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.FrameworkElement.ArrangeCore(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.UIElement.Arrange(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MS.Internal.Helper.ArrangeElementWithSingleChild(UIElement element, Size arrangeSize)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Controls.ItemsPresenter.ArrangeOverride(Size arrangeSize)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.FrameworkElement.ArrangeCore(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.UIElement.Arrange(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Controls.Grid.ArrangeOverride(Size arrangeSize)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.FrameworkElement.ArrangeCore(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.UIElement.Arrange(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Windows.Controls.Primitives.DataGridColumnHeadersPresenter.ArrangeOverride(Size finalSize)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.FrameworkElement.ArrangeCore(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.UIElement.Arrange(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Controls.Grid.ArrangeOverride(Size arrangeSize)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.FrameworkElement.ArrangeCore(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.UIElement.Arrange(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Controls.Control.ArrangeOverride(Size arrangeBounds)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.FrameworkElement.ArrangeCore(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.UIElement.Arrange(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Controls.Border.ArrangeOverride(Size finalSize)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.FrameworkElement.ArrangeCore(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.UIElement.Arrange(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Controls.Control.ArrangeOverride(Size arrangeBounds)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.FrameworkElement.ArrangeCore(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.UIElement.Arrange(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Controls.Grid.ArrangeOverride(Size arrangeSize)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.FrameworkElement.ArrangeCore(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.UIElement.Arrange(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MS.Internal.Helper.ArrangeElementWithSingleChild(UIElement element, Size arrangeSize)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Controls.ContentPresenter.ArrangeOverride(Size arrangeSize)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.FrameworkElement.ArrangeCore(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.UIElement.Arrange(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Controls.Border.ArrangeOverride(Size finalSize)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.FrameworkElement.ArrangeCore(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.UIElement.Arrange(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Controls.Control.ArrangeOverride(Size arrangeBounds)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.FrameworkElement.ArrangeCore(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.UIElement.Arrange(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Controls.Grid.ArrangeOverride(Size arrangeSize)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.FrameworkElement.ArrangeCore(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.UIElement.Arrange(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Controls.Grid.ArrangeOverride(Size arrangeSize)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.FrameworkElement.ArrangeCore(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.UIElement.Arrange(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Controls.Border.ArrangeOverride(Size finalSize)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.FrameworkElement.ArrangeCore(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.UIElement.Arrange(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Controls.Grid.ArrangeOverride(Size arrangeSize)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.FrameworkElement.ArrangeCore(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.UIElement.Arrange(Rect finalRect)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.ContextLayoutManager.UpdateLayout()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.ContextLayoutManager.UpdateLayoutCallback(Object arg)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Media.MediaContext.InvokeOnRenderCallback.DoWork()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Media.MediaContext.FireInvokeOnRenderCallbacks()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Media.MediaContext.RenderMessageHandlerCore(Object resizedCompositionTarget)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Media.MediaContext.RenderMessageHandler(Object resizedCompositionTarget)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.InvokeImpl()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.InvokeInSecurityContext(Object state)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.runTryCode(Object userData)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.DispatcherOperation.Invoke()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.ProcessQueue()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.WndProcHook(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Boolean isSingleParameter)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.Invoke(DispatcherPriority priority, Delegate method, Object arg)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG&amp; msg)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.Run()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Application.RunDispatcher(Object ignore)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Application.RunInternal(Window window)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Application.Run(Window window)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Application.Run()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Pcis.Emr.Main.App.Main() in C:\\Projects\\PCIS\\EMRv0.2\\Pcis.Emr\\Pcis.Emr.Main\\obj\\Debug\\App.g.cs:line 0<br>\r\n&nbsp; InnerException: <br>\r\n<br>\r\n",
    "PostedDate": "2009-02-23T09:59:15.69-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "174755",
    "ThreadId": "48258",
    "Html": "I have also come across a similar problem when setting DataGridColumn.DisplayIndex on runtime. It seemed only happening for some certain column orders (haven't really worked out the pattern yet). Here is the big stacktrace when the error occured and the application then crashed out. Would this be a bug? Thanks.<br>\r\n<br>\r\n<span style=\"font-size:13px;color:#a31515\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:10px\">\r\n<p>&nbsp;</p>\r\n<p>---- DEBUG ASSERTION FAILED ----</p>\r\n<p>---- Assert Short Message ----</p>\r\n<p>Element count from blocks can't be less than total children count</p>\r\n<p>---- Assert Long Message ----</p>\r\n<p> </p>\r\n<p>at DataGridCellsPanel.GetRealizedChildrenNotInBlockList(List`1 blockList, IList children) </p>\r\n<p>at DataGridCellsPanel.ArrangeOverride(Size arrangeSize) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at Helper.ArrangeElementWithSingleChild(UIElement element, Size arrangeSize) </p>\r\n<p>at ItemsPresenter.ArrangeOverride(Size arrangeSize) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at Control.ArrangeOverride(Size arrangeBounds) </p>\r\n<p>at DataGridCellsPresenter.ArrangeOverride(Size finalSize) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at Grid.ArrangeOverride(Size arrangeSize) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at Border.ArrangeOverride(Size finalSize) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at Control.ArrangeOverride(Size arrangeBounds) </p>\r\n<p>at DataGridRow.ArrangeOverride(Size arrangeBounds) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at VirtualizingStackPanel.ArrangeOverride(Size arrangeSize) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at Helper.ArrangeElementWithSingleChild(UIElement element, Size arrangeSize) </p>\r\n<p>at ItemsPresenter.ArrangeOverride(Size arrangeSize) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at ScrollContentPresenter.ArrangeOverride(Size arrangeSize) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at Grid.ArrangeOverride(Size arrangeSize) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at Control.ArrangeOverride(Size arrangeBounds) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at Border.ArrangeOverride(Size finalSize) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at Control.ArrangeOverride(Size arrangeBounds) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at Grid.ArrangeOverride(Size arrangeSize) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at DockPanel.ArrangeOverride(Size arrangeSize) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at Helper.ArrangeElementWithSingleChild(UIElement element, Size arrangeSize) </p>\r\n<p>at ContentPresenter.ArrangeOverride(Size arrangeSize) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at Border.ArrangeOverride(Size finalSize) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at Control.ArrangeOverride(Size arrangeBounds) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at Helper.ArrangeElementWithSingleChild(UIElement element, Size arrangeSize) </p>\r\n<p>at ContentPresenter.ArrangeOverride(Size arrangeSize) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at Decorator.ArrangeOverride(Size arrangeSize) </p>\r\n<p>at AdornerDecorator.ArrangeOverride(Size finalSize) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at Border.ArrangeOverride(Size finalSize) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at Window.ArrangeOverride(Size arrangeBounds) </p>\r\n<p>at FrameworkElement.ArrangeCore(Rect finalRect) </p>\r\n<p>at UIElement.Arrange(Rect finalRect) </p>\r\n<p>at HwndSource.SetLayoutSize() </p>\r\n<p>at HwndSource.set_RootVisualInternal(Visual value) </p>\r\n<p>at HwndSource.set_RootVisual(Visual value) </p>\r\n<p>at Window.SetRootVisual() </p>\r\n<p>at Window.SetupInitialState(Double requestedTop, Double requestedLeft, Double requestedWidth, Double requestedHeight) </p>\r\n<p>at Window.CreateSourceWindowImpl() </p>\r\n<p>at Window.SafeCreateWindow() </p>\r\n<p>at Window.ShowHelper(Object booleanBox) </p>\r\n<p>at ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter) </p>\r\n<p>at ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler) </p>\r\n<p>at Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler) </p>\r\n<p>at DispatcherOperation.InvokeImpl() </p>\r\n<p>at DispatcherOperation.InvokeInSecurityContext(Object state) </p>\r\n<p>at ExecutionContext.runTryCode(Object userData) </p>\r\n<p>at RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData) </p>\r\n<p>at ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state) </p>\r\n<p>at ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state) </p>\r\n<p>at DispatcherOperation.Invoke() </p>\r\n<p>at Dispatcher.ProcessQueue() </p>\r\n<p>at Dispatcher.WndProcHook(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled) </p>\r\n<p>at HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled) </p>\r\n<p>at HwndSubclass.DispatcherCallbackOperation(Object o) </p>\r\n<p>at ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter) </p>\r\n<p>at ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler) </p>\r\n<p>at Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler) </p>\r\n<p>at Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Boolean isSingleParameter) </p>\r\n<p>at Dispatcher.Invoke(DispatcherPriority priority, Delegate method, Object arg) </p>\r\n<p>at HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam) </p>\r\n<p>at UnsafeNativeMethods.DispatchMessage(MSG&amp; msg) </p>\r\n<p>at Dispatcher.PushFrameImpl(DispatcherFrame frame) </p>\r\n<p>at Dispatcher.PushFrame(DispatcherFrame frame) </p>\r\n<p>at Dispatcher.Run() </p>\r\n<p>at Application.RunDispatcher(Object ignore) </p>\r\n<p>at Application.RunInternal(Window window) </p>\r\n<p>at Application.Run(Window window) </p>\r\n<p>at Application.Run() </p>\r\n<p>at App.Main() C:\\DevelopmentSVN\\NET\\Source\\GUI\\Applications\\MarketDataViewer\\TFS.GUI.Applications.MarketDataViewer.StandaloneApplication\\obj\\Debug\\App.g.cs</p>\r\n<p>at AppDomain._nExecuteAssembly(Assembly assembly, String[] args) </p>\r\n<p>at AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args) </p>\r\n<p>at HostProc.RunUsersAssembly() </p>\r\n<p>at ThreadHelper.ThreadStart_Context(Object state) </p>\r\n<p>at ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state) </p>\r\n<p>at ThreadHelper.ThreadStart() </p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">\r\n<p>&nbsp;</p>\r\n</span></p>\r\n",
    "PostedDate": "2009-04-02T04:07:21.707-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "222486",
    "ThreadId": "48258",
    "Html": "<p>I am also having this same issue with the DataGrid when setting the Column DisplayOrders and Width in code.</p>\r\n<p>&nbsp;</p>\r\n<p>Has anyone managed to resolve this? Or even narrowed down the cause?</p>",
    "PostedDate": "2009-08-12T06:09:48.953-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "222548",
    "ThreadId": "48258",
    "Html": "<p>I was able to create a work around and still be able to set the display order by doing the following, inside the loaded event, in the AllergyList.RestoreColumnState is where I set the display index</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><pre><div style=\"color:Black;background-color:White\"><pre>\r\n<span style=\"color:Blue\">if</span> (!<span style=\"color:Blue\">this</span>.loaded)\r\n        {\r\n          <span style=\"color:Blue\">this</span>.restoreColumnsTimer = <span style=\"color:Blue\">new</span> System.Windows.Threading.DispatcherTimer();\r\n          <span style=\"color:Blue\">this</span>.restoreColumnsTimer.Interval = TimeSpan.FromMilliseconds(1);\r\n\r\n          <span style=\"color:Blue\">this</span>.restoreColumnsTimer.Tick +=\r\n            <span style=\"color:Blue\">delegate</span>(<span style=\"color:Blue\">object</span> sndr, EventArgs args)\r\n            {\r\n              <span style=\"color:Blue\">this</span>.AllergyList.RestoreColumnState(DataCache.ColumnGuid, ListViewId.Allergies);\r\n              <span style=\"color:Blue\">this</span>.restoreColumnsTimer.Stop();\r\n            };\r\n\r\n    <span style=\"color:Blue\">this</span>.restoreColumnsTimer.Start();\r\n}\r\n</pre>\r\n</div>\r\n<br></pre>\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-08-12T07:49:59.773-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "222552",
    "ThreadId": "48258",
    "Html": "<p>Thanks masontwo</p>\r\n<p>&nbsp;</p>\r\n<p>Turns out the problem has been fixed in the latest release!</p>\r\n<p>&nbsp;</p>\r\n<p>http://wpf.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=29117</p>\r\n<p>&nbsp;</p>\r\n<p><span id=\"ctl00_ctl00_MasterContent_Content_ReleasePanelOrderingContainer_ReleaseDescriptionLiteral\">\r\n<li>DataGridColumn DisplayIndex ArgumentOutOfRange exception (as reported <a href=\"http://www.codeplex.com/wpf/WorkItem/View.aspx?WorkItemId=8266\">here</a>)</li>\r\n</span></p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-08-12T07:58:57.42-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "233504",
    "ThreadId": "48258",
    "Html": "<p>I'm having the same probleme even with the new version!</p>\r\n<p>&nbsp;</p>\r\n<p>The problem in my case is that I randomly add new columns and reorder them. So the loaded event will not fire (as it is already loaded).</p>\r\n<p>My workaround for this problem is to call UpdateLayout() between adding new columns and changing the display index.</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-09-11T03:52:27.75-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]