[
  {
    "Id": "145172",
    "ThreadId": "43656",
    "Html": "I have buttons for &quot;Up&quot;, &quot;Down&quot;, &quot;Add&quot; and &quot;Delete&quot; in the same Control as the DataGrid resides.<br>\r\n<br>\r\nI use the &quot;Up&quot; and &quot;Down&quot; buttons to move the selected rows up and down.<br>\r\nThe &quot;Add&quot; button adds a new row at the bottom, and the &quot;Delete&quot; button deletes the selected rows.<br>\r\n<br>\r\nThe way I accomplish this, is by modifying the collection that's bound to the DataGrid, and then I call UpdateTarget on the binding expression.<br>\r\n<br>\r\nIs this recommended way of getting this kind of behaviour?  Or is there some functionality in the DataGrid I don't know about?<br>\r\n<br>\r\nThe main reason I'm asking is that I'm getting some strange NullPointerReference exceptions in unit tests after calling one of my &quot;manipulate model&quot; methods.<br>\r\n<br>\r\nSee <a href=\"http://www.codeplex.com/wpf/Thread/View.aspx?ThreadId=43290\">http://www.codeplex.com/wpf/Thread/View.aspx?ThreadId=43290</a> for a stack trace (it happens when using the GetRow helper function mentioned in <a href=\"http://www.codeplex.com/wpf/Thread/View.aspx?ThreadId=34065\">http://www.codeplex.com/wpf/Thread/View.aspx?ThreadId=34065</a>)<br>\r\n<br>\r\nThanx!\r\n",
    "PostedDate": "2009-01-07T11:49:04.36-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "145181",
    "ThreadId": "43656",
    "Html": "Well, in the GetRow() helper thread, vinsibal mentions using dataGrid.Items.Add() so that one can presumably be used to add rows...?<br>\r\n<br>\r\nIs it possible to manipulate dataGrid.Items in other ways?  Ie. to move rows and to delete rows?  And if it is, and if it works, is it better or worse than manipulating the model? (and why is it better or worse?)<br>\r\n<br>\r\nThanx!<br>\r\n<br>\r\n<br>\r\n- Steinar\r\n",
    "PostedDate": "2009-01-07T12:03:32.447-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "145192",
    "ThreadId": "43656",
    "Html": "I tried implementing the Up and Down buttons by manipulating dataGrid.Items instead of the model.  But then I got the following exception:<br>\r\nSystem.InvalidOperationException: Operation is not valid while ItemsSource is in use. Access and modify elements with ItemsControl.ItemsSource instead.<br>\r\n<br>\r\nAnd ItemsSource has a data binding on it.<br>\r\n<br>\r\nSo presumably the correct way (and it also feels like the correct way), is to manipulate the model.<br>\r\n<br>\r\nSo why am I getting the stack trace referred to earlier in this thread?  Am I missing something?  Isn't calling UpdateTarget sufficient?\r\n",
    "PostedDate": "2009-01-07T12:16:14.823-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]