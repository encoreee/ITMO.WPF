[
  {
    "Id": "169866",
    "ThreadId": "50653",
    "Html": "Hello all.<br>\r\n<br>\r\nI just can't figure out how to get the following to work<br>\r\nI have a WCF application to get and save my information this all works wel. Now I want to show all my customers in a datagrid. Also no problem there.<br>\r\n<br>\r\nHere comes the part that I do not seem to get working properly. If I edit a row and leave to row I want the user to confirm that the row needs to be saved or cancelled.<br>\r\nOn a save I save the data in the collection and to the database On cancel I just revert the changes for this I implemented IEditableObject on my VM.<br>\r\n<br>\r\nThis is the part that works on partially. When i click outside of the grid I only get one EditRowEnding event. When I use the &quot;EnterKey&quot; I get it twice and when I change a row I get it about 10 times.<br>\r\n<br>\r\nI have read alot of topics and articles on this. and The one most people refer to tells me that my VM should implement a Event for the endedit. But I do not want to assing a event handler to every object I might have I just want to handle it form the actions in the Datagrid<br>\r\n<br>\r\nBelow are the code parts:<br>\r\nVM<br>\r\n<span style=\"font-size:13px;color:#0000ff\"> </span><span style=\"font-size:13px;color:#0000ff\">public</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">class</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">CustomerVM</span><span style=\"font-size:13px\"> : </span><span style=\"font-size:13px;color:#2b91af\">Customer</span><span style=\"font-size:13px\">, </span><span style=\"font-size:13px;color:#2b91af\">IEditableObject </span><span style=\"font-size:13px\">{ </span><span style=\"font-size:13px;color:#0000ff\">public</span><span style=\"font-size:13px\"> CustomerVM() : </span><span style=\"font-size:13px;color:#0000ff\">base</span><span style=\"font-size:13px\">(){}\r\n<p><span style=\"font-size:13px;color:#0000ff\">public</span><span style=\"font-size:13px\"> CustomerVM(</span><span style=\"font-size:13px;color:#2b91af\">Customer</span><span style=\"font-size:13px\"> aCustomer) {  \r\n<p><span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">.Adress = aCustomer.Adress;\r\n<p><span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">.City = aCustomer.City; <span style=\"font-size:13px\">\r\n<p><span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">.ZIPCode = aCustomer.ZIPCode;\r\n<p> }</p>\r\n<p><span style=\"font-size:13px;color:#2b91af\">sCustomer</span><span style=\"font-size:13px\"> _copy;\r\n<p><span style=\"font-size:13px;color:#0000ff\">public</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">void</span><span style=\"font-size:13px\"> BeginEdit() {\r\n<p><span style=\"font-size:13px;color:#0000ff\">if</span><span style=\"font-size:13px\"> (!IsInEditMode)\r\n<p> {</p>\r\n<p><span style=\"font-size:13px;color:#008000\">/Save the object state\r\n<p><span style=\"font-size:13px\">_copy = </span><span style=\"font-size:13px;color:#0000ff\">new</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">Customer </span><span style=\"font-size:13px\">{\r\n<p>                    Adress = </p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">.Adress, <br>\r\n<p><span style=\"font-size:13px\">ZIPCode = </span><span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">.ZIPCode\r\n<p> };</p>\r\n<p>IsInEditMode = </p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">true</span><span style=\"font-size:13px\">;\r\n<p> } </p>\r\n<p>}</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">public</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">void</span><span style=\"font-size:13px\"> CancelEdit()  {\r\n<p><span style=\"font-size:13px;color:#008000\">// restore original object state\r\n<p><span style=\"font-size:13px;color:#0000ff\">if</span><span style=\"font-size:13px\"> (_copy != </span><span style=\"font-size:13px;color:#0000ff\">null</span><span style=\"font-size:13px\">) {\r\n<p><span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">.Adress = _copy.Adress; <br>\r\n...</span><span style=\"font-size:13px\"> \r\n<p><span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">.ZIPCode = _copy.ZIPCode;\r\n<p> }</p>\r\n<p><span style=\"font-size:13px;color:#008000\">// clear cached data\r\n<p><span style=\"font-size:13px\">_copy = </span><span style=\"font-size:13px;color:#0000ff\">null</span><span style=\"font-size:13px\">;\r\n<p><span style=\"font-size:13px;color:#008000\">// ensure edit mode flag is unset\r\n<p><span style=\"font-size:13px\">IsInEditMode =</span><span style=\"font-size:13px;color:#0000ff\">false</span><span style=\"font-size:13px\">;\r\n<p> </p>\r\n<p> }</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">public</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">void</span><span style=\"font-size:13px\"> EndEdit() {\r\n<p><span style=\"font-size:13px;color:#008000\">// clear cached data\r\n<p> </p>\r\n<p> _</p>\r\n<p><span style=\"font-size:13px\">copy = </span><span style=\"font-size:13px;color:#0000ff\">null</span><span style=\"font-size:13px\">;\r\n<p><span style=\"font-size:13px;color:#008000\">// ensure edit mode flag is unset\r\n<p><span style=\"font-size:13px\">IsInEditMode = </span><span style=\"font-size:13px;color:#0000ff\">false</span><span style=\"font-size:13px\">;\r\n<p> </p>\r\n<p> }</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">private</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">bool</span><span style=\"font-size:13px\"> _isInEditMode = </span><span style=\"font-size:13px;color:#0000ff\">false</span><span style=\"font-size:13px\">;\r\n<p><span style=\"font-size:13px;color:#0000ff\">public</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">bool</span><span style=\"font-size:13px\"> IsInEditMode {\r\n<p><span style=\"font-size:13px;color:#0000ff\">get</span><span style=\"font-size:13px\"> { </span><span style=\"font-size:13px;color:#0000ff\">return</span><span style=\"font-size:13px\"> _isInEditMode; }\r\n<p><span style=\"font-size:13px;color:#0000ff\">private</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">set</span><span style=\"font-size:13px\">{ </span><span style=\"font-size:13px;color:#0000ff\">if</span><span style=\"font-size:13px\"> (_isInEditMode != </span><span style=\"font-size:13px;color:#0000ff\">value</span><span style=\"font-size:13px\">) {\r\n<p> </p>\r\n<p>_isInEditMode = </p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">value</span><span style=\"font-size:13px\">;\r\n<p><span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">.RaisePropertyChanged(</span><span style=\"font-size:13px;color:#a31515\">&quot;IsInEditMode&quot;</span><span style=\"font-size:13px\">); </span><br>\r\n<br>\r\n<br>\r\nView <br>\r\n<br>\r\n<span style=\"font-size:13px;color:#0000ff\">\r\n<p>public</p>\r\n<p><span style=\"font-size:13px\">CustomersOverview()\r\n<p>{</p>\r\n<p>InitializeComponent();</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">.dgCustomers.ItemsSource = </span><span style=\"font-size:13px;color:#2b91af\">ServiceController</span><span style=\"font-size:13px\">.GetInstance().Customers;\r\n<p><span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">.dgCustomers.RowEditEnding += </span><span style=\"font-size:13px;color:#0000ff\">new</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">EventHandler</span><span style=\"font-size:13px\">&lt;</span><span style=\"font-size:13px;color:#2b91af\">DataGridRowEditEndingEventArgs</span><span style=\"font-size:13px\">&gt;(dgCustomers_RowEditEnding);\r\n<p> </p>\r\n<p>}</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">void</span><span style=\"font-size:13px\"> dgCustomers_RowEditEnding(</span><span style=\"font-size:13px;color:#0000ff\">object</span><span style=\"font-size:13px\"> sender, </span><span style=\"font-size:13px;color:#2b91af\">DataGridRowEditEndingEventArgs</span><span style=\"font-size:13px\"> e)\r\n<p> </p>\r\n<p>{</p>\r\n<p><span style=\"font-size:13px;color:#2b91af\">CustomerVM</span><span style=\"font-size:13px\"> cust = e.Row.Item </span><span style=\"font-size:13px;color:#0000ff\">as</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">CustomerVM</span><span style=\"font-size:13px\">;\r\n<p><span style=\"font-size:13px;color:#0000ff\">if</span><span style=\"font-size:13px\"> (cust != </span><span style=\"font-size:13px;color:#0000ff\">null</span><span style=\"font-size:13px\"> &amp;&amp; cust.IsInEditMode &amp;&amp; e.EditAction == </span><span style=\"font-size:13px;color:#2b91af\">DataGridEditAction</span><span style=\"font-size:13px\">.Commit)\r\n<p> </p>\r\n<p>{</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">if</span><span style=\"font-size:13px\"> (</span><span style=\"font-size:13px;color:#2b91af\">MessageBox</span><span style=\"font-size:13px\">.Show(</span><span style=\"font-size:13px;color:#0000ff\">string</span><span style=\"font-size:13px\">.Format(</span><span style=\"font-size:13px;color:#a31515\">&quot;Wil je de gegevens van {0} opslaan?&quot;</span><span style=\"font-size:13px\">, cust.Name), </span><span style=\"font-size:13px;color:#a31515\">&quot;Gegevens opslaan&quot;</span><span style=\"font-size:13px\">, </span><span style=\"font-size:13px;color:#2b91af\">MessageBoxButton</span><span style=\"font-size:13px\">.OKCancel) == </span><span style=\"font-size:13px;color:#2b91af\">MessageBoxResult</span><span style=\"font-size:13px\">.OK)\r\n<p> </p>\r\n<p>{</p>\r\n<p>cust.EndEdit();</p>\r\n<p><span style=\"font-size:13px;color:#2b91af\">ServiceController</span><span style=\"font-size:13px\">.GetInstance().UpdateCustomerAsync(cust);\r\n<p> </p>\r\n<p>}</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">else\r\n<p><span style=\"font-size:13px\">\r\n<p> </p>\r\n<p>{</p>\r\n<p>cust.CancelEdit();</p>\r\n<p>}</p>\r\n<p>}</p>\r\n<p>}</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n</span>\r\n",
    "PostedDate": "2009-03-19T08:19:11.857-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]