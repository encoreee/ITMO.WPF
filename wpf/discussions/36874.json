[
  {
    "Id": "122331",
    "ThreadId": "36874",
    "Html": "Hi<br>\r\n<br>\r\nI have a datagrid containing my business objects and a toolbar with a save button, but I have problems using commands.<br>\r\nLet me first give you my &quot;environment&quot;<br>\r\n<br>\r\nMy Command:<br>\r\n&nbsp;&nbsp;&nbsp; &lt;CommandBinding Command=&quot;ApplicationCommands.Save&quot;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Executed=&quot;OnSave&quot;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CanExecute=&quot;CanSave&quot; /&gt;<br>\r\nMy Button:<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Button Command=&quot;ApplicationCommands.Save&quot;&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;StackPanel&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;TextBlock Text=&quot;{StaticResource C.Save}&quot;/&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Image Source=&quot;{x:Null}&quot;/&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/StackPanel&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/Button&gt;<br>\r\n<br>\r\nMy Grid columns (just the first two):<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;toolkit:DataGridCheckBoxColumn Header=&quot;{StaticResource P.RowSelectedYN}&quot; DataFieldBinding=&quot;{Binding Path=IsSelected}&quot; /&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;toolkit:DataGridTextColumn Header=&quot;{StaticResource P.ModuleName}&quot; DataFieldBinding=&quot;{Binding Path=ModuleName, ValidatesOnDataErrors=True}&quot; ElementStyle=&quot;{StaticResource styTextBoxColumnStyleGif}&quot;/&gt;<br>\r\n<br>\r\nMy Code for CanSave and OnSave:<br>\r\n&nbsp;&nbsp; Private Sub CanSave(ByVal sender As System.Object, ByVal e As CanExecuteRoutedEventArgs)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.CanExecute = True<br>\r\n&nbsp;&nbsp; End Sub<br>\r\n&nbsp;&nbsp; Private Sub OnSave(ByVal sender As System.Object, ByVal e As System.Windows.RoutedEventArgs)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Call moAction.SaveList(mltModule)<br>\r\n&nbsp;&nbsp; End Sub<br>\r\n<br>\r\nNow to the problem I run into:<br>\r\n1) When I press the button before doing any changes to the grid, OnSave is called, the button remains active.<br>\r\n2) When I press the button after doing changes in a DataGridTextColumn, OnSave is not called, the button is disabled. The button is enabled again when I click in any cell of the grid (including again in the changed cell). Any further change to a DataGridTextColumn in any other row (or even the same first row) leads to the same result (OnSaev not called, button disabled)<br>\r\n3) When I change the DataGridCheckBoxColumncolumn (click the checkbox), and press the button, OnSave is called, the button remains active. After changing a DataGridTextColumn's text, there is the same behaviour as described in 2)<br>\r\n<br>\r\nIn General: any change to a DataGridTextColumn leads to not running OnSave, any change to a DataGridCheckBoxColumncolumn leads to OnSave being called.<br>\r\n<br>\r\nTo be sure that not &quot;ApplicationCommand.Save&quot; has some strange internal behaviour, I created a custom routed&nbsp; command like so<br>\r\nPublic NotInheritable Class Commands<br>\r\n&nbsp;&nbsp; Private Sub New()<br>\r\n&nbsp;&nbsp; End Sub<br>\r\n&nbsp;&nbsp; Public Shared ReadOnly Foo As New RoutedCommand()<br>\r\nEnd Class<br>\r\n<br>\r\nWith the following binding definition:<br>\r\n&nbsp;&nbsp;&nbsp; &lt;CommandBinding<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Command=&quot;{x:Static local:Commands.Foo}&quot;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CanExecute=&quot;Foo_CanExecute&quot;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Executed=&quot;Foo_Executed&quot;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /&gt;<br>\r\n<br>\r\nAnd the following Button:<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Button Command=&quot;{x:Static local:Commands.Foo}&quot;&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;StackPanel&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;TextBlock Text=&quot;{StaticResource C.Save}&quot;/&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Image Source=&quot;{x:Null}&quot;/&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/StackPanel&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/Button&gt;<br>\r\n<br>\r\nThis had exactly the same result<br>\r\n<br>\r\nHope you can fix this<br>\r\nRegards<br>\r\nKlaus<br>\r\n",
    "PostedDate": "2008-10-02T03:09:42.87-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "123567",
    "ThreadId": "36874",
    "Html": "Hi<br>\r\n<br>\r\nam I the only one who has this problem?<br>\r\nOr is there a way out?<br>\r\n<br>\r\nRegards<br>\r\nKlaus<br>\r\n",
    "PostedDate": "2008-10-07T12:37:54.677-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "123870",
    "ThreadId": "36874",
    "Html": "Hi<br>\r\n<br>\r\nfound the problem: setting &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FocusManager.IsFocusScope=&quot;False&quot; for the toolbar does the trick<br>\r\n<br>\r\nBest regards<br>\r\nKlaus<br>\r\n",
    "PostedDate": "2008-10-08T14:04:56.033-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]