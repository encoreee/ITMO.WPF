[
  {
    "Id": "627539",
    "ThreadId": "261332",
    "Html": "\r\n<p>Hello,</p>\r\n<p>I have a datagrid (dg) and an &quot;UNDO&quot;-button. If the user presses UNDO I want the datagrid to refresh.</p>\r\n<p>This works fine, as long as I don't have errors in the datagrid:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>        <span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> dgUNDO_EXECUTE(<span style=\"color:blue\">object</span> sender, ExecutedRoutedEventArgs e)\r\n        {\r\n            _vAdapter.RejectChanges();\r\n            dg.Items.Refresh();\r\n        }\r\n<br>If I have an error, the datagridRow is still in EditMode and it is impossible to refresh.<br>So I change the code into:<br><div style=\"color:black; background-color:white\"><pre>       <span style=\"color:blue\">private</span> <span style=\"color:blue\">void</span> dgUNDO_Execute(<span style=\"color:blue\">object</span> sender, ExecutedRoutedEventArgs e)\r\n        {\r\n            BindingListCollectionView lv = CollectionViewSource.GetDefaultView(dg.ItemsSource) <span style=\"color:blue\">as</span> BindingListCollectionView;\r\n            CT_V_AAND rec;\r\n\r\n            <span style=\"color:blue\">if</span> (lv != <span style=\"color:blue\">null</span>)\r\n            {\r\n                <span style=\"color:blue\">if</span> (lv.IsEditingItem)\r\n                {\r\n                    rec = lv.CurrentEditItem <span style=\"color:blue\">as</span> CT_V_AAND;\r\n                    lv.CommitEdit();\r\n                }\r\n            }\r\n            _vAdapter.RejectChanges();\r\n            <span style=\"color:green\">// Remove errors on record, bij validating again</span>\r\n            rec.MyValidate()\r\n            \r\n            dg.Items.Refresh();\r\n       }\r\n</pre>\r\n</div>\r\n<br>After this, everything looks fine, but I cannot get the datagrid into editMode again. Don't know why this is.<br><br>Can somebody help me?<br>Thanks in advance<br><br>&nbsp;<br></pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2011-06-14T07:14:24.053-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]