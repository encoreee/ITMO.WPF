[
  {
    "Id": "946440",
    "ThreadId": "404454",
    "Html": "\r\n<p>Hi,</p>\r\n<p>Can't seem to find a simple answer or there must not be one for reading section attributes from the application config file.&nbsp; All I want to do is read a Section that has&nbsp;assembly element properties.</p>\r\n<p>App.Config:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;?</span><span style=\"color:#a31515\">xml</span> <span style=\"color:red\">version</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">1.0</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">?&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">configuration</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">configSections</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">section</span> <span style=\"color:red\">name</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">modules</span><span style=\"color:black\">&quot;</span>\r\n             <span style=\"color:red\">type</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Microsoft.Practices.Prism.Modularity.ModulesConfigurationSection, Microsoft.Practices.Prism</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">configSections</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">modules</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">module</span>\r\n      <span style=\"color:red\">assemblyFile</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">ServiceCommon.dll</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">moduleType</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">ServiceCommon.CommonServiceModule, ServiceCommon, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">moduleName</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">ServiceCommon</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">startupLoaded</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">true</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">module</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">module</span>\r\n      <span style=\"color:red\">assemblyFile</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">ExcelService.dll</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">moduleType</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">ExcelService.ExcelServiceModule, ExcelService, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">moduleName</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">ExcelService</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">startupLoaded</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">false</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">module</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">module</span>\r\n      <span style=\"color:red\">assemblyFile</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RegionTurahList.dll</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">moduleType</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RegionTurahList.TurahListRegionModule, RegionTurahList, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">moduleName</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RegionTurahList</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">startupLoaded</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">false</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n      <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">dependencies</span><span style=\"color:blue\">&gt;</span>\r\n        <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">dependency</span> <span style=\"color:red\">moduleName</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">ExcelService</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n      <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">dependencies</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">module</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">module</span>\r\n      <span style=\"color:red\">assemblyFile</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RegionTurahBooks.dll</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">moduleType</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RegionTurahBooks.TurahBooksRegionModule, RegionTurahBooks, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">moduleName</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RegionTurahBooks</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">startupLoaded</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">false</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n      <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">dependencies</span><span style=\"color:blue\">&gt;</span>\r\n        <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">dependency</span> <span style=\"color:red\">moduleName</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">ExcelService</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n      <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">dependencies</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">module</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">module</span>\r\n      <span style=\"color:red\">assemblyFile</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RegionTurahHebrew.dll</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">moduleType</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RegionTurahHebrew.TurahHebrewRegionModule, RegionTurahHebrew, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">moduleName</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RegionTurahHebrew</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">startupLoaded</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">false</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n      <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">dependencies</span><span style=\"color:blue\">&gt;</span>\r\n        <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">dependency</span> <span style=\"color:red\">moduleName</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">ExcelService</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n      <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">dependencies</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">module</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">module</span>\r\n      <span style=\"color:red\">assemblyFile</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RegionTurahAleppo.dll</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">moduleType</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RegionTurahAleppo.TurahAleppoRegionModule, RegionTurahAleppo, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">moduleName</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RegionTurahAleppo</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">startupLoaded</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">false</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n      <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">dependencies</span><span style=\"color:blue\">&gt;</span>\r\n        <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">dependency</span> <span style=\"color:red\">moduleName</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">ExcelService</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n      <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">dependencies</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">module</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">module</span>\r\n      <span style=\"color:red\">assemblyFile</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RegionTurahNames.dll</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">moduleType</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RegionTurahNames.TurahNamesRegionModule, RegionTurahNames, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">moduleName</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RegionTurahNames</span><span style=\"color:black\">&quot;</span>\r\n      <span style=\"color:red\">startupLoaded</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">false</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n      <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">dependencies</span><span style=\"color:blue\">&gt;</span>\r\n        <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">dependency</span> <span style=\"color:red\">moduleName</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">ExcelService</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n      <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">dependencies</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">module</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">modules</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">startup</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">supportedRuntime</span> <span style=\"color:red\">version</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">v4.0</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">sku</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">.NETFramework,Version=v4.0</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">startup</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">configuration</span><span style=\"color:blue\">&gt;</span>\r\n\r\n</pre>\r\n</div>\r\n<p>I want to read and get&nbsp;the properties of all the elements &lt;module&gt; in the Section &lt;modules&gt; and put them in a Dictionary when I load a module (assembly):</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>    <span style=\"color:blue\">public</span> <span style=\"color:blue\">class</span> CommonService : ICommonService, IRegionTracker\r\n    {\r\n        <span style=\"color:blue\">private</span> <span style=\"color:blue\">readonly</span> IEventAggregator eventAggregator;\r\n        <span style=\"color:blue\">private</span> <span style=\"color:blue\">readonly</span> IUnityContainer container;\r\n        <span style=\"color:blue\">private</span> IModuleManager moduleManager;\r\n        <span style=\"color:blue\">private</span> Dictionary&lt;<span style=\"color:blue\">string</span>, RegionTrackingState&gt; _regionCollection = <span style=\"color:blue\">new</span> Dictionary&lt;<span style=\"color:blue\">string</span>, RegionTrackingState&gt;();\r\n\r\n        <span style=\"color:blue\">public</span> CommonService(IEventAggregator eventAggregator, IUnityContainer container, IModuleManager moduleManager)\r\n        {\r\n            <span style=\"color:blue\">this</span>.eventAggregator = eventAggregator;\r\n            <span style=\"color:blue\">this</span>.moduleManager = moduleManager;\r\n            <span style=\"color:blue\">this</span>.container = container;\r\n        }\r\n\r\n...\r\n..\r\n.\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">void</span> loadModule(<span style=\"color:blue\">string</span> parameter)\r\n        {\r\n            <span style=\"color:blue\">if</span> (!container.IsRegistered&lt;ExcelService&gt;())\r\n                <span style=\"color:blue\">this</span>.moduleManager.LoadModule(RegionNames.ExcelService);\r\n\r\n            <span style=\"color:blue\">if</span> (!_regionCollection.ContainsKey(parameter))\r\n            {\r\n<strong>                Configuration appConfig = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None) <span style=\"color:blue\">as</span> Configuration;\r\n                ConfigurationSection section = appConfig.GetSection(<span style=\"color:#a31515\">&quot;modules&quot;</span>);\r\n                SectionInformation sInfo = section.SectionInformation;\r\n</strong>\r\n                RegionTrackingState region = <span style=\"color:blue\">new</span> RegionTrackingState(\r\n                    parameter,\r\n                    DiscoveryMethod.ConfigurationManifest,\r\n                    InitializationMode.OnDemand,\r\n                    DownloadTiming.WithApplication,\r\n                    RegionNames.ExcelService);\r\n\r\n                _regionCollection.Add(parameter, region);\r\n                <span style=\"color:blue\">this</span>.moduleManager.LoadModule(parameter);\r\n            }\r\n        }\r\n\r\n...\r\n..\r\n.\r\n}\r\n</pre>\r\n</div>\r\n<p>I can only get as far as getting the Section and don't know where to go from there.&nbsp; I've read a lot of posts that have not giving me a solution to this.</p>\r\n",
    "PostedDate": "2012-11-24T08:30:18.467-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]