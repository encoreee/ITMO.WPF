[
  {
    "Id": "172793",
    "ThreadId": "51521",
    "Html": "I have added functionaly in to Datagrid by providing a movement panel where user can move between rows by pressing arrow button and delete also from a button.<br>\r\nActuallt I have attached it to a user control for a form view of the same data and synchronise the operation both way like delete movement add etc.<br>\r\n<br>\r\nEverything work excellent except when user press delete using my button.<br>\r\n<br>\r\nI am using datatable as itemsource.<br>\r\n<br>\r\nI tried removing items from DataGrid.Items.It works gr8 but when I use Set CurrentItem to DataGrid.Items.CurrentItems it raises a &quot;Object Instance not set&quot;<br>\r\n<br>\r\nFollowing is stack trace<br>\r\n Message  &quot;Object reference not set to an instance of an object.&quot;<br>\r\nSource &quot;WPFToolkit&quot;<br>\r\n   at Microsoft.Windows.Controls.DataGridCellsPanel.DetermineRealizedColumnsBlockList(Size constraint)<br>\r\n   at Microsoft.Windows.Controls.DataGridCellsPanel.MeasureOverride(Size constraint)<br>\r\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)<br>\r\n   at System.Windows.UIElement.Measure(Size availableSize)<br>\r\n   at MS.Internal.Helper.MeasureElementWithSingleChild(UIElement element, Size constraint)<br>\r\n   at System.Windows.Controls.ItemsPresenter.MeasureOverride(Size constraint)<br>\r\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)<br>\r\n   at System.Windows.UIElement.Measure(Size availableSize)<br>\r\n   at System.Windows.Controls.Control.MeasureOverride(Size constraint)<br>\r\n   at Microsoft.Windows.Controls.Primitives.DataGridCellsPresenter.MeasureOverride(Size availableSize)<br>\r\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)<br>\r\n   at System.Windows.UIElement.Measure(Size availableSize)<br>\r\n   at System.Windows.Controls.Grid.MeasureCell(Int32 cell, Boolean forceInfinityV)<br>\r\n   at System.Windows.Controls.Grid.MeasureCellsGroup(Int32 cellsHead, Size referenceSize, Boolean ignoreDesiredSizeU, Boolean forceInfinityV)<br>\r\n   at System.Windows.Controls.Grid.MeasureOverride(Size constraint)<br>\r\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)<br>\r\n   at System.Windows.UIElement.Measure(Size availableSize)<br>\r\n   at System.Windows.Controls.Border.MeasureOverride(Size constraint)<br>\r\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)<br>\r\n   at System.Windows.UIElement.Measure(Size availableSize)<br>\r\n   at System.Windows.Controls.Control.MeasureOverride(Size constraint)<br>\r\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)<br>\r\n   at System.Windows.UIElement.Measure(Size availableSize)<br>\r\n   at System.Windows.Controls.VirtualizingStackPanel.MeasureOverride(Size constraint)<br>\r\n   at Microsoft.Windows.Controls.Primitives.DataGridRowsPresenter.MeasureOverride(Size constraint)<br>\r\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)<br>\r\n   at System.Windows.UIElement.Measure(Size availableSize)<br>\r\n   at System.Windows.ContextLayoutManager.UpdateLayout()<br>\r\n   at System.Windows.ContextLayoutManager.UpdateLayoutCallback(Object arg)<br>\r\n   at System.Windows.Media.MediaContext.InvokeOnRenderCallback.DoWork()<br>\r\n   at System.Windows.Media.MediaContext.FireInvokeOnRenderCallbacks()<br>\r\n   at System.Windows.Media.MediaContext.RenderMessageHandlerCore(Object resizedCompositionTarget)<br>\r\n   at System.Windows.Media.MediaContext.RenderMessageHandler(Object resizedCompositionTarget)<br>\r\n   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)<br>\r\n   at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br>\r\n   at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br>\r\n   at System.Windows.Threading.DispatcherOperation.InvokeImpl()<br>\r\n   at System.Windows.Threading.DispatcherOperation.InvokeInSecurityContext(Object state)<br>\r\n   at System.Threading.ExecutionContext.runTryCode(Object userData)<br>\r\n   at System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData)<br>\r\n   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)<br>\r\n   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)<br>\r\n   at System.Windows.Threading.DispatcherOperation.Invoke()<br>\r\n   at System.Windows.Threading.Dispatcher.ProcessQueue()<br>\r\n   at System.Windows.Threading.Dispatcher.WndProcHook(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)<br>\r\n   at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)<br>\r\n   at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)<br>\r\n   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)<br>\r\n   at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br>\r\n   at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)<br>\r\n   at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Boolean isSingleParameter)<br>\r\n   at System.Windows.Threading.Dispatcher.Invoke(DispatcherPriority priority, Delegate method, Object arg)<br>\r\n   at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)<br>\r\n   at MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG&amp; msg)<br>\r\n   at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)<br>\r\n   at System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)<br>\r\n   at System.Windows.Threading.Dispatcher.Run()<br>\r\n   at System.Windows.Application.RunDispatcher(Object ignore)<br>\r\n   at System.Windows.Application.RunInternal(Window window)<br>\r\n   at System.Windows.Application.Run(Window window)<br>\r\n   at System.Windows.Application.Run()<br>\r\n   at PhoenixProject.App.Main() in F:\\Piyush\\obj\\Debug\\App.g.cs:line 0<br>\r\n   at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)<br>\r\n   at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)<br>\r\n   at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()<br>\r\n   at System.Threading.ThreadHelper.ThreadStart_Context(Object state)<br>\r\n   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)<br>\r\n   at System.Threading.ThreadHelper.ThreadStart()<br>\r\n<br>\r\n<br>\r\nNow if i dont referesh it on delete immediately and do any movement it work fine.<br>\r\n<br>\r\nAs I tried to guess ,As item get deleted it refreshes collection for virtualization asynchronysly and as it competes excpetion dont occur.<br>\r\n<br>\r\nMy Code is quite simple<br>\r\n<br>\r\n<br>\r\n<br>\r\n<br>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#0000ff\">if</span><span style=\"font-size:13px\"> (DG.Items.CurrentItem </span><span style=\"font-size:13px;color:#0000ff\">is</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">DataRowView</span><span style=\"font-size:13px\">)\r\n<p>&nbsp;</p>\r\n<p>{</p>\r\n<p>//First Version</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px\">//DG.Items.RemoveAt(DG.Items.CurrentPosition);\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p>//Second Version</p>\r\n</span></p>\r\n<p>\r\n<p><span style=\"font-size:13px;color:#008000\">\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">dr.Delete();\r\n<p>&nbsp;</p>\r\n<p>dv.Table.AcceptChanges();</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px\">SetCurrentRowInView();\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>\r\n<p><span style=\"font-size:13px;color:#008000\">\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n}<br>\r\n<br>\r\n<br>\r\n<span style=\"font-size:13px;color:#0000ff\">void</span><span style=\"font-size:13px\"> SetCurrentRowInView()\r\n<p>&nbsp;</p>\r\n<p>{</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#0000ff\">try\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px\"> \r\n<p>&nbsp;</p>\r\n<p>{</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">.CurrentItem = </span><span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">.Items.CurrentItem;\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">if</span><span style=\"font-size:13px\">(</span><span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">.CurrentItem!=</span><span style=\"font-size:13px;color:#0000ff\">null</span><span style=\"font-size:13px\">)\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">if</span><span style=\"font-size:13px\"> (_DataGridViewMode == </span><span style=\"font-size:13px;color:#2b91af\">enumDataGridViewMode</span><span style=\"font-size:13px\">.GridView) </span><span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">.ScrollIntoView(</span><span style=\"font-size:13px;color:#0000ff\">this</span><span style=\"font-size:13px\">.CurrentItem);\r\n<p>&nbsp;</p>\r\n<p>}</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">catch</span><span style=\"font-size:13px\"> (</span><span style=\"font-size:13px;color:#2b91af\">Exception</span><span style=\"font-size:13px\">)\r\n<p>&nbsp;</p>\r\n<p>{</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>}</p>\r\n<p>&nbsp;</p>\r\n<p>}<br>\r\n<br>\r\n///Code for Move Next<br>\r\nvoid MoveNext()<br>\r\n{<br>\r\n<span style=\"font-size:13px;color:#0000ff\">\r\n<p>&nbsp;</p>\r\n<p>this</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px\">.Items.MoveCurrentToNext();\r\n<p>&nbsp;</p>\r\n</span></p>\r\nSetCurrentRowInView();<br>\r\n}<br>\r\n<br>\r\n<br>\r\n<br>\r\n<br>\r\nWorst is that my project is getting crashed as this exception in not catchable in my try catch block.<br>\r\n<br>\r\n<br>\r\npls help me as I need to finsh my project</span></p>\r\n</span></p>\r\n",
    "PostedDate": "2009-03-27T07:58:23.617-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]