[
  {
    "Id": "420135",
    "ThreadId": "205457",
    "Html": "<p>&nbsp;</p>\r\n<p>Hi All,</p>\r\n<p>&nbsp;</p>\r\n<p>I've got this error trying to change the itemssource for a chart.</p>\r\n<p>&nbsp;</p>\r\n<p>Once I've added the data to the chart and after that I want to change this data by a new point collection. How can I do that?</p>\r\n<p>&nbsp;</p>\r\n<p>Here is my code snippet:</p>\r\n<p>&nbsp;</p>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">DataSet dc = VelWb.Analytics_SalesProductGroupbyMonthAndcompany(&quot;235000405&quot;, &quot;235000405&quot;, point.FieldName, point.Label);</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;LineSeries line = chart1.Series[0] as LineSeries;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;points = new VelChartPoints();</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;foreach (DataRow dr in dc.Tables[0].Rows)</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;points.Add(new VelChartPoint</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FieldName = point.FieldName,</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Label = dr.Field&lt;string&gt;(1),</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Value = (double)(dr.Field&lt;int&gt;(2))</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;});</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;line.ItemsSource = new VelChartPoints();</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:0px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;line.ItemsSource = points;</div>\r\n<p>&nbsp;</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>   LineSeries line = chart.Series[0] <span style=\"color:Blue\">as</span> LineSeries;\r\n                points = <span style=\"color:Blue\">new</span> VelChartPoints();\r\n                <span style=\"color:Blue\">foreach</span> (DataRow dr <span style=\"color:Blue\">in</span> dc.Tables[0].Rows)\r\n                {\r\n\r\n                    points.Add(<span style=\"color:Blue\">new</span> VelChartPoint\r\n                    {\r\n                        FieldName = <span style=\"color:#A31515\">&quot;Chart1&quot;</span>,\r\n                        Label = dr.Field&lt;<span style=\"color:Blue\">string</span>&gt;(0),\r\n                        Value = (<span style=\"color:Blue\">double</span>)(dr.Field&lt;<span style=\"color:Blue\">int</span>&gt;(1))\r\n                    });\r\n\r\n\r\n                    maxvalue = Math.Max(maxvalue, (<span style=\"color:Blue\">double</span>)(dr.Field&lt;<span style=\"color:Blue\">int</span>&gt;(1)));\r\n\r\n                }\r\n\r\n                LinearAxis axis = chart.Axes[1] <span style=\"color:Blue\">as</span> LinearAxis;\r\n\r\n                axis.SetValue(LinearAxis.MaximumProperty, (maxvalue + (maxvalue / 4)));\r\n                axis.SetValue(LinearAxis.IntervalProperty, Math.Round((maxvalue / 10), 0));\r\n                line.ItemsSource = points;\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>First time this code works fine (I can see the point on the chart), but runnig this code again for the same chart throw the extention.</p>\r\n<p>Please help me to solve the problem...</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-03-19T00:56:39.37-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "420575",
    "ThreadId": "205457",
    "Html": "<p>if you call Chart.Series.Clear</p>\r\n<p>and then</p>\r\n<p>Chart.Series.Add(points) it should work...</p>",
    "PostedDate": "2010-03-20T06:11:12.43-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "421701",
    "ThreadId": "205457",
    "Html": "<blockquote style=\"border:solid .1em #ccc;font-style:italic;margin:.25em 1em 0 1em;padding:0 .25em 0 .25em\"><strong>_kenneth_ wrote:</strong><br>\r\n<p>if you call Chart.Series.Clear</p>\r\n<p>and then</p>\r\n<p>Chart.Series.Add(points) it should work...</p>\r\n</blockquote>\r\n<p>Thnx for reply.&nbsp;</p>\r\n<p>You're right, now I am able to edit it. But my points are the common objects. So the question now is how to access these objects in LinearSeries? I can see there only Points collection (nothing about stored Items... Found out only the SelectedItem).</p>",
    "PostedDate": "2010-03-21T12:28:15.253-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "421782",
    "ThreadId": "205457",
    "Html": "<p>I pratially solved my issue, but still getting the error:</p>\r\n<p>The enumerator is not valid because the collection changed.</p>\r\n<p>The error occures at the line</p>\r\n<pre style=\"color:#000000;font-family:Consolas, 'Courier New', Courier, monospace;font-size:1em;margin:8px\">pointsnew.Clear();</pre>\r\n<p>Here is a part of my code:</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>  ObservableCollection&lt;VelChartPoint&gt; pointsnew = line.ItemsSource <span style=\"color:Blue\">as</span> ObservableCollection&lt;VelChartPoint&gt;;\r\n            pointsnew.Clear();\r\n           \r\n            DataSet dc = statistics.SalesQuantityProdcutGroupsMonthly;\r\n\r\n\r\n            <span style=\"color:Blue\">foreach</span> (DataRow dr <span style=\"color:Blue\">in</span> dc.Tables[0].Rows)\r\n            {\r\n  \r\n                    pointsnew.Add(<span style=\"color:Blue\">new</span> VelChartPoint\r\n                    {\r\n                        Label = dr.Field&lt;<span style=\"color:Blue\">string</span>&gt;(1),\r\n                        Value = (<span style=\"color:Blue\">double</span>)(dr.Field&lt;Int32?&gt;(2).Value)\r\n                    });\r\n}\r\n</pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-03-21T12:49:49.427-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "422100",
    "ThreadId": "205457",
    "Html": "<p>Could you provide a compilable example and also your xaml code.</p>\r\n<p>&nbsp;</p>\r\n<p>My version of it works just fine. Here my snippet:</p>\r\n<p>&nbsp;</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>            LineSeries line = testChart.Series[0] <span style=\"color:Blue\">as</span> LineSeries;\r\n            ObservableCollection&lt;KeyValuePair&lt;<span style=\"color:Blue\">string</span>, <span style=\"color:Blue\">double</span>&gt;&gt; points = <span style=\"color:Blue\">null</span>;\r\n            <span style=\"color:Blue\">if</span> (line.ItemsSource <span style=\"color:Blue\">is</span> ObservableCollection&lt;KeyValuePair&lt;<span style=\"color:Blue\">string</span>, <span style=\"color:Blue\">double</span>&gt;&gt;)\r\n            {\r\n                points = line.ItemsSource <span style=\"color:Blue\">as</span> ObservableCollection&lt;KeyValuePair&lt;<span style=\"color:Blue\">string</span>, <span style=\"color:Blue\">double</span>&gt;&gt;;\r\n                points.Clear();\r\n            }\r\n            <span style=\"color:Blue\">else</span>\r\n                points = <span style=\"color:Blue\">new</span> ObservableCollection&lt;KeyValuePair&lt;<span style=\"color:Blue\">string</span>, <span style=\"color:Blue\">double</span>&gt;&gt;();\r\n            Random rnd = <span style=\"color:Blue\">new</span> Random();\r\n            <span style=\"color:Blue\">for</span> (<span style=\"color:Blue\">int</span> i = 0; i &lt; 50; i++)\r\n            {\r\n                KeyValuePair&lt;<span style=\"color:Blue\">string</span>, <span style=\"color:Blue\">double</span>&gt; point = <span style=\"color:Blue\">new</span> KeyValuePair&lt;<span style=\"color:Blue\">string</span>, <span style=\"color:Blue\">double</span>&gt;(<span style=\"color:#A31515\">&quot;point &quot;</span> + i, rnd.Next(100));\r\n                points.Add(point);\r\n            }\r\n           \r\n            line.ItemsSource = points;\r\n</pre>\r\n</div>\r\n</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2010-03-22T06:37:06.603-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]