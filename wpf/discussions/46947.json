[
  {
    "Id": "157047",
    "ThreadId": "46947",
    "Html": "<div><div>Hi,</div><div><br></div><div>I have a BindingListCollectionView connected to the DataContext of a datagrid. The datagrid now shows the list of items of the BindingListCollectionView.</div><div>But when I click on the last row to add a new item. I get an &quot;Input string was not in a correct format.&quot; exception.</div><div><br></div><div>When I step with the debugger through the WpfToolkit library the exception happens in the private void <span style=\"font-style:italic\">MakeFullRowSelection(object dataItem, bool allowsExtendSelect, bool allowsMinimalSelect)</span> function of the file DataGrid.cs at the line <span style=\"font-style:italic\">EndUpdateSelectedItems().</span></div><div><br></div><div>Thanks in advance,</div><div>  Robert</div><div><br></div><div><br></div><div>Here's the stacktrace:</div><div>   at System.Text.StringBuilder.FormatError()</div><div>   at System.Text.StringBuilder.AppendFormat(IFormatProvider provider, String format, Object[] args)</div><div>   at System.String.Format(IFormatProvider provider, String format, Object[] args)</div><div>   at System.Diagnostics.TraceListener.TraceEvent(TraceEventCache eventCache, String source, TraceEventType eventType, Int32 id, String format, Object[] args)</div><div>   at System.Diagnostics.TraceSource.TraceEvent(TraceEventType eventType, Int32 id, String format, Object[] args)</div><div>   at MS.Internal.AvTrace.Trace(TraceEventType type, Int32 eventId, String message, String[] labels, Object[] parameters)</div><div>   at MS.Internal.TraceData.Trace(TraceEventType type, AvTraceDetails traceDetails, Object p1, Object p2)</div><div>   at System.Windows.Data.BindingExpression.ConvertBackHelper(IValueConverter converter, Object value, Type sourceType, Object parameter, CultureInfo culture)</div><div>   at System.Windows.Data.BindingExpression.ConvertProposedValue(Object value)</div><div>   at System.Windows.Data.BindingExpressionBase.UpdateValue()</div><div>   at System.Windows.Data.BindingExpression.Update(Boolean synchronous)</div><div>   at System.Windows.Data.BindingExpressionBase.Dirty()</div><div>   at System.Windows.Data.BindingExpression.SetValue(DependencyObject d, DependencyProperty dp, Object value)</div><div>   at System.Windows.DependencyObject.SetValueCommon(DependencyProperty dp, Object value, PropertyMetadata metadata, Boolean coerceWithDeferredReference, OperationType operationType, Boolean isInternal)</div><div>   at System.Windows.DependencyObject.SetValue(DependencyProperty dp, Object value)</div><div>   at System.Windows.Controls.Primitives.Selector.UpdatePublicSelectionProperties()</div><div>   at System.Windows.Controls.Primitives.Selector.SelectionChanger.End()</div><div>   at System.Windows.Controls.SelectedItemCollection.EndUpdateSelectedItems()</div><div>   at System.Windows.Controls.Primitives.MultiSelector.EndUpdateSelectedItems()</div><div>   at Microsoft.Windows.Controls.DataGrid.MakeFullRowSelection(Object dataItem, Boolean allowsExtendSelect, Boolean allowsMinimalSelect) in D:\\Dotnet\\Lib\\wpf\\Toolkit-release\\DataGrid\\Microsoft\\Windows\\Controls\\DataGrid.cs:line 4650</div><div>   at Microsoft.Windows.Controls.DataGrid.HandleSelectionForCellInput(DataGridCell cell, Boolean startDragging, Boolean allowsExtendSelect, Boolean allowsMinimalSelect) in D:\\Dotnet\\Lib\\wpf\\Toolkit-release\\DataGrid\\Microsoft\\Windows\\Controls\\DataGrid.cs:line 4382</div><div>   at Microsoft.Windows.Controls.DataGridCell.OnAnyMouseLeftButtonDown(MouseButtonEventArgs e) in D:\\Dotnet\\Lib\\wpf\\Toolkit-release\\DataGrid\\Microsoft\\Windows\\Controls\\DataGridCell.cs:line 761</div><div>   at Microsoft.Windows.Controls.DataGridCell.OnAnyMouseLeftButtonDownThunk(Object sender, MouseButtonEventArgs e) in D:\\Dotnet\\Lib\\wpf\\Toolkit-release\\DataGrid\\Microsoft\\Windows\\Controls\\DataGridCell.cs:line 723</div><div>   at System.Windows.Input.MouseButtonEventArgs.InvokeEventHandler(Delegate genericHandler, Object genericTarget)</div><div>   at System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object target)</div><div>   at System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs)</div><div>   at System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)</div><div>   at System.Windows.UIElement.ReRaiseEventAs(DependencyObject sender, RoutedEventArgs args, RoutedEvent newEvent)</div><div>   at System.Windows.UIElement.CrackMouseButtonEventAndReRaiseEvent(DependencyObject sender, MouseButtonEventArgs e)</div><div>   at System.Windows.UIElement.OnMouseDownThunk(Object sender, MouseButtonEventArgs e)</div><div>   at System.Windows.Input.MouseButtonEventArgs.InvokeEventHandler(Delegate genericHandler, Object genericTarget)</div><div>   at System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object target)</div><div>   at System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs)</div><div>   at System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)</div><div>   at System.Windows.UIElement.RaiseEventImpl(DependencyObject sender, RoutedEventArgs args)</div><div>   at System.Windows.UIElement.RaiseEvent(RoutedEventArgs args, Boolean trusted)</div><div>   at System.Windows.Input.InputManager.ProcessStagingArea()</div><div>   at System.Windows.Input.InputManager.ProcessInput(InputEventArgs input)</div><div>   at System.Windows.Input.InputProviderSite.ReportInput(InputReport inputReport)</div><div>   at System.Windows.Interop.HwndMouseInputProvider.ReportInput(IntPtr hwnd, InputMode mode, Int32 timestamp, RawMouseActions actions, Int32 x, Int32 y, Int32 wheel)</div><div>   at System.Windows.Interop.HwndMouseInputProvider.FilterMessage(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)</div><div>   at System.Windows.Interop.HwndSource.InputFilterMessage(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)</div><div>   at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)</div><div>   at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)</div><div>   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)</div><div>   at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)</div><div>   at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)</div><div>   at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Boolean isSingleParameter)</div><div>   at System.Windows.Threading.Dispatcher.Invoke(DispatcherPriority priority, Delegate method, Object arg)</div><div>   at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)</div><div>   at MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG&amp; msg)</div><div>   at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)</div><div>   at System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)</div><div>   at System.Windows.Threading.Dispatcher.Run()</div><div>   at System.Windows.Application.RunDispatcher(Object ignore)</div><div>   at System.Windows.Application.RunInternal(Window window)</div><div>   at System.Windows.Application.Run(Window window)</div><div>   at System.Windows.Application.Run()</div><div>   at KnfViewer.App.Main() in D:\\Dotnet\\Projects\\KnfViewer\\KnfViewer\\obj\\Debug\\App.g.cs:line 48</div><div>   at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)</div><div>   at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)</div><div>   at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()</div><div>   at System.Threading.ThreadHelper.ThreadStart_Context(Object state)</div><div>   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)</div><div>   at System.Threading.ThreadHelper.ThreadStart()</div></div><div><br></div><br>",
    "PostedDate": "2009-02-12T07:03:07.843-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "201609",
    "ThreadId": "46947",
    "Html": "<p>I'm having the same error when I click into the new row.</p>\r\n<p>&nbsp;</p>\r\n<p>Where you able to over come this?</p>",
    "PostedDate": "2009-06-15T08:05:05.95-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "203952",
    "ThreadId": "46947",
    "Html": "<p>Sorry for my late reacion. I was on holiday.</p>\r\n<p>I wasn't able to overcome this directly. But when you set CanUserAddRows to false, the empty row will become invisible. You can still add a row to you collection by adding a button. The button should add a new record to your collection and the results should show up immediately if it's an ObservableCollection.</p>\r\n<p>I have some examples in these two articles:&nbsp;<a href=\"http://reyntjes.blogspot.com/2009/06/viewmodel-for-observablecollection.html\">A Viewmodel for the ObservableCollection</a>&nbsp;<span style=\"font-size:13px\">and &nbsp;<strong><a href=\"http://reyntjes.blogspot.com/2009/04/master-detail-viewmodel_24.html\">A Master-Detail ViewModel</a></strong></span></p>\r\n<p>\r\n<p><span style=\"font-weight:normal\">\r\n<p>Robert</p>\r\n</span></p>\r\n</p>",
    "PostedDate": "2009-06-22T00:35:26.21-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "279115",
    "ThreadId": "46947",
    "Html": "<p>This happens to for me as well, but only when the debugger is attached.</p>",
    "PostedDate": "2010-01-19T11:00:35.34-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "291156",
    "ThreadId": "46947",
    "Html": "<p>Could you provide source code, how you bind data to CollectionObject (VM),item ViewModel and XAML, is it possible that you are trying to bind new item and VM of it is null?</p>",
    "PostedDate": "2010-02-16T02:52:26.173-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "413371",
    "ThreadId": "46947",
    "Html": "<p>Hi Nindza,</p>\r\n<p>I don't know exactly what you mean. But I guess you want an example when a row is being selected. I have an example of a chart that is being displayed when you select a row.</p>\r\n<p>It is in the .net 4 version of the <a style=\"text-decoration:underline;color:#3e62a6\" href=\"http://reyntjes.blogspot.com/2009/06/viewmodel-for-observablecollection.html\">A Viewmodel for the ObservableCollection</a>&nbsp;article at the bottom of the page.&nbsp;</p>\r\n<p>Robert</p>",
    "PostedDate": "2010-03-02T13:43:03.957-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]