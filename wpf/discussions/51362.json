[
  {
    "Id": "172205",
    "ThreadId": "51362",
    "Html": "Hi<br>\r\n<br>\r\nThe normal behavior is the following. When entering the EditMode of a cell of a DataGridTextColumn using the Mouse (2 clicks in a cell), normally (if clicked inside the text) the caret if placed near the position where the click happened. <br>\r\nIf I change the TextAlignment for the Element and the EditingElement to right alignment this behavior does not work anymore. Most of the time the whole text of that cell is selected in this case.<br>\r\n<br>\r\nThis is no direct problem of the DataGrid, because it seems that the Framework method: TextBox.GetCharacterIndexFromPoint(...) (used in DataGridTextColumn.PlaceCaretOnTextBox(...)) does not work correctly in this case.<br>\r\nAm I missing something (some setting maybe) or is this really a problem? <br>\r\n<br>\r\nThere is a workaround to fix this problem but this means that I need to override DataGridTextColumn.PrepareCellForEdit(...) method just to replace the content of the DataGridTextColumn.PlaceCaretOnTextBox(...) method. Is there be a better way to do this? I normally don't want to copy the code of the DataGridTextColumn.PrepareCellForEdit(...) method just to do that.<br>\r\n<br>\r\n<br>\r\nPommes<br>\r\n<br>\r\n<br>\r\nIf someone has the same problem, here is the code that would fix the behavior (in most cases):<br>\r\n<span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">\r\n<p>private</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">static</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">bool</span><span style=\"font-size:13px\"> PlaceCaretOnTextBox(</span><span style=\"font-size:13px;color:#2b91af\">TextBox</span><span style=\"font-size:13px\"> textBox, </span><span style=\"font-size:13px;color:#2b91af\">Point</span><span style=\"font-size:13px\"> position)\r\n<p>&nbsp;</p>\r\n<p>{</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">int</span><span style=\"font-size:13px\"> characterCount = textBox.Text.Length;\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">int</span><span style=\"font-size:13px\"> characterIndexSnap = textBox.GetCharacterIndexFromPoint(position, </span><span style=\"font-size:13px;color:#0000ff\">true</span><span style=\"font-size:13px\">);\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">int</span><span style=\"font-size:13px\"> characterIndex = textBox.GetCharacterIndexFromPoint(position, </span><span style=\"font-size:13px;color:#0000ff\">false</span><span style=\"font-size:13px\">);\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">if</span><span style=\"font-size:13px\"> (characterIndexSnap &gt;= characterCount - 1 &amp;&amp; characterIndexSnap != characterIndex)\r\n<p>&nbsp;</p>\r\n<p>{</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px\">textBox.CaretIndex = characterCount;\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">return</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">true</span><span style=\"font-size:13px\">;\r\n<p>&nbsp;</p>\r\n<p>}</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">else\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<span style=\"font-size:13px\">\r\n<p>{</p>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#0000ff\">if</span><span style=\"font-size:13px\"> (characterIndexSnap &gt;= 0)\r\n<p>&nbsp;</p>\r\n<p>{</p>\r\n<p>textBox.CaretIndex = characterIndexSnap;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">return</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">true</span><span style=\"font-size:13px\">;\r\n<p>&nbsp;</p>\r\n<p>}</p>\r\n<p>}</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">return</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#0000ff\">false</span><span style=\"font-size:13px\">;\r\n<p>&nbsp;</p>\r\n<p>}</p>\r\n</span></p>\r\n<br>\r\n",
    "PostedDate": "2009-03-26T02:42:28.977-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]