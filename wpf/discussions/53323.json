[
  {
    "Id": "179433",
    "ThreadId": "53323",
    "Html": "Hi!<br>\r\nI am trying to save user settings into our database. These user settings are made for special views in our application. I made a Settings class and a SettingItem class to be able to use an ObjectDataProvider to bind the DatagridColumns to these values. Loading and saving default values (without any changes to the default DisplayIndex) works very fine, but when a user changes the DisplayIndex of a column by reordering columns and the settings are saved, the next time I am trying to load the settings I am getting the error, that the DisplayIndex is already used.<br>\r\nI am not sure if this is  the bug reproted here:<br>\r\n<a href=\"http://wpf.codeplex.com/WorkItem/View.aspx?WorkItemId=8266\">http://wpf.codeplex.com/WorkItem/View.aspx?WorkItemId=8266</a><br>\r\nOr if it is my implementation. For better understanding what I am doing, here is some code:<br>\r\nWe have got two similar DataGrids, defining 33 columns. Only the ItemsSource is different.<br>\r\n<span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">\r\n<p>&lt;</p>\r\n</span>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px;color:#a31515\">TK</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGrid</span><span style=\"font-size:13px;color:#ff0000\"> Name</span><span style=\"font-size:13px;color:#0000ff\">=&quot;_buchungGrid&quot;</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#ff0000\">ItemsSource</span><span style=\"font-size:13px;color:#0000ff\">=&quot;{</span><span style=\"font-size:13px;color:#a31515\">Binding</span><span style=\"font-size:13px;color:#ff0000\"> SortedSet</span><span style=\"font-size:13px;color:#0000ff\">}&quot;<br>\r\n    </span><span style=\"font-size:13px;color:#ff0000\">AutoGenerateColumns</span><span style=\"font-size:13px;color:#0000ff\">=&quot;False&quot; </span><span style=\"font-size:13px;color:#ff0000\">CanUserAddRows</span><span style=\"font-size:13px;color:#0000ff\">=&quot;False&quot;<br>\r\n    </span><span style=\"font-size:13px;color:#ff0000\">HeadersVisibility</span><span style=\"font-size:13px;color:#0000ff\">=&quot;All&quot; </span><span style=\"font-size:13px;color:#ff0000\">CanUserSortColumns</span><span style=\"font-size:13px;color:#0000ff\">=&quot;True&quot;</span><span style=\"font-size:13px\"> <br>\r\n</span><span style=\"font-size:13px;color:#ff0000\">    RowDetailsVisibilityMode</span><span style=\"font-size:13px;color:#0000ff\">=&quot;Collapsed&quot;<br>\r\n    </span><span style=\"font-size:13px;color:#ff0000\">RowDetailsTemplate</span><span style=\"font-size:13px;color:#0000ff\">=&quot;{</span><span style=\"font-size:13px;color:#a31515\">StaticResource</span><span style=\"font-size:13px;color:#ff0000\"> RowDetailsTemplate</span><span style=\"font-size:13px;color:#0000ff\">}&quot;<br>\r\n</span><span style=\"font-size:13px;color:#ff0000\">    SelectionChanged</span><span style=\"font-size:13px;color:#0000ff\">=&quot;_buchungGrid_SelectionChanged&quot;<br>\r\n</span><span style=\"font-size:13px;color:#ff0000\">    SelectionMode</span><span style=\"font-size:13px;color:#0000ff\">=&quot;Extended&quot; </span><span style=\"font-size:13px;color:#ff0000\">RowStyle</span><span style=\"font-size:13px;color:#0000ff\">=&quot;{</span><span style=\"font-size:13px;color:#a31515\">StaticResource</span><span style=\"font-size:13px;color:#ff0000\"> Rowstyle</span><span style=\"font-size:13px;color:#0000ff\">}&quot;<br>\r\n    </span><span style=\"font-size:13px;color:#ff0000\">ColumnHeaderStyle</span><span style=\"font-size:13px;color:#0000ff\">=&quot;{</span><span style=\"font-size:13px;color:#a31515\">StaticResource</span><span style=\"font-size:13px;color:#ff0000\"> ColumnHeaderStyle</span><span style=\"font-size:13px;color:#0000ff\">}&quot;<br>\r\n    </span><span style=\"font-size:13px;color:#ff0000\">Sorting</span><span style=\"font-size:13px;color:#0000ff\">=&quot;_buchungGrid_Sorting&quot; </span><span style=\"font-size:13px;color:#ff0000\">Visibility</span><span style=\"font-size:13px;color:#0000ff\">=&quot;Visible&quot;&gt; </span><span style=\"font-size:13px;color:#0000ff\">\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n<span style=\"font-size:13px;color:#a31515\"></span><span style=\"font-size:13px;color:#0000ff\">&lt;</span><span style=\"font-size:13px;color:#a31515\">TK</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGrid.Columns</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">&lt;</span><span style=\"font-size:13px;color:#a31515\">TK</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGridTemplateColumn</span><span style=\"font-size:13px;color:#ff0000\"> Header</span><span style=\"font-size:13px;color:#0000ff\">=&quot;&quot;</span><span style=\"font-size:13px;color:#ff0000\"> IsReadOnly</span><span style=\"font-size:13px;color:#0000ff\">=&quot;False&quot;<br>\r\n</span><span style=\"font-size:13px;color:#ff0000\">    Width</span><span style=\"font-size:13px;color:#0000ff\">=&quot;{</span><span style=\"font-size:13px;color:#a31515\">Binding</span><span style=\"font-size:13px;color:#ff0000\"> Source</span><span style=\"font-size:13px;color:#0000ff\">={</span><span style=\"font-size:13px;color:#a31515\">StaticResource</span><span style=\"font-size:13px;color:#ff0000\"> Settings</span><span style=\"font-size:13px;color:#0000ff\">},</span><span style=\"font-size:13px;color:#ff0000\"> Path</span><span style=\"font-size:13px;color:#0000ff\">=SplitInGrid.Width,</span><span style=\"font-size:13px;color:#ff0000\"> Mode</span><span style=\"font-size:13px;color:#0000ff\">=TwoWay}&quot;<br>\r\n</span><span style=\"font-size:13px;color:#ff0000\">    Visibility</span><span style=\"font-size:13px;color:#0000ff\">=&quot;{</span><span style=\"font-size:13px;color:#a31515\">Binding</span><span style=\"font-size:13px;color:#ff0000\"> Source</span><span style=\"font-size:13px;color:#0000ff\">={</span><span style=\"font-size:13px;color:#a31515\">StaticResource</span><span style=\"font-size:13px;color:#ff0000\"> Settings</span><span style=\"font-size:13px;color:#0000ff\">},</span><span style=\"font-size:13px;color:#ff0000\"> Path</span><span style=\"font-size:13px;color:#0000ff\">=SplitInGrid.Visible}&quot;<br>\r\n    </span><span style=\"font-size:13px;color:#ff0000\">DisplayIndex</span><span style=\"font-size:13px;color:#0000ff\">=&quot;{</span><span style=\"font-size:13px;color:#a31515\">Binding</span><span style=\"font-size:13px;color:#ff0000\"> Source</span><span style=\"font-size:13px;color:#0000ff\">={</span><span style=\"font-size:13px;color:#a31515\">StaticResource</span><span style=\"font-size:13px;color:#ff0000\"> Settings</span><span style=\"font-size:13px;color:#0000ff\">},</span><span style=\"font-size:13px;color:#ff0000\"> Path</span><span style=\"font-size:13px;color:#0000ff\">=SplitInGrid.DisplayIndex,</span><span style=\"font-size:13px;color:#ff0000\"> Mode</span><span style=\"font-size:13px;color:#0000ff\">=TwoWay}&quot;</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n    </span><span style=\"font-size:13px;color:#0000ff\">&lt;</span><span style=\"font-size:13px;color:#a31515\">TK</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGridTemplateColumn.CellTemplate</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n        </span><span style=\"font-size:13px;color:#0000ff\">&lt;</span><span style=\"font-size:13px;color:#a31515\">DataTemplate</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n            </span><span style=\"font-size:13px;color:#0000ff\">&lt;</span><span style=\"font-size:13px;color:#a31515\">Button</span><span style=\"font-size:13px;color:#ff0000\"> Content</span><span style=\"font-size:13px;color:#0000ff\">=&quot;+&quot;</span><span style=\"font-size:13px;color:#ff0000\"> Width</span><span style=\"font-size:13px;color:#0000ff\">=&quot;16&quot;</span><span style=\"font-size:13px;color:#ff0000\"> Height</span><span style=\"font-size:13px;color:#0000ff\">=&quot;16&quot;<br>\r\n                </span><span style=\"font-size:13px;color:#ff0000\">Click</span><span style=\"font-size:13px;color:#0000ff\">=&quot;ShowSplitbuchungen_Clicked&quot;<br>\r\n                </span><span style=\"font-size:13px;color:#ff0000\">Visibility</span><span style=\"font-size:13px;color:#0000ff\">=&quot;{</span><span style=\"font-size:13px;color:#a31515\">Binding</span><span style=\"font-size:13px;color:#ff0000\"> HasSplitbuchungen</span><span style=\"font-size:13px;color:#0000ff\">}&quot;<br>\r\n                </span><span style=\"font-size:13px;color:#ff0000\">VerticalContentAlignment</span><span style=\"font-size:13px;color:#0000ff\">=&quot;Top&quot;/&gt;<br>\r\n        </span><span style=\"font-size:13px;color:#0000ff\">&lt;/</span><span style=\"font-size:13px;color:#a31515\">DataTemplate</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n    </span><span style=\"font-size:13px;color:#0000ff\">&lt;/</span><span style=\"font-size:13px;color:#a31515\">TK</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGridTemplateColumn.CellTemplate</span><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">&lt;/</span><span style=\"font-size:13px;color:#a31515\">TK</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGridTemplateColumn</span><span style=\"font-size:13px;color:#0000ff\">&gt; </span>\r\n<p><span style=\"font-size:13px;color:#0000ff\">&lt;</span><span style=\"font-size:13px;color:#a31515\">TK</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGridTextColumn</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#ff0000\">Header</span><span style=\"font-size:13px;color:#0000ff\">=&quot;Wertstellung&quot;</span><span style=\"font-size:13px;color:#ff0000\"> IsReadOnly</span><span style=\"font-size:13px;color:#0000ff\">=&quot;True&quot;</span><span style=\"font-size:13px\"> <br>\r\n    </span><span style=\"font-size:13px;color:#ff0000\">Width</span><span style=\"font-size:13px;color:#0000ff\">=&quot;{</span><span style=\"font-size:13px;color:#a31515\">Binding</span><span style=\"font-size:13px;color:#ff0000\"> Source</span><span style=\"font-size:13px;color:#0000ff\">={</span><span style=\"font-size:13px;color:#a31515\">StaticResource</span><span style=\"font-size:13px;color:#ff0000\"> Settings</span><span style=\"font-size:13px;color:#0000ff\">},</span><span style=\"font-size:13px;color:#ff0000\"> Path</span><span style=\"font-size:13px;color:#0000ff\">=Wertstellung.Width,</span><span style=\"font-size:13px;color:#ff0000\"> Mode</span><span style=\"font-size:13px;color:#0000ff\">=TwoWay}&quot;<br>\r\n    </span><span style=\"font-size:13px;color:#ff0000\">Binding</span><span style=\"font-size:13px;color:#0000ff\">=&quot;{</span><span style=\"font-size:13px;color:#a31515\">Binding</span><span style=\"font-size:13px;color:#ff0000\"> Valuta</span><span style=\"font-size:13px;color:#0000ff\">,</span><span style=\"font-size:13px;color:#ff0000\"> Converter</span><span style=\"font-size:13px;color:#0000ff\">={</span><span style=\"font-size:13px;color:#a31515\">StaticResource</span><span style=\"font-size:13px;color:#ff0000\"> DateToFormatedStringConverter</span><span style=\"font-size:13px;color:#0000ff\">},</span><span style=\"font-size:13px;color:#ff0000\">ConverterParameter</span><span style=\"font-size:13px;color:#0000ff\">=true}&quot;<br>\r\n    </span><span style=\"font-size:13px;color:#ff0000\">Visibility</span><span style=\"font-size:13px;color:#0000ff\">=&quot;{</span><span style=\"font-size:13px;color:#a31515\">Binding</span><span style=\"font-size:13px;color:#ff0000\"> Source</span><span style=\"font-size:13px;color:#0000ff\">={</span><span style=\"font-size:13px;color:#a31515\">StaticResource</span><span style=\"font-size:13px;color:#ff0000\"> Settings</span><span style=\"font-size:13px;color:#0000ff\">},</span><span style=\"font-size:13px;color:#ff0000\"> Path</span><span style=\"font-size:13px;color:#0000ff\">=Wertstellung.Visible}&quot;<br>\r\n    </span><span style=\"font-size:13px;color:#ff0000\">DisplayIndex</span><span style=\"font-size:13px;color:#0000ff\">=&quot;{</span><span style=\"font-size:13px;color:#a31515\">Binding</span><span style=\"font-size:13px;color:#ff0000\"> Source</span><span style=\"font-size:13px;color:#0000ff\">={</span><span style=\"font-size:13px;color:#a31515\">StaticResource</span><span style=\"font-size:13px;color:#ff0000\"> Settings</span><span style=\"font-size:13px;color:#0000ff\">},</span><span style=\"font-size:13px;color:#ff0000\"> Path</span><span style=\"font-size:13px;color:#0000ff\">=Wertstellung.DisplayIndex,</span><span style=\"font-size:13px;color:#ff0000\"> Mode</span><span style=\"font-size:13px;color:#0000ff\">=TwoWay}&quot;</span><span style=\"font-size:13px;color:#0000ff\">/&gt; </span><span style=\"font-size:13px;color:#a31515\">\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">&lt;</span><span style=\"font-size:13px;color:#a31515\">TK</span><span style=\"font-size:13px;color:#0000ff\">:</span><span style=\"font-size:13px;color:#a31515\">DataGridTextColumn</span><span style=\"font-size:13px;color:#ff0000\"> Header</span><span style=\"font-size:13px;color:#0000ff\">=&quot;Empf„nger/Auftraggeber&quot;</span><span style=\"font-size:13px;color:#ff0000\"> IsReadOnly</span><span style=\"font-size:13px;color:#0000ff\">=&quot;True&quot;</span><span style=\"font-size:13px\"> <br>\r\n    </span><span style=\"font-size:13px;color:#ff0000\">Width</span><span style=\"font-size:13px;color:#0000ff\">=&quot;{</span><span style=\"font-size:13px;color:#a31515\">Binding</span><span style=\"font-size:13px;color:#ff0000\"> Source</span><span style=\"font-size:13px;color:#0000ff\">={</span><span style=\"font-size:13px;color:#a31515\">StaticResource</span><span style=\"font-size:13px;color:#ff0000\"> Settings</span><span style=\"font-size:13px;color:#0000ff\">},</span><span style=\"font-size:13px;color:#ff0000\"> Path</span><span style=\"font-size:13px;color:#0000ff\">=Empfaenger.Width,</span><span style=\"font-size:13px;color:#ff0000\"> Mode</span><span style=\"font-size:13px;color:#0000ff\">=TwoWay}&quot;<br>\r\n    </span><span style=\"font-size:13px;color:#ff0000\">Binding</span><span style=\"font-size:13px;color:#0000ff\">=&quot;{</span><span style=\"font-size:13px;color:#a31515\">Binding</span><span style=\"font-size:13px;color:#ff0000\"> Empfaenger</span><span style=\"font-size:13px;color:#0000ff\">}&quot;<br>\r\n    </span><span style=\"font-size:13px;color:#ff0000\">Visibility</span><span style=\"font-size:13px;color:#0000ff\">=&quot;{</span><span style=\"font-size:13px;color:#a31515\">Binding</span><span style=\"font-size:13px;color:#ff0000\"> Source</span><span style=\"font-size:13px;color:#0000ff\">={</span><span style=\"font-size:13px;color:#a31515\">StaticResource</span><span style=\"font-size:13px;color:#ff0000\"> Settings</span><span style=\"font-size:13px;color:#0000ff\">},</span><span style=\"font-size:13px;color:#ff0000\"> Path</span><span style=\"font-size:13px;color:#0000ff\">=Empfaenger.Visible}&quot;<br>\r\n    </span><span style=\"font-size:13px;color:#ff0000\">DisplayIndex</span><span style=\"font-size:13px;color:#0000ff\">=&quot;{</span><span style=\"font-size:13px;color:#a31515\">Binding</span><span style=\"font-size:13px;color:#ff0000\"> Source</span><span style=\"font-size:13px;color:#0000ff\">={</span><span style=\"font-size:13px;color:#a31515\">StaticResource</span><span style=\"font-size:13px;color:#ff0000\"> Settings</span><span style=\"font-size:13px;color:#0000ff\">},</span><span style=\"font-size:13px;color:#ff0000\"> Path</span><span style=\"font-size:13px;color:#0000ff\">=Empfaenger.DisplayIndex,</span><span style=\"font-size:13px;color:#ff0000\"> Mode</span><span style=\"font-size:13px;color:#0000ff\">=TwoWay}&quot;</span><span style=\"font-size:13px;color:#0000ff\">/&gt;<br>\r\n...<br>\r\n<br>\r\nThe ObjectDataProvider holds the instance of my Settings class (It's a singleton). Width, Visibility and DisplayIndex are bound to the Properties of the Settings class, which are instances of my class SettingItem.<br>\r\nI am mapping the Settings from a Database Object (e) to my Settings like this:<br>\r\n<span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">\r\n<p>string </p>\r\n</span>\r\n<p>&nbsp;</p>\r\n</span>\r\n<p><span style=\"font-size:13px\">[] sort = e.Sortierung.Split(</span><span style=\"font-size:13px;color:#a31515\">','</span><span style=\"font-size:13px\">);<br>\r\nsettings.Sorting = </span><span style=\"font-size:13px;color:#0000ff\">new</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">KeyValuePair</span><span style=\"font-size:13px\">&lt;</span><span style=\"font-size:13px;color:#0000ff\">int</span><span style=\"font-size:13px\">, </span><span style=\"font-size:13px;color:#0000ff\">int</span><span style=\"font-size:13px\">&gt;(</span><span style=\"font-size:13px;color:#2b91af\">Int32</span><span style=\"font-size:13px\">.Parse(sort[0]), </span><span style=\"font-size:13px;color:#2b91af\">Int32</span><span style=\"font-size:13px\">.Parse(sort[1]));  \r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">string</span><span style=\"font-size:13px\">[] felder = e.Felder.Split(</span><span style=\"font-size:13px;color:#a31515\">','</span><span style=\"font-size:13px\">);<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">string</span><span style=\"font-size:13px\">[] feldbreiten = e.Feldbreite.Split(</span><span style=\"font-size:13px;color:#a31515\">','</span><span style=\"font-size:13px\">);<br>\r\n</span><span style=\"font-size:13px;color:#0000ff\">string</span><span style=\"font-size:13px\">[] feldreihenfolge = e.Feldreihenfolge.Split(</span><span style=\"font-size:13px;color:#a31515\">','</span><span style=\"font-size:13px\">); </span><span style=\"font-size:13px\">\r\n<p>&nbsp;</p>\r\n<p>settings.SplitInGrid = </p>\r\n</span></p>\r\n<p><span style=\"font-size:13px;color:#0000ff\">new</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">SettingItem</span><span style=\"font-size:13px\">(</span><span style=\"font-size:13px;color:#a31515\">&quot;SplitInGrid&quot;</span><span style=\"font-size:13px\">, </span><span style=\"font-size:13px;color:#a31515\">&quot;HasSplitbuchungen&quot;</span><span style=\"font-size:13px\">, 0,<br>\r\n    </span><span style=\"font-size:13px;color:#2b91af\">Int32</span><span style=\"font-size:13px\">.Parse(felder[0]), </span><span style=\"font-size:13px;color:#2b91af\">Int32</span><span style=\"font-size:13px\">.Parse(feldreihenfolge[0]), </span><span style=\"font-size:13px;color:#2b91af\">Int32</span><span style=\"font-size:13px\">.Parse(feldbreiten[0]));<br>\r\nsettings.Wertstellung = </span><span style=\"font-size:13px;color:#0000ff\">new</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">SettingItem</span><span style=\"font-size:13px\">(</span><span style=\"font-size:13px;color:#a31515\">&quot;Wertstellung&quot;</span><span style=\"font-size:13px\">, </span><span style=\"font-size:13px;color:#a31515\">&quot;Valuta&quot;</span><span style=\"font-size:13px\">, 1,<br>\r\n    </span><span style=\"font-size:13px;color:#2b91af\">Int32</span><span style=\"font-size:13px\">.Parse(felder[1]), </span><span style=\"font-size:13px;color:#2b91af\">Int32</span><span style=\"font-size:13px\">.Parse(feldreihenfolge[1]), </span><span style=\"font-size:13px;color:#2b91af\">Int32</span><span style=\"font-size:13px\">.Parse(feldbreiten[1]));<br>\r\nsettings.Empfaenger = </span><span style=\"font-size:13px;color:#0000ff\">new</span><span style=\"font-size:13px\"> </span><span style=\"font-size:13px;color:#2b91af\">SettingItem</span><span style=\"font-size:13px\">(</span><span style=\"font-size:13px;color:#a31515\">&quot;Empf„nger/Auftraggeber&quot;</span><span style=\"font-size:13px\">, </span><span style=\"font-size:13px;color:#a31515\">&quot;Empfaenger&quot;</span><span style=\"font-size:13px\">, 2,<br>\r\n        </span><span style=\"font-size:13px;color:#2b91af\">Int32</span><span style=\"font-size:13px\">.Parse(felder[2]), </span><span style=\"font-size:13px;color:#2b91af\">Int32</span><span style=\"font-size:13px\">.Parse(feldreihenfolge[2]), </span><span style=\"font-size:13px;color:#2b91af\">Int32</span><span style=\"font-size:13px\">.Parse(feldbreiten[2])); <br>\r\n<br>\r\nThis is how the displayIndex is saved into the database (exactly the case when I am getting errors):<br>\r\n0,1,3,4,2,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n</span></p>\r\n<p>Now the big Problem is, that this mapping is called several times when the application gets initialised (because we are using prism and a ViewModel which at first gets initialised with an empty model and then with the Model). The first time this mapping is called everything is working fine. But the second time it is not working any longer. When the mapping is called the first time the default settings are applied. When it is called the second time the settings the user made are applied. But at this point the DataGrid is already initialized and the Columns are bound to the values in the single SettingItems. When I am trying to set the DisplayIndex again the application crashes and tells me that the DisplayIndex is already used for another column.<br>\r\n <br>\r\nAnother strange behaviour: The second DataGrid mentioned above is bound to these values too. When the user is reordering the columns the two Grids doo not behave in the same way... Sometimes the upper grid gets reordered and the other one not or the columns are not put in the same sequence...<br>\r\nI wanted to solve this with simple DataBinding as you can see... It would be great if someone can have a look at my problem, because I really don't know how to solve this problem alone. I tried several things but everything ended up causing more errors..<br>\r\nThanks in advance!</p>\r\n</span></p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2009-04-15T00:47:12.14-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "192115",
    "ThreadId": "53323",
    "Html": "<p style=\"margin:0in 0in 0pt\"><span style=\"font-family:'Calibri','sans-serif';color:#1f497d;font-size:11pt\">I believe the problem you're hitting is that DataGrid&rsquo;s DisplayIndex conflict resolution mechanism only works after the first Measure pass happens.&nbsp; In your application, it appears that&nbsp;the DisplayIndexes contain a conflict and since they are being set before the Measure pass happens,&nbsp;DataGrid does not know how to handle the conflict.&nbsp; You have a few options to work around this:</span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-family:'Calibri','sans-serif';color:#1f497d;font-size:11pt\">&nbsp;</span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-family:'Calibri','sans-serif';color:#1f497d;font-size:11pt\">1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Make sure that whenever the DisplayIndexes do not contain any conflicts before you set them,</span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-family:'Calibri','sans-serif';color:#1f497d;font-size:11pt\">2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OR, make sure that the DisplayIndexes aren&rsquo;t set until after DataGrid&rsquo;s Measure pass happens (and it doesn&rsquo;t matter if there are conflicts because DataGrid should be able to handle them at this point)</span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-family:'Calibri','sans-serif';color:#1f497d;font-size:11pt\">&nbsp;</span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-family:'Calibri','sans-serif';color:#1f497d;font-size:11pt\">We agree that this is a bug and should be fixed in a future release, and we&rsquo;ve filed a bug to track this internally.<br></span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-family:'Calibri','sans-serif';color:#1f497d;font-size:11pt\">Thanks!<br>Samantha</span></p>",
    "PostedDate": "2009-05-19T15:30:48.29-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]