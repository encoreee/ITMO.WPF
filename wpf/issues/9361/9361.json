{
  "WorkItem": {
    "AffectedComponent": {
      "Name": "",
      "DisplayName": ""
    },
    "ClosedComment": "Closing per Samantha's By Design comment. If you are encountering this issue that is not at design time, then please re-open the work item (or contact one of us to have us re-open the work item).",
    "ClosedDate": "2009-04-01T11:39:11.03-07:00",
    "CommentCount": 0,
    "Custom": null,
    "Description": "Step 1\nCreate new VB 2008 WPF applaction.\nStep 2\nAdd reference to RibbonControlLibrary.dll\nStep 3\nPlace a ribbon.\nStep 4\nSelect the ribbon, click the \"...\" by Tabs. Add a Tab.\nStep 5\nIn the added tabs properties, press the \"...\" button by the Groups property.\nStep 6\nAdd a group.\n \nHeres my XAML:\n<Window x:Class=\"Window1\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Title=\"Window1\" Height=\"300\" Width=\"300\" xmlns:my=\"clr-namespace:Microsoft.Windows.Controls.Ribbon;assembly=RibbonControlsLibrary\">\n    <Grid>\n        <my:Ribbon Margin=\"0,0,0,126\" Name=\"Ribbon1\">\n            <my:RibbonTab Label=\"\">\n                <my:RibbonGroup></my:RibbonGroup>\n            </my:RibbonTab>\n        </my:Ribbon>\n    </Grid>\n</Window>\n \nHeres the exception details:\n \nObject reference not set to an instance of an object.\n   at Microsoft.Windows.Controls.Ribbon.RibbonGroup.OnApplyTemplate()\n   at System.Windows.FrameworkElement.ApplyTemplate()\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.StackPanel.MeasureOverride(Size constraint)\n   at Microsoft.Windows.Controls.Ribbon.RibbonGroupsContainer.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at MS.Internal.Helper.MeasureElementWithSingleChild(UIElement element, Size constraint)\n   at System.Windows.Controls.ScrollContentPresenter.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.Grid.MeasureCell(Int32 cell, Boolean forceInfinityV)\n   at System.Windows.Controls.Grid.MeasureCellsGroup(Int32 cellsHead, Size referenceSize, Boolean ignoreDesiredSizeU, Boolean forceInfinityV)\n   at System.Windows.Controls.Grid.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.ScrollViewer.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.Grid.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.Border.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at MS.Internal.Helper.MeasureElementWithSingleChild(UIElement element, Size constraint)\n   at System.Windows.Controls.ContentPresenter.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.Control.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.Grid.MeasureCell(Int32 cell, Boolean forceInfinityV)\n   at System.Windows.Controls.Grid.MeasureCellsGroup(Int32 cellsHead, Size referenceSize, Boolean ignoreDesiredSizeU, Boolean forceInfinityV)\n   at System.Windows.Controls.Grid.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.Control.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.Grid.MeasureCell(Int32 cell, Boolean forceInfinityV)\n   at System.Windows.Controls.Grid.MeasureCellsGroup(Int32 cellsHead, Size referenceSize, Boolean ignoreDesiredSizeU, Boolean forceInfinityV)\n   at System.Windows.Controls.Grid.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at MS.Internal.Helper.MeasureElementWithSingleChild(UIElement element, Size constraint)\n   at System.Windows.Controls.ContentPresenter.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.Decorator.MeasureOverride(Size constraint)\n   at System.Windows.Documents.AdornerDecorator.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.Grid.MeasureCell(Int32 cell, Boolean forceInfinityV)\n   at System.Windows.Controls.Grid.MeasureCellsGroup(Int32 cellsHead, Size referenceSize, Boolean ignoreDesiredSizeU, Boolean forceInfinityV)\n   at System.Windows.Controls.Grid.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.Border.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.Border.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.DockPanel.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.Border.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.Grid.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.Control.MeasureOverride(Size constraint)\n   at MS.Internal.WindowControl.DesignTimeWindow.MeasureOverride(Size availableSize)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at MS.Internal.Designer.SimpleViewManager.DesignerBackground.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.Decorator.MeasureOverride(Size constraint)\n   at Microsoft.Windows.Design.Interaction.DesignerView.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at MS.Internal.Designer.Viewport.MeasureOverride(Size availableSize)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at MS.Internal.Helper.MeasureElementWithSingleChild(UIElement element, Size constraint)\n   at System.Windows.Controls.ScrollContentPresenter.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.Grid.MeasureCell(Int32 cell, Boolean forceInfinityV)\n   at System.Windows.Controls.Grid.MeasureCellsGroup(Int32 cellsHead, Size referenceSize, Boolean ignoreDesiredSizeU, Boolean forceInfinityV)\n   at System.Windows.Controls.Grid.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.ScrollViewer.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.Grid.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at MS.Internal.Helper.MeasureElementWithSingleChild(UIElement element, Size constraint)\n   at System.Windows.Controls.ContentPresenter.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Controls.Control.MeasureOverride(Size constraint)\n   at System.Windows.FrameworkElement.MeasureCore(Size availableSize)\n   at System.Windows.UIElement.Measure(Size availableSize)\n   at System.Windows.Interop.HwndSource.SetLayoutSize()\n   at System.Windows.Interop.HwndSource.set_RootVisualInternal(Visual value)\n   at System.Windows.Interop.HwndSource.set_RootVisual(Visual value)\n   at MS.Internal.Designer.VSIsolatedDesigner.ViewHolder.Initialize()\n   at MS.Internal.Designer.VSIsolatedDesigner.ViewHolder..ctor(UIElement content)\n   at MS.Internal.Designer.VSIsolatedDesigner.VSIsolatedView.get_ViewHandle()\n   at MS.Internal.Host.Isolation.IsolatedView.get_ViewHandle()\n   at MS.Internal.Designer.DesignerPane.LoadDesignerView()",
    "LastUpdatedDate": "2013-05-16T05:31:10.017-07:00",
    "PlannedForRelease": "",
    "ReleaseVisibleToPublic": false,
    "Priority": {
      "Name": "Low",
      "Severity": 50,
      "Id": 1
    },
    "ProjectName": "wpf",
    "ReportedDate": "2009-02-26T09:19:09.453-08:00",
    "Status": {
      "Name": "Closed",
      "Id": 4
    },
    "ReasonClosed": {
      "Name": "Unassigned"
    },
    "Summary": "Unhandled Exeption when adding a group to a tab",
    "Type": {
      "Name": "Issue",
      "Id": 3
    },
    "VoteCount": 1,
    "Id": 9361
  },
  "FileAttachments": [],
  "Comments": [
    {
      "Message": "Hi Evan1993,\r\n\r\nI believe this is expected behavior.  In the Ribbon CTP, we rely on RibbonCommands to generate the UI for groups, controls, and menu items.  In your example, the group doesn't have a RibbonCommand assigned to it, so I believe what's happening is that we're trying to spin up the UI, but are missing information (which would usually be found in the RibbonCommand) and then it crashes.  Can you clarify if this is happening at design time or runtime?  From your stack trace, it looks like it's at design time.  If that's true, then I'm pretty sure that this is what's happening and it is by design.  If you assign a RibbonCommand to the Group, it should fix the problem.\r\n\r\nThanks,\r\nSamantha",
      "PostedDate": "2009-02-26T14:17:26.623-08:00",
      "Id": -2147483648
    },
    {
      "Message": "Hi,\r\nI encountered the same problem an i solved it by adding a GroupSizeDefinition in my ribbongroup :\r\n             <my:RibbonGroup Name=\"Groupe1\" HasDialogLauncher=\"True\" Command=\"{StaticResource Groupe1Command}\">\r\n                    <my:RibbonGroup.GroupSizeDefinitions>\r\n                        <my:RibbonGroupSizeDefinitionCollection >\r\n                            <my:RibbonGroupSizeDefinition>\r\n                                <my:RibbonControlSizeDefinition ImageSize=\"Large\" IsLabelVisible=\"True\" />\r\n                                <my:RibbonControlSizeDefinition ImageSize=\"Small\" IsLabelVisible=\"True\" />\r\n                                <my:RibbonControlSizeDefinition ImageSize=\"Small\" IsLabelVisible=\"True\" />\r\n                                <my:RibbonControlSizeDefinition ImageSize=\"Small\" IsLabelVisible=\"True\" />\r\n                            </my:RibbonGroupSizeDefinition>\r\n                        </my:RibbonGroupSizeDefinitionCollection>\r\n                    </my:RibbonGroup.GroupSizeDefinitions>\r\n                </my:RibbonGroup>\r\n\r\nYou have an exemple here : http://www.codeplex.com/wpf/Thread/View.aspx?ThreadId=42892",
      "PostedDate": "2009-02-27T03:36:47.96-08:00",
      "Id": -2147483648
    },
    {
      "Message": "Yeah, it was at design time. This was my first WPF project and I didn't know you needed to assign a Ribbon Command to a group, when I was searching for help I didn't find anything about it.\r\n\r\nAnyway, even if it was just me being stupid it seems like it should give a useful error message. (Like \"You must assign a RibbonCommad to a group for it to display\" or something like that)\r\n\r\nThanks for your help.\r\n\r\nPS: How come I can't add a comment in opera? I tried to reply many times on the weekend but the messages never appeared. :(",
      "PostedDate": "2009-03-02T14:32:51.91-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2009-04-01T11:39:11.03-07:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2013-02-21T18:41:30.23-08:00",
      "Id": -2147483648
    },
    {
      "Message": "",
      "PostedDate": "2013-05-16T05:31:10.017-07:00",
      "Id": -2147483648
    }
  ]
}