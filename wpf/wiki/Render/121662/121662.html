<div class="wikidoc"><h1>DataGrid Tips &amp; Tricks: Row Drag &amp; Drop</h1>
Drag and drop of rows is not enabled by default in the DataGrid, but you can implement it with just a few simple steps.  <br /><br />1. Paste the methods below (myDataGrid_MouseMove, DataGrid_CheckDropTarget, myDataGrid_Drop) into the code behind<br />2. Assign the event handler methods to the MouseMove, DragEnter, DragLeave, DragOver, and Drop events on the DataGrid like below<br />3. Apply the Style below to the DataGrid&#39;s RowStyle or ItemContainerStyle (ItemContainerStyle and RowStyle are equivalent properties)<br /><br /><pre>
    &lt;!--
      DRAG AND DROP
      MouseMove, DragEnter, DragLeave, DragOver, and Drop were added for drag-and-drop support.
    --&gt;
    &lt;dg:DataGrid x:Name=&quot;myDataGrid&quot; 
                 MouseMove=&quot;myDataGrid_MouseMove&quot;
                 DragEnter=&quot;DataGrid_CheckDropTarget&quot;
                 DragLeave=&quot;DataGrid_CheckDropTarget&quot;
                 DragOver=&quot;DataGrid_CheckDropTarget&quot;
                 Drop=&quot;myDataGrid_Drop&quot;
                 &gt;

     &lt;dg:DataGrid.RowStyle&gt;
        &lt;!--
          DRAG AND DROP
          Enables rows as drop targets.
        --&gt;
        &lt;Style TargetType=&quot;{x:Type dg:DataGridRow}&quot;&gt;
          &lt;Setter Property=&quot;AllowDrop&quot; Value=&quot;True&quot; /&gt;
        &lt;/Style&gt;
      &lt;/dg:DataGrid.RowStyle&gt;       



     //
     // DRAG AND DROP
     //
     private void myDataGrid_MouseMove(object sender, MouseEventArgs e)
     {
         if (e.LeftButton == MouseButtonState.Pressed)
         {
             Point currentPosition = e.GetPosition(myDataGrid);

             object selectedItem = myDataGrid.SelectedItem;
             if (selectedItem != null)
             {
                 DataGridRow container = (DataGridRow)myDataGrid.ItemContainerGenerator.ContainerFromItem(selectedItem);
                 if (container != null)
                 {
                     DragDropEffects finalDropEffect = DragDrop.DoDragDrop(container, selectedItem, DragDropEffects.Move);
                     if ((finalDropEffect == DragDropEffects.Move) &amp;&amp; (_targetItem != null))
                     {
                         // A Move drop was accepted
                         Person selectedPerson = (Person)selectedItem;
                         Person targetPerson = (Person)_targetItem;

                         int oldIndex = _people.IndexOf(selectedPerson);
                         int newIndex = _people.IndexOf(targetPerson);
                         _people.Move(oldIndex, newIndex);

                         _targetItem = null;
                     }
                 }
             }
         }
     }

     private void DataGrid_CheckDropTarget(object sender, DragEventArgs e)
     {
         if (FindVisualParent&lt;DataGridRow&gt;(e.OriginalSource as UIElement) == null)
         {
             e.Effects = DragDropEffects.None;
         }
         e.Handled = true;
     }

     private void myDataGrid_Drop(object sender, DragEventArgs e)
     {
         e.Effects = DragDropEffects.None;
         e.Handled = true;

         // Verify that this is a valid drop and then store the drop target
         DataGridRow container = FindVisualParent&lt;DataGridRow&gt;(e.OriginalSource as UIElement);
         if (container != null)
         {
             _targetItem = container.DataContext;
             e.Effects = DragDropEffects.Move;
         }
     }   
</pre></div><div class="ClearBoth"></div>