<div class="wikidoc"><h1>DataGrid Tips &amp; Tricks: Column Selection</h1>
V1 of the DataGrid does not come with built-in column selection functionality, but this feature is easy to implement in your own application.  Pasting the styles below into your DataGrid&#39;s Resources will add a button to the Column Header which allows the end user to select the column.  The two methods below contain the logic for selecting all of the cells in a column when the header is clicked and should be pasted into the code-behind (remember to replace &quot;myDataGrid&quot; with the name of your DataGrid control).<br /><br /><pre>
         &lt;!--
          COLUMN SELECTION:
          These resources add a button to the column header that will select
          all of the cells in that column.
        --&gt;
        &lt;Style x:Key=&quot;ColumnHeaderGripperStyle&quot; TargetType=&quot;{x:Type Thumb}&quot;&gt;
          &lt;Setter Property=&quot;Width&quot; Value=&quot;8&quot;/&gt;
          &lt;Setter Property=&quot;Background&quot; Value=&quot;Transparent&quot;/&gt;
          &lt;Setter Property=&quot;Cursor&quot; Value=&quot;SizeWE&quot;/&gt;
          &lt;Setter Property=&quot;Template&quot;&gt;
            &lt;Setter.Value&gt;
              &lt;ControlTemplate TargetType=&quot;{x:Type Thumb}&quot;&gt;
                &lt;Border Padding=&quot;{TemplateBinding Padding}&quot;
                    Background=&quot;{TemplateBinding Background}&quot;/&gt;
              &lt;/ControlTemplate&gt;
            &lt;/Setter.Value&gt;
          &lt;/Setter&gt;
        &lt;/Style&gt;
        
        &lt;Style x:Key=&quot;SelectColumnButtonStyle&quot; TargetType=&quot;{x:Type Button}&quot;&gt;
          &lt;Setter Property=&quot;VerticalAlignment&quot; Value=&quot;Bottom&quot; /&gt;
          &lt;Setter Property=&quot;Height&quot; Value=&quot;10&quot; /&gt;
          &lt;Setter Property=&quot;ClickMode&quot; Value=&quot;Press&quot; /&gt;
          &lt;Setter Property=&quot;Cursor&quot; Value=&quot;ScrollS&quot; /&gt;
          &lt;Setter Property=&quot;Template&quot;&gt;
            &lt;Setter.Value&gt;
              &lt;ControlTemplate TargetType=&quot;{x:Type Button}&quot;&gt;
                &lt;Border Background=&quot;Transparent&quot; /&gt;
              &lt;/ControlTemplate&gt;
            &lt;/Setter.Value&gt;
          &lt;/Setter&gt;
        &lt;/Style&gt;
        
        &lt;Style x:Key=&quot;{x:Type dg:DataGridColumnHeader}&quot; TargetType=&quot;{x:Type dg:DataGridColumnHeader}&quot;&gt;
          &lt;Setter Property=&quot;Template&quot;&gt;
            &lt;Setter.Value&gt;
              &lt;ControlTemplate TargetType=&quot;{x:Type dg:DataGridColumnHeader}&quot;&gt;
                &lt;Grid&gt;
                  &lt;dg:DataGridHeaderBorder SortDirection=&quot;{TemplateBinding SortDirection}&quot;
                                     IsHovered=&quot;{TemplateBinding IsMouseOver}&quot;
                                     IsPressed=&quot;{TemplateBinding IsPressed}&quot;
                                     IsClickable=&quot;{TemplateBinding CanUserSort}&quot;
                                     Background=&quot;{TemplateBinding Background}&quot;
                                     BorderBrush=&quot;{TemplateBinding BorderBrush}&quot;
                                     BorderThickness=&quot;{TemplateBinding BorderThickness}&quot;
                                     Padding =&quot;{TemplateBinding Padding}&quot;&gt;
                    &lt;ContentPresenter SnapsToDevicePixels=&quot;{TemplateBinding SnapsToDevicePixels}&quot;
                                  VerticalAlignment=&quot;{TemplateBinding VerticalContentAlignment}&quot;
                                  HorizontalAlignment=&quot;{TemplateBinding HorizontalContentAlignment}&quot; /&gt;
                  &lt;/dg:DataGridHeaderBorder&gt;

                  &lt;Thumb x:Name=&quot;PART_LeftHeaderGripper&quot;
                   HorizontalAlignment=&quot;Left&quot;
                   Style=&quot;{StaticResource ColumnHeaderGripperStyle}&quot;/&gt;
                  &lt;Thumb x:Name=&quot;PART_RightHeaderGripper&quot;
                   HorizontalAlignment=&quot;Right&quot;
                   Style=&quot;{StaticResource ColumnHeaderGripperStyle}&quot;/&gt;
                  &lt;Button x:Name=&quot;SelectColumnButton&quot; 
                          Style=&quot;{StaticResource SelectColumnButtonStyle}&quot;
                          Click=&quot;SelectColumn&quot;/&gt;
                &lt;/Grid&gt;
              &lt;/ControlTemplate&gt;
            &lt;/Setter.Value&gt;
          &lt;/Setter&gt;
        &lt;/Style&gt;

        //
        // COLUMN SELECTION:
        // These next two functions respond to the button click and select
        // the cells in the column.
        //

        private void SelectColumn(object sender, RoutedEventArgs e)
        {
            if (myDataGrid.SelectionUnit != DataGridSelectionUnit.FullRow)
            {
                DataGridColumnHeader header = FindVisualParent&lt;DataGridColumnHeader&gt;((Button)sender);
                if (header != null)
                {
                    myDataGrid.SelectedCells.Clear();

                    DataGridColumn column = header.Column;
                    for (int i = 0; i &lt; myDataGrid.Items.Count; i++)
                    {
                        myDataGrid.SelectedCells.Add(new DataGridCellInfo(myDataGrid.Items[i], column));
                    }
                }
            }
        }

        private static T FindVisualParent&lt;T&gt;(UIElement element) where T : UIElement
        {
            UIElement parent = element;
            while (parent != null)
            {
                T correctlyTyped = parent as T;
                if (correctlyTyped != null)
                {
                    return correctlyTyped;
                }

                parent = VisualTreeHelper.GetParent(parent) as UIElement;
            }

            return null;
        }
</pre></div><div class="ClearBoth"></div>